(function(w,e,K,T,P,b,O,m,fe,D,C){"use strict";const W=m.findByStoreName("ThemeStore"),J=m.findByProps("colors","meta");m.findByProps("triggerHaptic");const{TextStyleSheet:Q}=m.findByProps("TextStyleSheet"),{View:k,Text:I,Pressable:Z}=P.General;m.findByProps("ActionSheet")?.ActionSheet??m.find(function(i){return i.render?.name==="ActionSheet"}),m.findByProps("openLazy","hideActionSheet"),m.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton","ActionSheetContentContainer"),m.findByProps("ActionSheetRow")?.ActionSheetRow,m.findByName("Navigator")??m.findByProps("Navigator")?.Navigator,m.findByProps("getRenderCloseButton")?.getRenderCloseButton??m.findByProps("getHeaderCloseButton")?.getHeaderCloseButton,m.findByProps("popModal","pushModal"),m.findByProps("SvgXml");function ee(i){return J.meta.resolveSemanticColor(W.theme,i)}function te(i){let{title:g,onPress:t,icon:o}=i;const n=e.stylesheet.createThemedStyleSheet({androidRipple:{color:D.semanticColors.ANDROID_RIPPLE},icon:{height:18,tintColor:D.semanticColors.HEADER_SECONDARY,opacity:.5}}),l=t?Z:k;return e.React.createElement(l,{android_ripple:n.androidRipple,disabled:!1,accessibilityRole:"button",onPress:t,style:{marginBottom:8,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},o&&e.React.createElement(k,{style:{marginRight:4}},e.React.createElement(e.ReactNative.Image,{style:n.icon,source:o,resizeMode:"contain"})),e.React.createElement(h,{variant:"text-sm/semibold",color:"HEADER_SECONDARY"},g))}function F(i){let{title:g,onTitlePress:t,icon:o,children:n,padding:l}=i;const u=e.stylesheet.createThemedStyleSheet({main:{backgroundColor:D.semanticColors.CARD_PRIMARY_BG,borderRadius:16,overflow:"hidden",flex:1}});return e.React.createElement(k,{style:{marginHorizontal:16,marginTop:16}},e.React.createElement(te,{title:g,onPress:t,icon:o}),e.React.createElement(k,{style:u.main},l?e.React.createElement(k,{style:{paddingHorizontal:16,paddingVertical:16}},n):n))}var M;(function(i){function g(o){let{children:n,onPress:l}=o;return e.React.createElement(h,{variant:"text-md/bold",onPress:l},n)}i.Bold=g;function t(o){let{children:n,onPress:l}=o;return e.React.createElement(I,{style:{textDecorationLine:"underline"},onPress:l},n)}i.Underline=t})(M||(M={}));function h(i){let{variant:g,lineClamp:t,color:o,align:n,style:l,onPress:u,getChildren:a,children:f,liveUpdate:d}=i;const[c,p]=e.React.useReducer(function(R){return~R},0);return e.React.useEffect(function(){if(!d)return;const R=new Date().setMilliseconds(1e3);let y,v;return v=setTimeout(function(){p(),y=setInterval(p,1e3)},R-Date.now()),function(){clearTimeout(v),clearInterval(y)}},[]),e.React.createElement(I,{style:[g?Q[g]:{},o?{color:ee(D.semanticColors[o])}:{},n?{textAlign:n}:{},l??{}],numberOfLines:t,onPress:u},a?.()??f)}const{parseTimestamp:H}=m.findByProps("parseTimestamp","unparseTimestamp"),A=e.stylesheet.createThemedStyleSheet({code:{fontFamily:e.constants.Fonts.CODE_SEMIBOLD,backgroundColor:D.semanticColors.BACKGROUND_SECONDARY},timestamp:{backgroundColor:D.semanticColors.BACKGROUND_MODIFIER_ACCENT}});function ae(){const[i,g]=e.React.useState(Date.now());return e.React.useLayoutEffect(function(){return g(Date.now())},[r.time.acceptRelative]),e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL",liveUpdate:!0,getChildren:function(){const t=new Date,o=[[4],[19,20],[4,18,2],t.getHours()<12&&[t.getHours()],[t.getHours(),t.getMinutes()],[t.getHours(),t.getMinutes(),t.getSeconds()]].filter(function(u){return!!u}),n=[];let l=-1;for(const[u,a,f]of o){l++;const d=new Date;d.setHours(u,a??0,f||0);let c=[d.getHours().toString(),a!==void 0&&d.getMinutes().toString().padStart(2,"0"),f!==void 0&&d.getSeconds().toString().padStart(2,"0")].filter(function(R){return!!R}).join(":");u<12&&(c+=" AM");const p=H(Math.floor(d.getTime()/1e3).toString(),d.getSeconds()===0?"t":"T");n.push(r.time.requireBackticks?e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:A.code},c):c),n.push(" \u2014 "),n.push(e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:A.timestamp,onPress:function(){return C.showToast(p.full,T.getAssetIDByName("ic_information_24px"))}},p.formatted)),l!==o.length-1&&n.push(`
`)}if(r.time.acceptRelative){n.push(`

`);const u=[["in 20 seconds",1e3*20],["8 minutes ago",-(1e3*60*8)]];l=-1;for(const[a,f]of u){const d=i+f,c=H(Math.floor(d/1e3).toString(),"R");n.push(r.time.requireBackticks?e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:A.code},a):a),n.push(" \u2014 "),n.push(e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:A.timestamp,onPress:function(){return C.showToast(c.full,T.getAssetIDByName("ic_information_24px"))}},c.formatted)),l!==u.length-1&&n.push(`
`)}}return n}})}const{parseTimestamp:q}=m.findByProps("parseTimestamp","unparseTimestamp"),_=e.stylesheet.createThemedStyleSheet({code:{fontFamily:e.constants.Fonts.CODE_SEMIBOLD,backgroundColor:D.semanticColors.BACKGROUND_SECONDARY},timestamp:{backgroundColor:D.semanticColors.BACKGROUND_MODIFIER_ACCENT}});function ne(){const[i,g]=e.React.useState(Date.now());return e.React.useLayoutEffect(function(){return g(Date.now())},[r.day.acceptRelative]),e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL",liveUpdate:!0,getChildren:function(){const t=new Date,o=[[21,11,2023],[12,5],[1,8,20],[t.getDate(),t.getMonth()-1,t.getFullYear()],[t.getDate(),t.getMonth()-1],[t.getDate(),t.getMonth()-1,t.getFullYear()-2e3]].filter(function(u){return!!u}),n=[];let l=-1;for(let[u,a,f]of o){l++;const d=new Date().getFullYear(),c=new Date;f<100&&(f+=2e3),c.setFullYear(f??d,a,u);const p=q(Math.floor(c.getTime()/1e3).toString(),"d"),R=[r.day.american?a:u,r.day.american?u:a,f].join("/");n.push(r.day.requireBackticks?e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:_.code},R):R),n.push(" \u2014 "),n.push(e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:_.timestamp,onPress:function(){return C.showToast(p.full,T.getAssetIDByName("ic_information_24px"))}},p.formatted)),l!==o.length-1&&n.push(`
`)}if(r.day.acceptRelative){n.push(`

`);const u=1e3*60*60*24,a=u*(365+1/4),f=[["yesterday",-u],["in 2 days",u*2],["2 centuries ago",-(a*200)],["next week",u*7]];l=-1;for(const[d,c]of f){const p=i+c,R=q(Math.floor(p/1e3).toString(),"R");n.push(r.day.requireBackticks?e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:_.code},d):d),n.push(" \u2014 "),n.push(e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:_.timestamp,onPress:function(){return C.showToast(R.full,T.getAssetIDByName("ic_information_24px"))}},R.formatted)),l!==f.length-1&&n.push(`
`)}}return n}})}const{View:Y,ScrollView:re}=P.General,{FormSwitchRow:x,FormIcon:L}=P.Forms,{BadgableTabBar:ie}=m.findByProps("BadgableTabBar");function se(){var i,g;const[t,o]=e.React.useState("time");return(i=r).time??(i.time={acceptRelative:!1,requireBackticks:b.storage.reqBackticks??!0}),(g=r).day??(g.day={acceptRelative:!1,requireBackticks:!0,american:!1}),b.storage.alwaysLong!==void 0&&delete b.storage.alwaysLong,b.storage.reqBackticks!==void 0&&delete b.storage.reqBackticks,K.useProxy(r),e.React.createElement(re,null,e.React.createElement(Y,{style:{marginHorizontal:16,marginTop:16}},e.React.createElement(ie,{activeTab:t,onTabSelected:o,tabs:[{id:"day",title:"Date"},{id:"time",title:"Time"}]})),e.React.createElement(F,{title:"Info",icon:T.getAssetIDByName("ic_info_24px"),padding:!0},e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL"},t==="time"?e.React.createElement(e.React.Fragment,null,"Send a message with a time code (in"," ",e.React.createElement(M.Bold,null,"HH:MM"),r.time.acceptRelative?", ":" or ",e.React.createElement(M.Bold,null,"HH:MM:SS"),r.time.acceptRelative&&e.React.createElement(e.React.Fragment,null," or relative")," format) and automatically turn it into a timestamp",`

`,e.React.createElement(ae,null)):e.React.createElement(e.React.Fragment,null,"Send a message with a date code (in"," ",e.React.createElement(M.Bold,null,r.day.american?"MM/DD":"DD/MM","/YY(YY)"),r.day.acceptRelative?", ":" or ",e.React.createElement(M.Bold,null,r.day.american?"MM/DD":"DD/MM","/MM"),r.day.acceptRelative&&e.React.createElement(e.React.Fragment,null," or relative")," format) and automatically turn it into a timestamp",`

`,e.React.createElement(ne,null)))),e.React.createElement(F,{title:"Settings",icon:T.getAssetIDByName("settings")},e.React.createElement(x,{key:`${t}_acceptRelative`,label:`Allow Relative ${t==="time"?"Time":"Date"}`,subLabel:t==="time"?"Formats relative time (in 10 seconds, 5 minutes ago)":"Formats relative date (in 2 days, 6 weeks ago)",leading:e.React.createElement(L,{source:T.getAssetIDByName("ic_message_edit")}),onValueChange:function(){return r[t].acceptRelative=!r[t].acceptRelative},value:r[t].acceptRelative}),e.React.createElement(x,{key:`${t}_requireBackticks`,label:"Require Backticks",subLabel:`Require ${t==="day"?"date":"time"} to be surrounded by backticks (\`)`,leading:e.React.createElement(L,{source:T.getAssetIDByName("ic_message_edit")}),onValueChange:function(){return r[t].requireBackticks=!r[t].requireBackticks},value:r[t].requireBackticks}),t==="day"&&e.React.createElement(x,{key:`${t}_american`,label:"'Merican Dates",subLabel:"Uses MM/DD instead of DD/MM",leading:e.React.createElement(L,{source:T.getAssetIDByName("ic_message_edit")}),onValueChange:function(){return r.day.american=!r.day.american},value:r.day.american})),e.React.createElement(Y,{style:{marginBottom:16}}))}function ce(i,g,t,o){const n=[["seconds?",1e3],["minutes?",6e4],["hours?",36e5]],l=31556952e3,u=1e3*60*60*24,a=[["days?",u],["weeks?",u*7],["months?",u*30.436875],["years?",l],["decades?",l*10],["century",l*100],["centuries",l*100],["millennium",l*1e3],["millennia",l*1e3]],f=[...i.time?n:[],...i.date?a:[]].filter(function(s){return!!s}),d=function(s){return s?["`","`"]:["(?:\\s|\\t|^)","(?:\\s|\\t|$)"]},c=d(g.time),p=d(g.date),R=function(s){return`in (an?|[0-9]+) (${s})`},y=function(s){return`(an?|[0-9]+) (${s}) ago`},v=[i.time&&[1,`${c[0]}${R(n.map(function(s){return s[0]}).join("|"))}${c[1]}`],i.time&&[-1,`${c[0]}${y(n.map(function(s){return s[0]}).join("|"))}${c[1]}`],i.date&&[1,`${p[0]}${R(a.map(function(s){return s[0]}).join("|"))}${p[1]}`],i.date&&[-1,`${p[0]}${y(a.map(function(s){return s[0]}).join("|"))}${p[1]}`]].filter(function(s){return!!s});for(const[s,S]of v)t=t.replace(new RegExp(S,"gi"),function(N,G,ue){const V=G.toLowerCase().startsWith("a")?1:Number(G);if(Number.isNaN(V))return N;const z=f.find(function(de){return de[0].toLowerCase().includes(ue)})?.[1];return z?o(N,z*V*s):N});const E=[["last week",-7],["yesterday",-1],["tomorrow",1],["next week",7]].map(function(s){return[`${p[0]}${s[0]}${p[1]}`,s[1]*1e3*60*60*24]}),B=[...i.date?E:[]].filter(function(s){return!!s});for(const[s,S]of B)t=t.replace(new RegExp(s,"gi"),function(N){return o(N,S)});return t}const X=m.findByProps("sendMessage","editMessage"),$=function(i){return/^\s$/.test(i)},j=function(i){let[g,t]=i,o=t?.content;if(typeof o!="string"||typeof t!="object")return;const n=function(a){return a?["`","`"]:["(?:\\s|\\t|^)","(?:\\s|\\t|$)"]},l=n(r.time?.requireBackticks),u=n(r.day?.requireBackticks);if(r.time){const a={otN:"[0-9]{1,2}",tN:"[0-9]{2}",abrv:"(?: ?(AM|PM))"},f=[`(${a.otN}:${a.tN}:${a.tN})${a.abrv}?`,`(${a.otN}:${a.tN})${a.abrv}?`,`(${a.otN})${a.abrv}`].map(function(d){return new RegExp(`${l[0]}${d}${l[1]}`,"gi")});for(const d of f)o=o.replace(d,function(c,p,R){let[y,v,E]=p.split(":").map(function(s){return Number(s)});if(y<0||y>24||typeof v=="number"&&(v<0||v>60)||typeof E=="number"&&(E<0||E>60))return c;R&&(R.toLowerCase()==="pm"&&y!==12?y+=12:R.toLowerCase()==="am"&&y===12&&(y=0));const B=new Date;return B.setHours(y,v??0,E??0,0),`${$(c[0])?c[0]:""}<t:${Math.floor(B.getTime()/1e3)}:${B.getSeconds()===0?"t":"T"}>${$(c[c.length-1])?c[c.length-1]:""}`})}if(r.day){const a={otN:"[0-9]{1,2}",tN:"[0-9]{2}",fN:"[0-9]{4}"},f=[`(${a.otN})\\/(${a.otN})\\/(${a.fN}|${a.tN})`,`(${a.otN})\\/(${a.otN})`].map(function(d){return new RegExp(`${u[0]}${d}${u[1]}`,"gi")});for(const d of f)o=o.replace(d,function(c,p,R,y){const v=new Date().getFullYear();let[E,B,s]=[Number(p),Number(R),y?Number(y):v];if(r.day.american){const N=B;B=E,E=N}if(E<0||E>31||B<0||B>12||s<0||s>9999)return c;s<100&&(s+=2e3);const S=new Date(0);return S.setFullYear(s,B-1,E),`${$(c[0])?c[0]:""}<t:${Math.floor(S.getTime()/1e3)}:d>${$(c[c.length-1])?c[c.length-1]:""}`})}o=ce({time:!!r.time?.acceptRelative,date:!!r.day?.acceptRelative},{time:!!r.time?.requireBackticks,date:!!r.day?.requireBackticks},o,function(a,f){return`${$(a[0])?a[0]:""}<t:${Math.floor((Date.now()+f)/1e3)}:R>${$(a[a.length-1])?a[0]:""}`}),t.content=o};function oe(){const i=new Array;return i.push(O.before("sendMessage",X,j)),i.push(O.before("editMessage",X,j)),function(){return i.forEach(function(g){return g()})}}const r=b.storage;let U;var le={onLoad:function(){return U=oe()},onUnload:function(){return U?.()},settings:se};return w.default=le,w.vstorage=r,Object.defineProperty(w,"__esModule",{value:!0}),w})({},vendetta.metro.common,vendetta.storage,vendetta.ui.assets,vendetta.ui.components,vendetta.plugin,vendetta.patcher,vendetta.metro,vendetta,vendetta.ui,vendetta.ui.toasts);
