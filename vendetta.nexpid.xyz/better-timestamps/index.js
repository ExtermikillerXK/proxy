(function(C,D,f,e,J,S,_,ye,M,k,he,I){"use strict";const Z=f.findByStoreName("ThemeStore");f.findByProps("triggerHaptic");const F=f.findByProps("colors","unsafe_rawColors"),ee=F?.internal??F?.meta,te=f.findByProps("TextStyleSheet").TextStyleSheet,{View:$,Text:H,Pressable:ne}=_.General;f.findByProps("TableRow"),f.findByProps("ActionSheet")?.ActionSheet??f.find(function(n){return n.render?.name==="ActionSheet"}),f.findByProps("openLazy","hideActionSheet"),f.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton","ActionSheetContentContainer"),f.findByProps("ActionSheetRow")?.ActionSheetRow,f.findByName("Navigator")??f.findByProps("Navigator")?.Navigator,f.findByProps("getRenderCloseButton")?.getRenderCloseButton??f.findByProps("getHeaderCloseButton")?.getHeaderCloseButton,f.findByProps("popModal","pushModal");const q=f.findByProps("useSearchControls"),x=f.findByProps("useSettingSearchQuery"),ae=f.findByName("SettingSearchBar");f.findByProps("SvgXml"),f.findByProps("useInMainTabsExperiment","isInMainTabsExperiment"),f.find(function(n){return n?.WebView&&!n.default}).WebView,f.findByProps("Button","SegmentedControl");function re(n){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Z.theme;return ee.resolveSemanticColor(d,n)}Object.assign(function(n){let{searchContext:d,controls:t}=n;return e.React.createElement(e.ReactNative.ScrollView,{scrollEnabled:!1},e.React.createElement(q.default,{searchContext:d,controls:t},e.React.createElement(ae,null)))},{useAdvancedSearch:function(n){const d=x.useSettingSearchQuery(),t=q.useSearchControls(n,!1,function(){});return e.React.useEffect(function(){return function(){x.setSettingSearchQuery(""),x.setIsSettingSearchActive(!1)}},[]),[d,t]}}),window.nativeModuleProxy.DCDFileManager??window.nativeModuleProxy.RTNFileManager,window.nativeModuleProxy.BundleUpdaterManager,window.nativeModuleProxy.MMKVManager,window.nativeModuleProxy.DCDSoundManager;function ie(n){let{title:d,onPress:t,icon:o}=n;const r=e.stylesheet.createThemedStyleSheet({androidRipple:{color:M.semanticColors.ANDROID_RIPPLE},icon:{height:18,tintColor:M.semanticColors.HEADER_SECONDARY,opacity:.5}}),l=t?ne:$;return e.React.createElement(l,{android_ripple:r.androidRipple,disabled:!1,accessibilityRole:"button",onPress:t,style:{marginBottom:8,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},o&&e.React.createElement($,{style:{marginRight:4}},e.React.createElement(e.ReactNative.Image,{style:r.icon,source:o,resizeMode:"contain"})),e.React.createElement(m,{variant:"text-sm/semibold",color:"HEADER_SECONDARY"},d))}function Y(n){let{title:d,onTitlePress:t,icon:o,children:r,padding:l}=n;const u=e.stylesheet.createThemedStyleSheet({main:{backgroundColor:M.semanticColors.CARD_PRIMARY_BG,borderRadius:16,overflow:"hidden",flex:1}});return e.React.createElement($,{style:{marginHorizontal:16,marginTop:16}},e.React.createElement(ie,{title:d,onPress:t,icon:o}),e.React.createElement($,{style:u.main},l?e.React.createElement($,{style:{paddingHorizontal:16,paddingVertical:16}},r):r))}var N;(function(n){function d(o){let{children:r,onPress:l}=o;return e.React.createElement(m,{variant:"text-md/bold",onPress:l},r)}n.Bold=d;function t(o){let{children:r,onPress:l}=o;return e.React.createElement(H,{style:{textDecorationLine:"underline"},onPress:l},r)}n.Underline=t})(N||(N={}));function m(n){let{variant:d,lineClamp:t,color:o,align:r,style:l,onPress:u,getChildren:a,children:p,liveUpdate:g}=n;const[c,R]=e.React.useReducer(function(y){return~y},0);return e.React.useEffect(function(){if(!g)return;const y=new Date().setMilliseconds(1e3);let h;const v=setTimeout(function(){R(),h=setInterval(R,1e3)},y-Date.now());return function(){clearTimeout(v),clearInterval(h)}},[]),e.React.createElement(H,{style:[d?te[d]:{},o?{color:re(M.semanticColors[o])}:{},r?{textAlign:r}:{},l??{}],numberOfLines:t,onPress:u},a?.()??p)}const{parseTimestamp:U}=f.findByProps("parseTimestamp","unparseTimestamp"),A=e.stylesheet.createThemedStyleSheet({code:{fontFamily:e.constants.Fonts.CODE_SEMIBOLD,backgroundColor:M.semanticColors.BACKGROUND_SECONDARY},timestamp:{backgroundColor:M.semanticColors.BACKGROUND_MODIFIER_ACCENT}});function se(){const[n,d]=e.React.useState(Date.now());return e.React.useLayoutEffect(function(){return d(Date.now())},[i.day.acceptRelative]),e.React.createElement(m,{variant:"text-md/semibold",color:"TEXT_NORMAL",liveUpdate:!0,getChildren:function(){const t=new Date,o=[[21,11,2023],[12,5],[1,8,20],[t.getDate(),t.getMonth()-1,t.getFullYear()],[t.getDate(),t.getMonth()-1],[t.getDate(),t.getMonth()-1,t.getFullYear()-2e3]].filter(function(u){return!!u}),r=[];let l=-1;for(const[u,a,p]of o){l++;const g=new Date().getFullYear(),c=new Date;let R=p;p<100&&(R+=2e3),c.setFullYear(R??g,a,u);const y=U(Math.floor(c.getTime()/1e3).toString(),"d"),h=[i.day.american?a:u,i.day.american?u:a,p].join("/");r.push(i.day.requireBackticks?e.React.createElement(m,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:A.code},h):h),r.push(" \u2014 "),r.push(e.React.createElement(m,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:A.timestamp,onPress:function(){return k.showToast(y.full,S.getAssetIDByName("ic_information_24px"))}},y.formatted)),l!==o.length-1&&r.push(`
`)}if(i.day.acceptRelative){r.push(`

`);const u=1e3*60*60*24,a=u*(365+1/4),p=[["yesterday",-u],["in 2 days",u*2],["2 centuries ago",-(a*200)],["next week",u*7]];l=-1;for(const[g,c]of p){const R=n+c,y=U(Math.floor(R/1e3).toString(),"R");r.push(i.day.requireBackticks?e.React.createElement(m,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:A.code},g):g),r.push(" \u2014 "),r.push(e.React.createElement(m,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:A.timestamp,onPress:function(){return k.showToast(y.full,S.getAssetIDByName("ic_information_24px"))}},y.formatted)),l!==p.length-1&&r.push(`
`)}}return r}})}const{parseTimestamp:X}=f.findByProps("parseTimestamp","unparseTimestamp"),P=e.stylesheet.createThemedStyleSheet({code:{fontFamily:e.constants.Fonts.CODE_SEMIBOLD,backgroundColor:M.semanticColors.BACKGROUND_SECONDARY},timestamp:{backgroundColor:M.semanticColors.BACKGROUND_MODIFIER_ACCENT}});function ce(){const[n,d]=e.React.useState(Date.now());return e.React.useLayoutEffect(function(){return d(Date.now())},[i.time.acceptRelative]),e.React.createElement(m,{variant:"text-md/semibold",color:"TEXT_NORMAL",liveUpdate:!0,getChildren:function(){const t=new Date,o=[[4],[19,20],[4,18,2],t.getHours()<12&&[t.getHours()],[t.getHours(),t.getMinutes()],[t.getHours(),t.getMinutes(),t.getSeconds()]].filter(function(u){return!!u}),r=[];let l=-1;for(const[u,a,p]of o){l++;const g=new Date;g.setHours(u,a??0,p||0);let c=[g.getHours().toString(),a!==void 0&&g.getMinutes().toString().padStart(2,"0"),p!==void 0&&g.getSeconds().toString().padStart(2,"0")].filter(function(y){return!!y}).join(":");u<12&&(c+=" AM");const R=X(Math.floor(g.getTime()/1e3).toString(),g.getSeconds()===0?"t":"T");r.push(i.time.requireBackticks?e.React.createElement(m,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:P.code},c):c),r.push(" \u2014 "),r.push(e.React.createElement(m,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:P.timestamp,onPress:function(){return k.showToast(R.full,S.getAssetIDByName("ic_information_24px"))}},R.formatted)),l!==o.length-1&&r.push(`
`)}if(i.time.acceptRelative){r.push(`

`);const u=[["in 20 seconds",1e3*20],["8 minutes ago",-(1e3*60*8)]];l=-1;for(const[a,p]of u){const g=n+p,c=X(Math.floor(g/1e3).toString(),"R");r.push(i.time.requireBackticks?e.React.createElement(m,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:P.code},a):a),r.push(" \u2014 "),r.push(e.React.createElement(m,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:P.timestamp,onPress:function(){return k.showToast(c.full,S.getAssetIDByName("ic_information_24px"))}},c.formatted)),l!==u.length-1&&r.push(`
`)}}return r}})}const{View:j,ScrollView:oe}=_.General,{FormSwitchRow:L,FormIcon:O}=_.Forms,{BadgableTabBar:le}=f.findByProps("BadgableTabBar");function ue(){var n,d;const[t,o]=e.React.useState("time");return(n=i).time??(n.time={acceptRelative:!1,requireBackticks:D.storage.reqBackticks??!0}),(d=i).day??(d.day={acceptRelative:!1,requireBackticks:!0,american:!1}),D.storage.alwaysLong!==void 0&&delete D.storage.alwaysLong,D.storage.reqBackticks!==void 0&&delete D.storage.reqBackticks,J.useProxy(i),e.React.createElement(oe,null,e.React.createElement(j,{style:{marginHorizontal:16,marginTop:16}},e.React.createElement(le,{activeTab:t,onTabSelected:o,tabs:[{id:"day",title:"Date"},{id:"time",title:"Time"}]})),e.React.createElement(Y,{title:"Info",icon:S.getAssetIDByName("ic_info_24px"),padding:!0},e.React.createElement(m,{variant:"text-md/semibold",color:"TEXT_NORMAL"},t==="time"?e.React.createElement(e.React.Fragment,null,"Send a message with a time code (in"," ",e.React.createElement(N.Bold,null,"HH:MM"),i.time.acceptRelative?", ":" or ",e.React.createElement(N.Bold,null,"HH:MM:SS"),i.time.acceptRelative&&e.React.createElement(e.React.Fragment,null," or relative")," format) and automatically turn it into a timestamp",`

`,e.React.createElement(ce,null)):e.React.createElement(e.React.Fragment,null,"Send a message with a date code (in"," ",e.React.createElement(N.Bold,null,i.day.american?"MM/DD":"DD/MM","/YY(YY)"),i.day.acceptRelative?", ":" or ",e.React.createElement(N.Bold,null,i.day.american?"MM/DD":"DD/MM","/MM"),i.day.acceptRelative&&e.React.createElement(e.React.Fragment,null," or relative")," format) and automatically turn it into a timestamp",`

`,e.React.createElement(se,null)))),e.React.createElement(Y,{title:"Settings",icon:S.getAssetIDByName("settings")},e.React.createElement(L,{key:`${t}_acceptRelative`,label:`Allow Relative ${t==="time"?"Time":"Date"}`,subLabel:t==="time"?"Formats relative time (in 10 seconds, 5 minutes ago)":"Formats relative date (in 2 days, 6 weeks ago)",leading:e.React.createElement(O,{source:S.getAssetIDByName("ic_message_edit")}),onValueChange:function(){return i[t].acceptRelative=!i[t].acceptRelative},value:i[t].acceptRelative}),e.React.createElement(L,{key:`${t}_requireBackticks`,label:"Require Backticks",subLabel:`Require ${t==="day"?"date":"time"} to be surrounded by backticks (\`)`,leading:e.React.createElement(O,{source:S.getAssetIDByName("ic_message_edit")}),onValueChange:function(){return i[t].requireBackticks=!i[t].requireBackticks},value:i[t].requireBackticks}),t==="day"&&e.React.createElement(L,{key:`${t}_american`,label:"'Merican Dates",subLabel:"Uses MM/DD instead of DD/MM",leading:e.React.createElement(O,{source:S.getAssetIDByName("ic_message_edit")}),onValueChange:function(){return i.day.american=!i.day.american},value:i.day.american})),e.React.createElement(j,{style:{marginBottom:16}}))}function de(n,d,t,o){const r=[["seconds?",1e3],["minutes?",6e4],["hours?",36e5]],l=31556952e3,u=1e3*60*60*24,a=[["days?",u],["weeks?",u*7],["months?",u*30.436875],["years?",l],["decades?",l*10],["century",l*100],["centuries",l*100],["millennium",l*1e3],["millennia",l*1e3]],p=[...n.time?r:[],...n.date?a:[]].filter(function(s){return!!s}),g=function(s){return s?["`","`"]:["(?:\\s|\\t|^)","(?:\\s|\\t|$)"]},c=g(d.time),R=g(d.date),y=function(s){return`in (an?|[0-9]+) (${s})`},h=function(s){return`(an?|[0-9]+) (${s}) ago`},v=[n.time&&[1,`${c[0]}${y(r.map(function(s){return s[0]}).join("|"))}${c[1]}`],n.time&&[-1,`${c[0]}${h(r.map(function(s){return s[0]}).join("|"))}${c[1]}`],n.date&&[1,`${R[0]}${y(a.map(function(s){return s[0]}).join("|"))}${R[1]}`],n.date&&[-1,`${R[0]}${h(a.map(function(s){return s[0]}).join("|"))}${R[1]}`]].filter(function(s){return!!s});for(const[s,T]of v)t=t.replace(new RegExp(T,"gi"),function(b,K,pe){const Q=K.toLowerCase().startsWith("a")?1:Number(K);if(Number.isNaN(Q))return b;const W=p.find(function(Re){return Re[0].toLowerCase().includes(pe)})?.[1];return W?o(b,W*Q*s):b});const E=[["last week",-7],["yesterday",-1],["tomorrow",1],["next week",7]].map(function(s){return[`${R[0]}${s[0]}${R[1]}`,s[1]*1e3*60*60*24]}),B=[...n.date?E:[]].filter(function(s){return!!s});for(const[s,T]of B)t=t.replace(new RegExp(s,"gi"),function(b){return o(b,T)});return t}const V=f.findByProps("sendMessage","editMessage"),w=function(n){return/^\s$/.test(n)},G=function(n){let[d,t]=n,o=t?.content;if(typeof o!="string"||typeof t!="object")return;const r=function(a){return a?["`","`"]:["(?:\\s|\\t|^)","(?:\\s|\\t|$)"]},l=r(i.time?.requireBackticks),u=r(i.day?.requireBackticks);if(i.time){const a={otN:"[0-9]{1,2}",tN:"[0-9]{2}",abrv:"(?: ?(AM|PM))"},p=[`(${a.otN}:${a.tN}:${a.tN})${a.abrv}?`,`(${a.otN}:${a.tN})${a.abrv}?`,`(${a.otN})${a.abrv}`].map(function(g){return new RegExp(`${l[0]}${g}${l[1]}`,"gi")});for(const g of p)o=o.replace(g,function(c,R,y){const h=R.split(":").map(function(T){return Number(T)});let v=h[0];const E=h[1],B=h[2];if(v<0||v>24||typeof E=="number"&&(E<0||E>60)||typeof B=="number"&&(B<0||B>60))return c;y&&(y.toLowerCase()==="pm"&&v!==12?v+=12:y.toLowerCase()==="am"&&v===12&&(v=0));const s=new Date;return s.setHours(v,E??0,B??0,0),`${w(c[0])?c[0]:""}<t:${Math.floor(s.getTime()/1e3)}:${s.getSeconds()===0?"t":"T"}>${w(c[c.length-1])?c[c.length-1]:""}`})}if(i.day){const a={otN:"[0-9]{1,2}",tN:"[0-9]{2}",fN:"[0-9]{4}"},p=[`(${a.otN})\\/(${a.otN})\\/(${a.fN}|${a.tN})`,`(${a.otN})\\/(${a.otN})`].map(function(g){return new RegExp(`${u[0]}${g}${u[1]}`,"gi")});for(const g of p)o=o.replace(g,function(c,R,y,h){const v=new Date().getFullYear();let[E,B,s]=[Number(R),Number(y),h?Number(h):v];if(i.day.american){const b=B;B=E,E=b}if(E<0||E>31||B<0||B>12||s<0||s>9999)return c;s<100&&(s+=2e3);const T=new Date(0);return T.setFullYear(s,B-1,E),`${w(c[0])?c[0]:""}<t:${Math.floor(T.getTime()/1e3)}:d>${w(c[c.length-1])?c[c.length-1]:""}`})}o=de({time:!!i.time?.acceptRelative,date:!!i.day?.acceptRelative},{time:!!i.time?.requireBackticks,date:!!i.day?.requireBackticks},o,function(a,p){return`${w(a[0])?a[0]:""}<t:${Math.floor((Date.now()+p)/1e3)}:R>${w(a[a.length-1])?a[0]:""}`}),t.content=o};function fe(){const n=new Array;return n.push(I.before("sendMessage",V,G)),n.push(I.before("editMessage",V,G)),function(){return n.forEach(function(d){return d()})}}const i=D.storage;let z;var ge={onLoad:function(){return z=fe()},onUnload:function(){return z?.()},settings:ue};return C.default=ge,C.vstorage=i,Object.defineProperty(C,"__esModule",{value:!0}),C})({},vendetta.plugin,vendetta.metro,vendetta.metro.common,vendetta.storage,vendetta.ui.assets,vendetta.ui.components,vendetta,vendetta.ui,vendetta.ui.toasts,vendetta.utils,vendetta.patcher);
