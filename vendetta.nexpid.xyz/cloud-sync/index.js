(function(I,K,C,l,T,A,E,c,W,t,v,y,$,q,ue,Me,Fe){"use strict";const Ge=l.findByStoreName("ThemeStore"),Ve=l.findByProps("colors","meta");l.findByProps("triggerHaptic");const{TextStyleSheet:ke}=l.findByProps("TextStyleSheet"),{View:D,Text:de,Pressable:Ue}=y.General,je=l.findByProps("ActionSheet")?.ActionSheet??l.find(function(e){return e.render?.name==="ActionSheet"}),{openLazy:ze,hideActionSheet:fe}=l.findByProps("openLazy","hideActionSheet"),{ActionSheetTitleHeader:He,ActionSheetCloseButton:Ye,ActionSheetContentContainer:Xe}=l.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton","ActionSheetContentContainer");l.findByProps("ActionSheetRow")?.ActionSheetRow,l.findByName("Navigator"),l.findByProps("getRenderCloseButton"),l.findByProps("popModal","pushModal");function Je(e){return Ve.meta.resolveSemanticColor(Ge.theme,e)}function ge(e,n){try{ze(new Promise(function(i){return i({default:e})}),"ActionSheet",n)}catch(i){ue.logger.error(i.stack),E.showToast("Got error when opening ActionSheet! Please check debug logs",c.getAssetIDByName("Smal"))}}function Ke(e){let{title:n,onPress:i,icon:r}=e;const o=t.stylesheet.createThemedStyleSheet({androidRipple:{color:v.semanticColors.ANDROID_RIPPLE},icon:{height:18,tintColor:v.semanticColors.HEADER_SECONDARY,opacity:.5}}),a=i?Ue:D;return t.React.createElement(a,{android_ripple:o.androidRipple,disabled:!1,accessibilityRole:"button",onPress:i,style:{marginBottom:8,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},r&&t.React.createElement(D,{style:{marginRight:4}},t.React.createElement(t.ReactNative.Image,{style:o.icon,source:r,resizeMode:"contain"})),t.React.createElement(z,{variant:"text-sm/semibold",color:"HEADER_SECONDARY"},n))}function j(e){let{title:n,onTitlePress:i,icon:r,children:o,padding:a}=e;const s=t.stylesheet.createThemedStyleSheet({main:{backgroundColor:v.semanticColors.REDESIGN_ACTIVITY_CARD_BACKGROUND,borderRadius:16,overflow:"hidden",flex:1}});return t.React.createElement(D,{style:{marginHorizontal:16,marginTop:16}},t.React.createElement(Ke,{title:n,onPress:i,icon:r}),t.React.createElement(D,{style:s.main},a?t.React.createElement(D,{style:{paddingHorizontal:16,paddingVertical:16}},o):o))}function We(e){let{addPadding:n}=e;const i=t.stylesheet.createThemedStyleSheet({line:{width:"100%",height:2,backgroundColor:v.semanticColors.BACKGROUND_ACCENT,borderRadius:2147483647}});return t.React.createElement(D,{style:[{marginTop:16,marginBottom:16},n&&{marginHorizontal:16}]},t.React.createElement(D,{style:i.line}))}var he;(function(e){function n(r){let{children:o,onPress:a}=r;return t.React.createElement(z,{variant:"text-md/bold",onPress:a},o)}e.Bold=n;function i(r){let{children:o,onPress:a}=r;return t.React.createElement(de,{style:{textDecorationLine:"underline"},onPress:a},o)}e.Underline=i})(he||(he={}));function z(e){let{variant:n,lineClamp:i,color:r,align:o,style:a,onPress:s,getChildren:g,children:d,liveUpdate:w}=e;const[_,R]=t.React.useReducer(function(p){return~p},0);return t.React.useEffect(function(){if(!w)return;const p=new Date().setMilliseconds(1e3);let f,m;return m=setTimeout(function(){R(),f=setInterval(R,1e3)},p-Date.now()),function(){clearTimeout(m),clearInterval(f)}},[]),t.React.createElement(de,{style:[n?ke[n]:{},r?{color:Je(v.semanticColors[r])}:{},o?{textAlign:o}:{},a??{}],numberOfLines:i,onPress:s},g?.()??d)}function pe(e){let{onPress:n,onLongPress:i,icon:r,style:o,destructive:a,color:s}=e;const g=t.stylesheet.createThemedStyleSheet({headerStyleIcon:{width:24,height:24,marginRight:10,tintColor:v.semanticColors.HEADER_PRIMARY},cardStyleIcon:{width:22,height:22,marginLeft:5,tintColor:v.semanticColors.INTERACTIVE_NORMAL},destructiveIcon:{tintColor:v.semanticColors.TEXT_DANGER}});return t.React.createElement(t.ReactNative.TouchableOpacity,{onPress:n,onLongPress:i},t.React.createElement(t.ReactNative.Image,{style:[typeof o=="string"?o==="header"?g.headerStyleIcon:g.cardStyleIcon:o,a&&g.destructiveIcon,s&&{tintColor:s}].filter(function(d){return!!d}),source:r}))}const{View:qe,Text:ye}=y.General,{TextStyleSheet:Se}=l.findByProps("TextStyleSheet"),Re=t.stylesheet.createThemedStyleSheet({count:{...Se["text-lg/bold"],color:v.semanticColors.TEXT_NORMAL,textAlign:"center"},subtitle:{...Se["text-md/medium"],color:v.semanticColors.TEXT_MUTED,textAlign:"center"}});function Ee(e){let{subtitle:n,count:i,contents:r}=e;return React.createElement(qe,{style:{alignItems:"center",justifyContent:"center",marginHorizontal:16}},React.createElement(ye,{style:Re.count},i),React.createElement(ye,{style:Re.subtitle},n))}const ve="https://cloudsync.nexpid.xyz/";var B={api:ve,oauth2:{clientId:"1120793656878714913",redirectURL:`${ve}api/oauth2-response`}};function Qe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ze(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function H(e,n,i){return me()?H=Reflect.construct:H=function(r,o,a){var s=[null];s.push.apply(s,o);var g=Function.bind.apply(r,s),d=new g;return a&&F(d,a.prototype),d},H.apply(null,arguments)}function M(e){return M=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},M(e)}function et(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&F(e,n)}function tt(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function nt(e,n){return n&&(it(n)==="object"||typeof n=="function")?n:Qe(e)}function F(e,n){return F=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},F(e,n)}function it(e){"@swc/helpers - typeof";return e&&typeof Symbol<"u"&&e.constructor===Symbol?"symbol":typeof e}function Q(e){var n=typeof Map=="function"?new Map:void 0;return Q=function(i){if(i===null||!tt(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(typeof n<"u"){if(n.has(i))return n.get(i);n.set(i,r)}function r(){return H(i,arguments,M(this).constructor)}return r.prototype=Object.create(i.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),F(r,i)},Q(e)}function me(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rt(e){var n=me();return function(){var i=M(e),r;if(n){var o=M(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return nt(this,r)}}const Ie=l.findByStoreName("UserStore");let G=function(e){et(i,e);var n=rt(i);function i(r){Ze(this,i);var o;return o=n.call(this,`${r.status}: ${r.message}${r.error?` (${r.error})`:""}`),o.name=o.constructor.name,o}return i}(Q(Error));function b(){return u.auth?.[Ie.getCurrentUser().id]}async function Z(){const e=new Error("Unauthorized, try logging out and back in again");let n=b();if(!n)throw e;if(Date.now()>=n.expiresAt){const i=await fetch(`${B.api}api/refresh-access-token?refresh_token=${encodeURIComponent(n.refreshToken)}`);if(i.status!==200)throw new G(await i.json());n=await i.json(),u.auth??={},u.auth[Ie.getCurrentUser().id]=n}return n.accessToken}async function at(e){const n=await fetch(`${B.api}api/get-access-token?code=${encodeURIComponent(e)}`);if(n.status===200)return await n.json();throw new G(await n.json())}async function ot(){if(!b())return;const e=await fetch(`${B.api}api/get-data`,{headers:{authorization:await Z()}});if(e.status===200)return await e.json();throw new G(await e.json())}async function Te(e){if(!b())return;const n=await fetch(`${B.api}api/sync-data`,{method:"POST",headers:{authorization:await Z(),"content-type":"application/json"},body:JSON.stringify(e)});if(n.status===200)return await n.json();throw new G(await n.json())}async function st(){if(!b())return;const e=await fetch(`${B.api}api/delete-data`,{method:"DELETE",headers:{authorization:await Z()}});if(e.status===200)return await e.json();throw new G(await e.json())}const{pushModal:ct,popModal:lt}=l.findByProps("pushModal","popModal"),ut=l.findByName("OAuth2AuthorizeModal"),dt=l.findByStoreName("UserStore");function ft(){ct({key:"oauth2-authorize",modal:{key:"oauth2-authorize",modal:ut,animation:"slide-up",shouldPersistUnderModals:!1,props:{clientId:B.oauth2.clientId,redirectUri:B.oauth2.redirectURL,scopes:["identify"],responseType:"code",permissions:0n,cancelCompletesFlow:!1,callback:async function(e){let{location:n}=e;try{const i=new URL(n).searchParams.get("code"),r=await at(i);u.auth??={},u.auth[dt.getCurrentUser().id]=r,ae(),E.showToast("Successfully authenticated",c.getAssetIDByName("Check"))}catch(i){E.showToast(String(i),c.getAssetIDByName("Small"))}},dismissOAuthModal:function(){return lt("oauth2-authorize")}},closable:!0}})}let Y=!1,ee;const te=[];function gt(){te.length=0,ee?.()}function P(e,n){te.push([e,n]),ee?.()}const ht={themes:"#42f5a4",plugins:"#4290f5",importer:"#e6f542"},we=t.stylesheet.createThemedStyleSheet({text:{fontFamily:t.constants.Fonts.CODE_SEMIBOLD,includeFontPadding:!1,color:v.semanticColors.TEXT_NORMAL,marginHorizontal:12,marginTop:24}}),pt=function(){const[e,n]=t.React.useReducer(function(r){return~r},0);ee=n;const i=t.React.useRef();return t.React.useEffect(function(){return Y=!0,function(){Y=!1}},[]),t.React.createElement(t.ReactNative.ScrollView,{style:{flex:1},ref:i,onContentSizeChange:function(){return i.current.scrollToEnd({animated:!0})}},t.React.createElement(t.ReactNative.Text,{style:we.text},te.map(function(r){let[o,a]=r;return[t.React.createElement(t.ReactNative.Text,{style:[we.text,{color:ht[o]}]},"[",o.toUpperCase(),"]:"),` ${a}
`]})))};function yt(e){e.push("VendettaCustomPage",{render:pt,title:"Import Logs"})}const{MMKVManager:St}=window.nativeModuleProxy;async function be(){const e={themes:[],plugins:[]};for(const n of Object.values(T.plugins)){const i=u.pluginSettings?.[n.id];if(i?.syncPlugin===!1)continue;const r=i?.syncStorage===!1?{}:await C.createMMKVBackend(n.id).get();e.plugins.push({id:n.id,enabled:n.enabled,options:r})}for(const n of Object.values(A.themes))e.themes.push({id:n.id,enabled:n.selected});return e}let X;function Rt(e){X=e}async function Et(e){if(!h.save)return;X?.(!0);const n=[...h.save.sync.plugins.filter(function(a){return!T.plugins[a.id]&&!V(a.id)&&k(a.id)&&e.unproxiedPlugins}),...h.save.sync.plugins.filter(function(a){return!T.plugins[a.id]&&V(a.id)&&k(a.id)&&e.plugins})],i=h.save.sync.themes.filter(function(a){return!A.themes[a.id]&&e.themes});if(!n[0]&&!i[0])return X?.(!1),E.showToast("Nothing to import",c.getAssetIDByName("Small"));gt(),P("importer",`Starting to import ${n.length} plugin${n.length!==1?"s":""} and ${i.length} theme${i.length!==1?"s":""}`),Y||E.showToast(`Importing ${[n.length&&`${n.length} plugin${n.length!==1?"s":""}`,i.length&&`${i.length} theme${i.length!==1?"s":""}`].filter(function(a){return!!a}).join(" and ")}`,c.getAssetIDByName("toast_image_saved"));const r={plugins:0,themes:0,failed:0};await Promise.all([...n.map(function(a){return new Promise(async function(s){St.setItem(a.id,JSON.stringify(a.options)),T.installPlugin(a.id,a.enabled).then(function(){r.plugins++,P("plugins",`Successfully imported plugin: ${a.id}`)}).catch(function(g){r.failed++,P("plugins",`Failed to import plugin: ${a.id}
${g}`)}).finally(s)})}),...i.map(function(a){return new Promise(async function(s){return A.installTheme(a.id).then(function(){r.themes++,P("themes",`Successfully imported theme: ${a.id}`)}).catch(function(g){r.failed++,P("themes",`Failed to import theme: ${a.id}
${g}`)}).finally(s)})})]),Y||E.showToast(`Imported ${[[r.plugins,"plugin"],[r.themes,"theme"]].map(function(a){let[s,g]=a;return`${s} ${g}${s!==1?"s":""}`}).join(" and ")}! (${r.failed} failed)`,c.getAssetIDByName("check"));const o=A.themes[i.find(function(a){return a.enabled})?.id];o&&(P("themes",`Selecting theme: ${o.id}`),await C.createFileBackend("vendetta_theme.json").set(Object.assign(o,{selected:!0})),P("themes","Prompting user to reload"),await function(){return new Promise(function(a){return W.showConfirmationAlert({title:"Theme selected",content:"A reload is required to see the theme. Do you want to reload now?",confirmText:"Reload",confirmColor:"red",onConfirm:function(){window.nativeModuleProxy.BundleUpdaterManager.reload(),a()},cancelText:"Skip",onCancel:a,isDismissable:!0})})}()),P("importer",`Finished! Imported ${r.plugins} plugin${r.plugins!==1?"s":""} and ${r.themes} theme${r.themes!==1?"s":""}. ${r.failed?`Failed to import ${r.failed} plugin${r.failed!==1?"s":""}/theme${r.failed!==1?"s":""}`:"All imports were successful"}`),X?.(!1)}const{FormCheckboxRow:ne}=y.Forms;function Pe(e){let{defOptions:n,navigation:i}=e;const r={unproxiedPlugins:h.save.sync.plugins.filter(function(s){return!T.plugins[s.id]&&!V(s.id)&&k(s.id)}).length,plugins:h.save.sync.plugins.filter(function(s){return!T.plugins[s.id]&&V(s.id)&&k(s.id)}).length,themes:h.save.sync.themes.filter(function(s){return!A.themes[s.id]}).length},[o,a]=t.React.useState(n??{unproxiedPlugins:!1,plugins:!!r.plugins,themes:!!r.themes});return t.React.createElement(je,null,t.React.createElement(Xe,null,t.React.createElement(He,{title:"Import Data",trailing:t.React.createElement(Ye,{onPress:function(){return fe()}})}),t.React.createElement(ne,{label:`Unproxied Plugins (${r.unproxiedPlugins})`,disabled:!r.unproxiedPlugins,onPress:function(){return r.unproxiedPlugins&&(!o.unproxiedPlugins&&!n?W.showConfirmationAlert({title:"Warning",content:"Installing unproxied plugins can be dangerous since they haven't been verified by Vendetta staff. Are you sure you want to import them?",isDismissable:!0,confirmText:"Yes",confirmColor:"brand",onConfirm:function(){return ge(Pe,{navigation:i,defOptions:{...o,unproxiedPlugins:!0}})},cancelText:"Cancel"}):a({...o,unproxiedPlugins:!o.unproxiedPlugins}))},selected:o.unproxiedPlugins}),t.React.createElement(ne,{label:`Plugins (${r.plugins})`,disabled:!r.plugins,onPress:function(){return r.plugins&&a({...o,plugins:!o.plugins})},selected:o.plugins}),t.React.createElement(ne,{label:`Themes (${r.themes})`,disabled:!r.themes,onPress:function(){return r.themes&&a({...o,themes:!o.themes})},selected:o.themes}),t.React.createElement(y.Button,{text:"Import",color:"green",size:"medium",renderIcon:function(){return t.React.createElement(t.ReactNative.Image,{style:{marginRight:8},source:c.getAssetIDByName("ic_download_24px")})},onPress:function(){yt(i),Et(o),fe()},style:{marginHorizontal:16,marginVertical:16},disabled:!o.unproxiedPlugins&&!o.plugins&&!o.themes})))}const Ne=l.findByProps("isTablet"),{View:vt}=y.General,{FormRow:mt}=y.Forms;function It(){const e=t.NavigationNative.useNavigation(),[n,i]=t.React.useState({});return b()?t.React.createElement(vt,{style:{flexDirection:Ne.isTablet?"row":"column",justifyContent:"flex-end"}},[{text:"Save Data",onPress:async function(r){r(!0);try{h.save=await Te(await be()),E.showToast("Successfully synced data",c.getAssetIDByName("Check"))}catch(o){E.showToast(String(o),c.getAssetIDByName("Small"))}r(!1)}},{text:"Import Data",onPress:function(r){h.save&&(ge(Pe,{navigation:e}),Rt(r))}}].map(function(r,o){const a=o!==0?8:0;return t.React.createElement(y.Button,{text:r.text,color:"green",size:"small",onPress:function(){return!n[o]&&r.onPress(function(s){i({...n,[o]:!!s})})},trailing:t.React.createElement(mt.Icon,{source:c.getAssetIDByName("Check")}),loading:n[o],style:[Ne.isTablet?{marginLeft:a}:{marginTop:a}]})})):t.React.createElement(z,{variant:"text-md/semibold",color:"TEXT_NORMAL",align:"center"},"Authenticate first to manage your data")}const{FormSwitchRow:Ce}=y.Forms;function Tt(){const[e,n]=t.React.useState(""),[,i]=t.React.useReducer(function(a){return~a},0);t.React.useEffect(function(){n("")},[]),C.useProxy(u);const r=t.NavigationNative.useNavigation(),o=r.addListener("focus",function(){o(),r.setOptions({title:"Plugin Settings",headerRight:function(){return t.React.createElement(pe,{onPress:function(){return W.showConfirmationAlert({title:"Revert Settings",content:"Are you sure you want to revert all plugin settings?",confirmText:"Revert",cancelText:"Cancel",confirmColor:"red",onConfirm:function(){return u.pluginSettings={}}})},icon:c.getAssetIDByName("ic_message_delete"),style:"header"})}})});return t.React.createElement(t.ReactNative.FlatList,{ListHeaderComponent:t.React.createElement(y.Search,{style:{marginBottom:10},onChangeText:function(a){return n(a.toLowerCase())}}),style:{paddingHorizontal:10,paddingTop:10},contentContainerStyle:{paddingBottom:20},data:Object.entries(T.plugins).filter(function(a){return a[1].manifest.name?.toLowerCase().includes(e)}),renderItem:function(a){let{item:[s,g]}=a;u.pluginSettings??={};const d=u.pluginSettings[s]??{syncPlugin:!0,syncStorage:!0},w=function(){u.pluginSettings??={},d.syncPlugin===!0&&d.syncStorage===!0?delete u.pluginSettings[s]:u.pluginSettings[s]=d,i()};return t.React.createElement(y.Summary,{label:g.manifest.name,icon:g.manifest.vendetta.icon??":3"},t.React.createElement(Ce,{label:"Sync Plugin",onValueChange:function(){d.syncPlugin=!d.syncPlugin,w()},value:d.syncPlugin}),t.React.createElement(Ce,{label:"Sync Plugin Storage",onValueChange:function(){d.syncStorage=!d.syncStorage,w()},value:d.syncStorage}))}})}var Ae={github:{url:"https://github.com/nexpid/VendettaPlugins/"}};const{showSimpleActionSheet:wt}=l.findByProps("showSimpleActionSheet"),bt=l.findByStoreName("UserStore");function Pt(){const e=Fe.getDebugInfo(),n=t.ReactNative.NativeModules.InfoDictionaryManager??t.ReactNative.NativeModules.RTNClientInfoManager;return`Device: ${e.os.name==="iOS"?e.device.codename:`${e.device.brand} ${e.device.model}`}
Model: ${e.device.model}
Manufacturer: ${e.device.manufacturer}
Brand: ${e.device.brand}

OS: ${e.os.name}
Version: ${e.os.version}

Discord Branch: ${n.ReleaseChannel}
Discord Version: ${e.discord.version}
Discord Build: ${e.discord.build}
Vendetta Version: ${e.vendetta.version}

React Version: ${e.react.version}
Hermes Bytecode: ${e.hermes.bytecodeVersion}`}function $e(e){const n=bt.getCurrentUser(),i=new URLSearchParams;for(const[r,o]of Object.entries(e))i.set(r,o);return i.set("discord-username",`@${n.username}${n.discriminator!=="0"?`#${n.discriminator}`:""}`),console.log(`${Ae.github.url}issues/new?${i.toString()}`),`${Ae.github.url}issues/new?${i.toString()}`}const Nt=function(e){return wt({key:"CardOverflow",header:{title:"GitHub Reports"},options:[{label:"Copy bug report link",icon:c.getAssetIDByName("copy"),onPress:function(){t.clipboard.setString($e({title:`bug(${e}): `,template:"bug_report.yml",labels:"bug",sysinfo:Pt()})),E.showToast("Copied",c.getAssetIDByName("toast_copy_link"))}},{label:"Copy feature suggestion link",icon:c.getAssetIDByName("copy"),onPress:function(){t.clipboard.setString($e({title:`suggest(${e}): `,labels:"suggestion",template:"suggestion.yml"})),E.showToast("Copied",c.getAssetIDByName("toast_copy_link"))}}]})},{ScrollView:Ct,View:De}=y.General,{FormRow:S,FormSwitchRow:Be}=y.Forms,_e=l.findByStoreName("UserStore");function ie(){C.useProxy(h),C.useProxy(u);const e=t.NavigationNative.useNavigation(),n=e.addListener("focus",function(){n(),e.setOptions({headerRight:function(){return t.React.createElement(pe,{icon:c.getAssetIDByName("ic_report_message"),style:"header",onPress:function(){return Nt("cloud-sync")}})}})});return t.React.createElement(Ct,null,t.React.createElement(j,{title:"Current Data",icon:c.getAssetIDByName("ic_contact_sync"),padding:!0},t.React.createElement(De,{style:{flexDirection:"row",alignItems:"center",justifyContent:"center",marginVertical:8}},t.React.createElement(Ee,{count:h.save?.sync?.plugins?.length??"-",subtitle:"plugins",contents:2}),t.React.createElement(Ee,{count:h.save?.sync?.themes?.length??"-",subtitle:"themes",contents:2}))),t.React.createElement(j,{title:"Settings",icon:c.getAssetIDByName("ic_cog_24px")},t.React.createElement(Be,{label:"Auto Save",subLabel:"Automatically save data to cloud",leading:t.React.createElement(S.Icon,{source:c.getAssetIDByName("ic_contact_sync")}),onValueChange:function(){return u.autoSync=!u.autoSync},value:u.autoSync??!1}),!oe&&u.autoSync&&t.React.createElement(z,{variant:"text-md/semibold",color:"TEXT_DANGER",style:{marginHorizontal:20,marginVertical:2}},"You must reinstall Vendetta in order to use Auto Save!"),t.React.createElement(Be,{label:"Pin To Settings",subLabel:"Pin Cloud Sync to the settings page",leading:t.React.createElement(S.Icon,{source:c.getAssetIDByName("ic_message_pin")}),onValueChange:function(){return u.addToSettings=!u.addToSettings},value:u.addToSettings??!1}),t.React.createElement(S,{label:"Plugin Settings",leading:t.React.createElement(S.Icon,{source:c.getAssetIDByName("debug")}),trailing:t.React.createElement(S.Arrow,null),onPress:function(){return e.push("VendettaCustomPage",{render:Tt})}})),t.React.createElement(j,{title:"Authentication",icon:c.getAssetIDByName("lock")},b()?t.React.createElement(t.React.Fragment,null,t.React.createElement(S,{label:"Log out",subLabel:"Logs you out of CloudSync",leading:t.React.createElement(S.Icon,{source:c.getAssetIDByName("ic_logout_24px")}),onPress:function(){u.auth??={},delete u.auth[_e.getCurrentUser().id],delete h.save,E.showToast("Successfully logged out",c.getAssetIDByName("ic_logout_24px"))}}),t.React.createElement(S,{label:"Delete data",subLabel:"Deletes your CloudSync data",leading:t.React.createElement(S.Icon,{source:c.getAssetIDByName("trash")}),onPress:async function(){await st(),u.auth??={},delete u.auth[_e.getCurrentUser().id],delete h.save,E.showToast("Successfully deleted data",c.getAssetIDByName("trash"))}})):t.React.createElement(S,{label:"Authenticate",leading:t.React.createElement(S.Icon,{source:c.getAssetIDByName("copy")}),trailing:S.Arrow,onPress:ft})),t.React.createElement(j,{title:"Data Management",icon:c.getAssetIDByName("ic_message_edit"),padding:!0},t.React.createElement(It,null),b()&&t.React.createElement(t.React.Fragment,null,t.React.createElement(We,null),t.React.createElement(S,{label:"Copy Data as JSON",leading:t.React.createElement(S.Icon,{source:c.getAssetIDByName("copy")}),onPress:function(){t.clipboard.setString(JSON.stringify(h.save??{},void 0,3)),E.showToast("Copied",c.getAssetIDByName("Check"))}}))),t.React.createElement(De,{style:{height:12}}))}let xe=0;function At(e){clearTimeout(xe),xe=setTimeout(e,1500)}const{FormRow:re}=y.Forms;function $t(){const e=t.NavigationNative.useNavigation();return React.createElement(y.ErrorBoundary,null,React.createElement(re,{label:"Cloud Sync",leading:React.createElement(re.Icon,{source:c.getAssetIDByName("ic_contact_sync")}),trailing:re.Arrow,onPress:function(){return e.push("VendettaCustomPage",{title:"CloudSync",render:ie})}}))}const{FormSection:Dt}=y.Forms,Bt=l.findByName("getScreens"),_t=l.findByName("UserSettingsOverviewWrapper",!1),xt=t.stylesheet.createThemedStyleSheet({container:{flex:1,backgroundColor:v.semanticColors.BACKGROUND_MOBILE_PRIMARY}});function Ot(e,n,i){const r=[],o=$.after("default",_t,function(a,s){o();const g=q.findInReactTree(s.props.children,function(d){return d.type&&d.type.name==="UserSettingsOverview"});r.push($.after("render",g.type.prototype,function(d,w){let{props:{children:_}}=w;const R=[t.i18n.Messages.BILLING_SETTINGS,t.i18n.Messages.PREMIUM_SETTINGS];_=q.findInReactTree(_,function(f){return f.children[1].type===Dt}).children;const p=_.findIndex(function(f){return R.includes(f?.props.label)});e()&&_.splice(p===-1?4:p,0,n({}))}))},!0);if(r.push(o),Bt&&i){const a=`VENDETTA_PLUGIN_${t.lodash.snakeCase(i.key).toUpperCase()}`,s=i.page.render,g=t.React.memo(function(R){let{navigation:p}=R;const f=p.addListener("focus",function(){f(),p.setOptions(q.without(i.page,"noErrorBoundary","render"))});return t.React.createElement(t.ReactNative.View,{style:xt.container},i.page.noErrorBoundary?t.React.createElement(s,null):t.React.createElement(y.ErrorBoundary,null,t.React.createElement(s,null)))}),d={[a]:{type:"route",title:typeof i.title=="function"?i.title:function(){return i.title},icon:i.icon,screen:{route:`VendettaPlugin${t.lodash.chain(i.key).camelCase().upperFirst().value()}`,getComponent:function(){return g}}}},w=function(R,p){const f=[...R],m=p?f?.[0]?.sections:f;if(!Array.isArray(m))return f;const x="Vendetta",O=m.find(function(L){return L?.title===x});return O&&O.settings.push(a),f},_=function(){const R=l.findByProps("useOverviewSettings"),p=l.findByProps("getSettingTitleConfig"),f=l.findByProps("SETTING_RELATIONSHIPS","SETTING_RENDERER_CONFIGS"),m="getSettingSearchListItems",x="getSettingListItems",O=l.findByProps(m),L=O?m:x,Le=O??l.findByProps(x);if(!Le||!R)return!1;r.push($.after("useOverviewSettings",R,function(le,U){return w(U,!1)})),r.push($.after("getSettingTitleConfig",p,function(le,U){return{...U,[a]:typeof i.title=="function"?i.title():i.title}})),r.push($.after(L,Le,function(le,U){let[Gt]=le;return[...Gt.includes(a)?[{type:"setting_search_result",ancestorRendererData:d[a],setting:a,title:typeof i.title=="function"?i.title():i.title,breadcrumbs:["Vendetta"],icon:d[a].icon}]:[],...U]}));const ce=f.SETTING_RELATIONSHIPS,Ft=f.SETTING_RENDERER_CONFIGS;return f.SETTING_RELATIONSHIPS={...ce,[a]:null},f.SETTING_RENDERER_CONFIGS={...Ft,...d},r.push(function(){f.SETTING_RELATIONSHIPS=ce,f.SETTING_RENDERER_CONFIGS=ce}),!0};(function(){const R=l.findByProps("SearchableSettingsList"),p=l.findByProps("SETTING_RENDERER_CONFIG"),f=l.findByProps("getSettingListItems");if(!f||!R||!p)return!1;r.push($.before("type",R.SearchableSettingsList,function(x){return w(x,!0)})),r.push($.after("getSettingListSearchResultItems",f,function(x,O){for(const L of O)L.setting===a&&(L.breadcrumbs=["Vendetta"])}));const m=p.SETTING_RENDERER_CONFIG;return p.SETTING_RENDERER_CONFIG={...m,...d},r.push(function(){p.SETTING_RENDERER_CONFIG=m}),!0})()||_()}return function(){return r.forEach(function(a){return a()})}}function Lt(){let e=[];return e.push(Ot(function(){return u.addToSettings},function(){return React.createElement($t,null)},{key:ue.plugin.manifest.name,icon:c.getAssetIDByName("ic_contact_sync"),title:"Cloud Sync",page:{title:"CloudSync",render:ie}})),function(){return e.forEach(function(n){return n()})}}const u=K.storage;let Oe;const h=C.wrapSync(C.createStorage({get:function(){return Oe},set:function(e){Oe=e}}));async function ae(){try{h.save=await ot()}catch{}}function V(e){return e.startsWith(Me.PROXY_PREFIX)}function k(e){return!e.includes("cloud-sync")}const N=async function(){if(!u.autoSync)return;const e=await be();JSON.stringify(h.save)!==JSON.stringify(e)&&At(async function(){return h.save=await Te(e)})},J=Symbol.for("vendetta.storage.emitter"),oe=!!T.plugins[J]&&!!A.themes[J];let se=[];var Mt={onLoad:function(){if(b()&&ae(),oe){const e={plugins:T.plugins[J],themes:A.themes[J]};e.plugins.on("SET",N),e.themes.on("SET",N),e.plugins.on("DEL",N),e.themes.on("DEL",N),se.push(function(){e.plugins.off("SET",N),e.themes.off("SET",N),e.plugins.off("DEL",N),e.themes.off("DEL",N)})}se.push(Lt()),K.storage.databaseMigrate&&delete K.storage.databaseMigrate},onUnload:function(){return se.forEach(function(e){return e()})},settings:ie};return I.cache=h,I.canImport=k,I.default=Mt,I.emitterAvailable=oe,I.fillCache=ae,I.isPluginProxied=V,I.vstorage=u,Object.defineProperty(I,"__esModule",{value:!0}),I})({},vendetta.plugin,vendetta.storage,vendetta.metro,vendetta.plugins,vendetta.themes,vendetta.ui.toasts,vendetta.ui.assets,vendetta.ui.alerts,vendetta.metro.common,vendetta.ui,vendetta.ui.components,vendetta.patcher,vendetta.utils,vendetta,vendetta.constants,vendetta.debug);
