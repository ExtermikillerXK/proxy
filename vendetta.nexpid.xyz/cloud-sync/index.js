(function(V,Se,X,T,W,q,L,P,ie,o,k,b,ee,ve,Le,at){"use strict";const ot=T.findByStoreName("ThemeStore"),st=T.findByProps("colors","meta");T.findByProps("triggerHaptic");const{TextStyleSheet:ct}=T.findByProps("TextStyleSheet"),{View:te,Text:ze,Pressable:lt}=b.General,ut=T.findByProps("ActionSheet")?.ActionSheet??T.find(function(r){return r.render?.name==="ActionSheet"}),{openLazy:ft,hideActionSheet:be}=T.findByProps("openLazy","hideActionSheet"),{ActionSheetTitleHeader:dt,ActionSheetCloseButton:ht,ActionSheetContentContainer:pt}=T.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton","ActionSheetContentContainer");T.findByProps("ActionSheetRow")?.ActionSheetRow,T.findByName("Navigator")??T.findByProps("Navigator")?.Navigator,T.findByProps("getRenderCloseButton")?.getRenderCloseButton??T.findByProps("getHeaderCloseButton")?.getHeaderCloseButton,T.findByProps("popModal","pushModal"),T.findByProps("SvgXml");function gt(r){return st.meta.resolveSemanticColor(ot.theme,r)}function Re(r,a){try{ft(new Promise(function(t){return t({default:r})}),"ActionSheet",a)}catch(t){Le.logger.error(t.stack),L.showToast("Got error when opening ActionSheet! Please check debug logs",P.getAssetIDByName("Smal"))}}function yt(r){let{title:a,onPress:t,icon:s}=r;const c=o.stylesheet.createThemedStyleSheet({androidRipple:{color:k.semanticColors.ANDROID_RIPPLE},icon:{height:18,tintColor:k.semanticColors.HEADER_SECONDARY,opacity:.5}}),u=t?lt:te;return o.React.createElement(u,{android_ripple:c.androidRipple,disabled:!1,accessibilityRole:"button",onPress:t,style:{marginBottom:8,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},s&&o.React.createElement(te,{style:{marginRight:4}},o.React.createElement(o.ReactNative.Image,{style:c.icon,source:s,resizeMode:"contain"})),o.React.createElement(fe,{variant:"text-sm/semibold",color:"HEADER_SECONDARY"},a))}function ue(r){let{title:a,onTitlePress:t,icon:s,children:c,padding:u}=r;const g=o.stylesheet.createThemedStyleSheet({main:{backgroundColor:k.semanticColors.CARD_PRIMARY_BG,borderRadius:16,overflow:"hidden",flex:1}});return o.React.createElement(te,{style:{marginHorizontal:16,marginTop:16}},o.React.createElement(yt,{title:a,onPress:t,icon:s}),o.React.createElement(te,{style:g.main},u?o.React.createElement(te,{style:{paddingHorizontal:16,paddingVertical:16}},c):c))}function Fe(r){let{addPadding:a}=r;const t=o.stylesheet.createThemedStyleSheet({line:{width:"100%",height:2,backgroundColor:k.semanticColors.BACKGROUND_ACCENT,borderRadius:2147483647}});return o.React.createElement(te,{style:[{marginTop:16,marginBottom:16},a&&{marginHorizontal:16}]},o.React.createElement(te,{style:t.line}))}var ke;(function(r){function a(s){let{children:c,onPress:u}=s;return o.React.createElement(fe,{variant:"text-md/bold",onPress:u},c)}r.Bold=a;function t(s){let{children:c,onPress:u}=s;return o.React.createElement(ze,{style:{textDecorationLine:"underline"},onPress:u},c)}r.Underline=t})(ke||(ke={}));function fe(r){let{variant:a,lineClamp:t,color:s,align:c,style:u,onPress:g,getChildren:E,children:_,liveUpdate:l}=r;const[w,d]=o.React.useReducer(function(S){return~S},0);return o.React.useEffect(function(){if(!l)return;const S=new Date().setMilliseconds(1e3);let e,f;return f=setTimeout(function(){d(),e=setInterval(d,1e3)},S-Date.now()),function(){clearTimeout(f),clearInterval(e)}},[]),o.React.createElement(ze,{style:[a?ct[a]:{},s?{color:gt(k.semanticColors[s])}:{},c?{textAlign:c}:{},u??{}],numberOfLines:t,onPress:g},E?.()??_)}function St(r){let{onPress:a,onLongPress:t,icon:s,style:c,destructive:u,color:g}=r;const E=o.stylesheet.createThemedStyleSheet({headerStyleIcon:{width:24,height:24,marginRight:10,tintColor:k.semanticColors.HEADER_PRIMARY},cardStyleIcon:{width:22,height:22,marginLeft:5,tintColor:k.semanticColors.INTERACTIVE_NORMAL},destructiveIcon:{tintColor:k.semanticColors.TEXT_DANGER}});return o.React.createElement(o.ReactNative.TouchableOpacity,{onPress:a,onLongPress:t},o.React.createElement(o.ReactNative.Image,{style:[typeof c=="string"?c==="header"?E.headerStyleIcon:E.cardStyleIcon:c,u&&E.destructiveIcon,g&&{tintColor:g}].filter(function(_){return!!_}),source:s}))}const{View:vt,Text:He}=b.General,{TextStyleSheet:Ue}=T.findByProps("TextStyleSheet"),Ge=o.stylesheet.createThemedStyleSheet({count:{...Ue["text-lg/bold"],color:k.semanticColors.TEXT_NORMAL,textAlign:"center"},subtitle:{...Ue["text-md/medium"],color:k.semanticColors.TEXT_MUTED,textAlign:"center"}});function Ve(r){let{subtitle:a,count:t,contents:s}=r;return React.createElement(vt,{style:{alignItems:"center",justifyContent:"center",marginHorizontal:16}},React.createElement(He,{style:Ge.count},t),React.createElement(He,{style:Ge.subtitle},a))}const Xe="https://cloudsync.nexpid.xyz/";var H={get api(){return I.host?I.host.endsWith("/")?I.host:`${I.host}/`:Xe},raw:"https://raw.githubusercontent.com/nexpid/VendettaPlugins/main/plugins/cloud-sync/",oauth2:{clientId:"1120793656878714913",get redirectURL(){return`${I.host?I.host.endsWith("/")?I.host:`${I.host}/`:Xe}api/oauth2-response`}}};function Rt(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Et(r,a){if(!(r instanceof a))throw new TypeError("Cannot call a class as a function")}function de(r,a,t){return We()?de=Reflect.construct:de=function(s,c,u){var g=[null];g.push.apply(g,c);var E=Function.bind.apply(s,g),_=new E;return u&&oe(_,u.prototype),_},de.apply(null,arguments)}function ae(r){return ae=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},ae(r)}function mt(r,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(a&&a.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),a&&oe(r,a)}function _t(r){return Function.toString.call(r).indexOf("[native code]")!==-1}function wt(r,a){return a&&(Ct(a)==="object"||typeof a=="function")?a:Rt(r)}function oe(r,a){return oe=Object.setPrototypeOf||function(t,s){return t.__proto__=s,t},oe(r,a)}function Ct(r){"@swc/helpers - typeof";return r&&typeof Symbol<"u"&&r.constructor===Symbol?"symbol":typeof r}function Ee(r){var a=typeof Map=="function"?new Map:void 0;return Ee=function(t){if(t===null||!_t(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(typeof a<"u"){if(a.has(t))return a.get(t);a.set(t,s)}function s(){return de(t,arguments,ae(this).constructor)}return s.prototype=Object.create(t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),oe(s,t)},Ee(r)}function We(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function It(r){var a=We();return function(){var t=ae(r),s;if(a){var c=ae(this).constructor;s=Reflect.construct(t,arguments,c)}else s=t.apply(this,arguments);return wt(this,s)}}const Ke=T.findByStoreName("UserStore");let se=function(r){mt(t,r);var a=It(t);function t(s){Et(this,t);var c;return c=a.call(this,`${s.status}: ${s.message}${s.error?` (${s.error})`:""}`),c.name=c.constructor.name,c}return t}(Ee(Error));function ne(){return I.auth?.[Ke.getCurrentUser()?.id]}async function me(){var r;const a=new Error("Unauthorized, try logging out and back in again");let t=ne();if(!t)throw a;if(Date.now()>=t.expiresAt){const s=await fetch(`${H.api}api/refresh-access-token?refresh_token=${encodeURIComponent(t.refreshToken)}`);if(s.status!==200)throw new se(await s.json());t=await s.json(),(r=I).auth??(r.auth={}),I.auth[Ke.getCurrentUser().id]=t}return t.accessToken}async function Bt(r){const a=await fetch(`${H.api}api/get-access-token?code=${encodeURIComponent(r)}`);if(a.status===200)return await a.json();throw new se(await a.json())}async function Pt(){if(!ne())return;const r=await fetch(`${H.api}api/get-data`,{headers:{authorization:await me()}});if(r.status===200)return await r.json();throw new se(await r.json())}async function Ye(r){if(!ne())return;const a=await fetch(`${H.api}api/sync-data`,{method:"POST",headers:{authorization:await me(),"content-type":"application/json"},body:JSON.stringify(r)});if(a.status===200)return await a.json();throw new se(await a.json())}async function Tt(){if(!ne())return;const r=await fetch(`${H.api}api/delete-data`,{method:"DELETE",headers:{authorization:await me()}});if(r.status===200)return await r.json();throw new se(await r.json())}const{pushModal:At,popModal:xt}=T.findByProps("pushModal","popModal"),Nt=T.findByName("OAuth2AuthorizeModal"),Dt=T.findByStoreName("UserStore");function Ot(){At({key:"oauth2-authorize",modal:{key:"oauth2-authorize",modal:Nt,animation:"slide-up",shouldPersistUnderModals:!1,props:{clientId:H.oauth2.clientId,redirectUri:H.oauth2.redirectURL,scopes:["identify"],responseType:"code",permissions:0n,cancelCompletesFlow:!1,callback:async function(r){var a;let{location:t}=r;try{const s=new URL(t).searchParams.get("code"),c=await Bt(s);(a=I).auth??(a.auth={}),I.auth[Dt.getCurrentUser().id]=c,xe(),L.showToast("Successfully authenticated",P.getAssetIDByName("Check"))}catch(s){L.showToast(String(s),P.getAssetIDByName("Small"))}},dismissOAuthModal:function(){return xt("oauth2-authorize")}},closable:!0}})}const{FormSwitchRow:Je}=b.Forms;function $t(){const[r,a]=o.React.useState(""),[,t]=o.React.useReducer(function(u){return~u},0);o.React.useEffect(function(){a("")},[]),X.useProxy(I);const s=o.NavigationNative.useNavigation(),c=s.addListener("focus",function(){c(),s.setOptions({title:"Plugin Settings",headerRight:function(){return o.React.createElement(St,{onPress:function(){return ie.showConfirmationAlert({title:"Revert Settings",content:"Are you sure you want to revert all plugin settings?",confirmText:"Revert",cancelText:"Cancel",confirmColor:"red",onConfirm:function(){return I.pluginSettings={}}})},icon:P.getAssetIDByName("ic_message_delete"),style:"header"})}})});return o.React.createElement(o.ReactNative.FlatList,{ListHeaderComponent:o.React.createElement(b.Search,{style:{marginBottom:10},onChangeText:function(u){return a(u.toLowerCase())}}),style:{paddingHorizontal:10,paddingTop:10},contentContainerStyle:{paddingBottom:20},data:Object.entries(W.plugins).filter(function(u){return u[1].manifest.name?.toLowerCase().includes(r)}),renderItem:function(u){var g;let{item:[E,_]}=u;(g=I).pluginSettings??(g.pluginSettings={});const l=I.pluginSettings[E]??{syncPlugin:!0,syncStorage:!0},w=function(){var d;(d=I).pluginSettings??(d.pluginSettings={}),l.syncPlugin===!0&&l.syncStorage===!0?delete I.pluginSettings[E]:I.pluginSettings[E]=l,t()};return o.React.createElement(b.Summary,{label:_.manifest.name,icon:_.manifest.vendetta.icon??":3"},o.React.createElement(Je,{label:"Sync Plugin",onValueChange:function(){l.syncPlugin=!l.syncPlugin,w()},value:l.syncPlugin}),o.React.createElement(Je,{label:"Sync Plugin Storage",onValueChange:function(){l.syncStorage=!l.syncStorage,w()},value:l.syncStorage}))}})}let he=!1,_e;const we=[];function Mt(){we.length=0,_e?.()}function Q(r,a){we.push([r,a]),_e?.()}const Lt={themes:"#42f5a4",plugins:"#4290f5",importer:"#e6f542"},Ze=o.stylesheet.createThemedStyleSheet({text:{fontFamily:o.constants.Fonts.CODE_SEMIBOLD,includeFontPadding:!1,color:k.semanticColors.TEXT_NORMAL,marginHorizontal:12,marginTop:24}}),zt=function(){const[r,a]=o.React.useReducer(function(s){return~s},0);_e=a;const t=o.React.useRef();return o.React.useEffect(function(){return he=!0,function(){he=!1}},[]),o.React.createElement(o.ReactNative.ScrollView,{style:{flex:1},ref:t,onContentSizeChange:function(){return t.current.scrollToEnd({animated:!0})}},o.React.createElement(o.ReactNative.Text,{style:Ze.text},we.map(function(s){let[c,u]=s;return[o.React.createElement(o.ReactNative.Text,{style:[Ze.text,{color:Lt[c]}]},"[",c.toUpperCase(),"]:"),` ${u}
`]})))};function bt(r){r.push("VendettaCustomPage",{render:zt,title:"Import Logs"})}const{MMKVManager:Ft}=window.nativeModuleProxy;async function Qe(){const r={themes:[],plugins:[]};for(const a of Object.values(W.plugins)){const t=I.pluginSettings?.[a.id];if(t?.syncPlugin===!1)continue;const s=t?.syncStorage===!1?{}:await X.createMMKVBackend(a.id).get();r.plugins.push({id:a.id,enabled:a.enabled,options:s})}for(const a of Object.values(q.themes))r.themes.push({id:a.id,enabled:a.selected});return r}let pe;function je(r){pe=r}async function kt(r,a){if(!r)return;pe?.(!0);const t=[...r.sync.plugins.filter(function(g){return!W.plugins[g.id]&&!ce(g.id)&&le(g.id)&&a.unproxiedPlugins}),...r.sync.plugins.filter(function(g){return!W.plugins[g.id]&&ce(g.id)&&le(g.id)&&a.plugins})],s=r.sync.themes.filter(function(g){return!q.themes[g.id]&&a.themes});if(!t[0]&&!s[0])return pe?.(!1),L.showToast("Nothing to import",P.getAssetIDByName("Small"));Mt(),Q("importer",`Starting to import ${t.length} plugin${t.length!==1?"s":""} and ${s.length} theme${s.length!==1?"s":""}`),he||L.showToast(`Importing ${[t.length&&`${t.length} plugin${t.length!==1?"s":""}`,s.length&&`${s.length} theme${s.length!==1?"s":""}`].filter(function(g){return!!g}).join(" and ")}`,P.getAssetIDByName("toast_image_saved"));const c={plugins:0,themes:0,failed:0};await Promise.all([...t.map(function(g){return new Promise(async function(E){Ft.setItem(g.id,JSON.stringify(g.options)),W.installPlugin(g.id,g.enabled).then(function(){c.plugins++,Q("plugins",`Successfully imported plugin: ${g.id}`)}).catch(function(_){c.failed++,Q("plugins",`Failed to import plugin: ${g.id}
${_}`)}).finally(E)})}),...s.map(function(g){return new Promise(async function(E){return q.installTheme(g.id).then(function(){c.themes++,Q("themes",`Successfully imported theme: ${g.id}`)}).catch(function(_){c.failed++,Q("themes",`Failed to import theme: ${g.id}
${_}`)}).finally(E)})})]),he||L.showToast(`Imported ${[[c.plugins,"plugin"],[c.themes,"theme"]].map(function(g){let[E,_]=g;return`${E} ${_}${E!==1?"s":""}`}).join(" and ")}! (${c.failed} failed)`,P.getAssetIDByName("check"));const u=q.themes[s.find(function(g){return g.enabled})?.id];u&&(Q("themes",`Selecting theme: ${u.id}`),await X.createFileBackend("vendetta_theme.json").set(Object.assign(u,{selected:!0})),Q("themes","Prompting user to reload"),await function(){return new Promise(function(g){return ie.showConfirmationAlert({title:"Theme selected",content:"A reload is required to see the theme. Do you want to reload now?",confirmText:"Reload",confirmColor:"red",onConfirm:function(){window.nativeModuleProxy.BundleUpdaterManager.reload(),g()},cancelText:"Skip",onCancel:g,isDismissable:!0})})}()),Q("importer",`Finished! Imported ${c.plugins} plugin${c.plugins!==1?"s":""} and ${c.themes} theme${c.themes!==1?"s":""}. ${c.failed?`Failed to import ${c.failed} plugin${c.failed!==1?"s":""}/theme${c.failed!==1?"s":""}`:"All imports were successful"}`),pe?.(!1)}const{FormCheckboxRow:Ce}=b.Forms;function Ie(r){let{defOptions:a,save:t=F.save,navigation:s}=r;const c={unproxiedPlugins:t.sync.plugins.filter(function(E){return!W.plugins[E.id]&&!ce(E.id)&&le(E.id)}).length,plugins:t.sync.plugins.filter(function(E){return!W.plugins[E.id]&&ce(E.id)&&le(E.id)}).length,themes:t.sync.themes.filter(function(E){return!q.themes[E.id]}).length},[u,g]=o.React.useState(a??{unproxiedPlugins:!1,plugins:!!c.plugins,themes:!!c.themes});return o.React.createElement(ut,null,o.React.createElement(pt,null,o.React.createElement(dt,{title:"Import Data",trailing:o.React.createElement(ht,{onPress:function(){return be()}})}),o.React.createElement(Ce,{label:`Unproxied Plugins (${c.unproxiedPlugins})`,disabled:!c.unproxiedPlugins,onPress:function(){return c.unproxiedPlugins&&(!u.unproxiedPlugins&&!a?ie.showConfirmationAlert({title:"Warning",content:"Installing unproxied plugins can be dangerous since they haven't been verified by Vendetta staff. Are you sure you want to import them?",isDismissable:!0,confirmText:"Yes",confirmColor:"brand",onConfirm:function(){return Re(Ie,{navigation:s,defOptions:{...u,unproxiedPlugins:!0}})},cancelText:"Cancel"}):g({...u,unproxiedPlugins:!u.unproxiedPlugins}))},selected:u.unproxiedPlugins}),o.React.createElement(Ce,{label:`Plugins (${c.plugins})`,disabled:!c.plugins,onPress:function(){return c.plugins&&g({...u,plugins:!u.plugins})},selected:u.plugins}),o.React.createElement(Ce,{label:`Themes (${c.themes})`,disabled:!c.themes,onPress:function(){return c.themes&&g({...u,themes:!u.themes})},selected:u.themes}),o.React.createElement(b.Button,{text:"Import",color:"green",size:"medium",renderIcon:function(){return o.React.createElement(o.ReactNative.Image,{style:{marginRight:8},source:P.getAssetIDByName("ic_download_24px")})},onPress:function(){bt(s),kt(t,u),be()},style:{marginHorizontal:16,marginVertical:16},disabled:!u.unproxiedPlugins&&!u.plugins&&!u.themes})))}let re=function(r,a){var t={},s=t.lib={},c=function(){},u=s.Base={extend:function(e){c.prototype=this;var f=new c;return e&&f.mixIn(e),f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)}),f.init.prototype=f,f.$super=this,f},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var f in e)e.hasOwnProperty(f)&&(this[f]=e[f]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},g=s.WordArray=u.extend({init:function(e,f){e=this.words=e||[],this.sigBytes=f!=a?f:4*e.length},toString:function(e){return(e||_).stringify(this)},concat:function(e){var f=this.words,n=e.words,i=this.sigBytes;if(e=e.sigBytes,this.clamp(),i%4)for(var p=0;p<e;p++)f[i+p>>>2]|=(n[p>>>2]>>>24-8*(p%4)&255)<<24-8*((i+p)%4);else if(65535<n.length)for(p=0;p<e;p+=4)f[i+p>>>2]=n[p>>>2];else f.push.apply(f,n);return this.sigBytes+=e,this},clamp:function(){var e=this.words,f=this.sigBytes;e[f>>>2]&=4294967295<<32-8*(f%4),e.length=r.ceil(f/4)},clone:function(){var e=u.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var f=[],n=0;n<e;n+=4)f.push(4294967296*r.random()|0);return new g.init(f,e)}}),E=t.enc={},_=E.Hex={stringify:function(e){var f=e.words;e=e.sigBytes;for(var n=[],i=0;i<e;i++){var p=f[i>>>2]>>>24-8*(i%4)&255;n.push((p>>>4).toString(16)),n.push((p&15).toString(16))}return n.join("")},parse:function(e){for(var f=e.length,n=[],i=0;i<f;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-4*(i%8);return new g.init(n,f/2)}},l=E.Latin1={stringify:function(e){var f=e.words;e=e.sigBytes;for(var n=[],i=0;i<e;i++)n.push(String.fromCharCode(f[i>>>2]>>>24-8*(i%4)&255));return n.join("")},parse:function(e){for(var f=e.length,n=[],i=0;i<f;i++)n[i>>>2]|=(e.charCodeAt(i)&255)<<24-8*(i%4);return new g.init(n,f)}},w=E.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch{throw Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},d=s.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(e){typeof e=="string"&&(e=w.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var f=this._data,n=f.words,i=f.sigBytes,p=this.blockSize,m=i/(4*p),m=e?r.ceil(m):r.max((m|0)-this._minBufferSize,0);if(e=m*p,i=r.min(4*e,i),e){for(var B=0;B<e;B+=p)this._doProcessBlock(n,B);B=n.splice(0,e),f.sigBytes-=i}return new g.init(B,i)},clone:function(){var e=u.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});s.Hasher=d.extend({cfg:u.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(f,n){return new e.init(n).finalize(f)}},_createHmacHelper:function(e){return function(f,n){return new S.HMAC.init(e,n).finalize(f)}}});var S=t.algo={};return t}(Math);(function(){var r=re,a=r.lib.WordArray;r.enc.Base64={stringify:function(t){var s=t.words,c=t.sigBytes,u=this._map;t.clamp(),t=[];for(var g=0;g<c;g+=3)for(var E=(s[g>>>2]>>>24-8*(g%4)&255)<<16|(s[g+1>>>2]>>>24-8*((g+1)%4)&255)<<8|s[g+2>>>2]>>>24-8*((g+2)%4)&255,_=0;4>_&&g+.75*_<c;_++)t.push(u.charAt(E>>>6*(3-_)&63));if(s=u.charAt(64))for(;t.length%4;)t.push(s);return t.join("")},parse:function(t){var s=t.length,c=this._map,u=c.charAt(64);u&&(u=t.indexOf(u),u!=-1&&(s=u));for(var u=[],g=0,E=0;E<s;E++)if(E%4){var _=c.indexOf(t.charAt(E-1))<<2*(E%4),l=c.indexOf(t.charAt(E))>>>6-2*(E%4);u[g>>>2]|=(_|l)<<24-8*(g%4),g++}return a.create(u,g)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})(),function(r){function a(d,S,e,f,n,i,p){return d=d+(S&e|~S&f)+n+p,(d<<i|d>>>32-i)+S}function t(d,S,e,f,n,i,p){return d=d+(S&f|e&~f)+n+p,(d<<i|d>>>32-i)+S}function s(d,S,e,f,n,i,p){return d=d+(S^e^f)+n+p,(d<<i|d>>>32-i)+S}function c(d,S,e,f,n,i,p){return d=d+(e^(S|~f))+n+p,(d<<i|d>>>32-i)+S}for(var u=re,_=u.lib,g=_.WordArray,E=_.Hasher,_=u.algo,l=[],w=0;64>w;w++)l[w]=4294967296*r.abs(r.sin(w+1))|0;_=_.MD5=E.extend({_doReset:function(){this._hash=new g.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(d,S){for(var e=0;16>e;e++){var f=S+e,n=d[f];d[f]=(n<<8|n>>>24)&16711935|(n<<24|n>>>8)&4278255360}var e=this._hash.words,f=d[S+0],n=d[S+1],i=d[S+2],p=d[S+3],m=d[S+4],B=d[S+5],D=d[S+6],G=d[S+7],z=d[S+8],A=d[S+9],C=d[S+10],N=d[S+11],M=d[S+12],O=d[S+13],x=d[S+14],K=d[S+15],h=e[0],v=e[1],y=e[2],R=e[3],h=a(h,v,y,R,f,7,l[0]),R=a(R,h,v,y,n,12,l[1]),y=a(y,R,h,v,i,17,l[2]),v=a(v,y,R,h,p,22,l[3]),h=a(h,v,y,R,m,7,l[4]),R=a(R,h,v,y,B,12,l[5]),y=a(y,R,h,v,D,17,l[6]),v=a(v,y,R,h,G,22,l[7]),h=a(h,v,y,R,z,7,l[8]),R=a(R,h,v,y,A,12,l[9]),y=a(y,R,h,v,C,17,l[10]),v=a(v,y,R,h,N,22,l[11]),h=a(h,v,y,R,M,7,l[12]),R=a(R,h,v,y,O,12,l[13]),y=a(y,R,h,v,x,17,l[14]),v=a(v,y,R,h,K,22,l[15]),h=t(h,v,y,R,n,5,l[16]),R=t(R,h,v,y,D,9,l[17]),y=t(y,R,h,v,N,14,l[18]),v=t(v,y,R,h,f,20,l[19]),h=t(h,v,y,R,B,5,l[20]),R=t(R,h,v,y,C,9,l[21]),y=t(y,R,h,v,K,14,l[22]),v=t(v,y,R,h,m,20,l[23]),h=t(h,v,y,R,A,5,l[24]),R=t(R,h,v,y,x,9,l[25]),y=t(y,R,h,v,p,14,l[26]),v=t(v,y,R,h,z,20,l[27]),h=t(h,v,y,R,O,5,l[28]),R=t(R,h,v,y,i,9,l[29]),y=t(y,R,h,v,G,14,l[30]),v=t(v,y,R,h,M,20,l[31]),h=s(h,v,y,R,B,4,l[32]),R=s(R,h,v,y,z,11,l[33]),y=s(y,R,h,v,N,16,l[34]),v=s(v,y,R,h,x,23,l[35]),h=s(h,v,y,R,n,4,l[36]),R=s(R,h,v,y,m,11,l[37]),y=s(y,R,h,v,G,16,l[38]),v=s(v,y,R,h,C,23,l[39]),h=s(h,v,y,R,O,4,l[40]),R=s(R,h,v,y,f,11,l[41]),y=s(y,R,h,v,p,16,l[42]),v=s(v,y,R,h,D,23,l[43]),h=s(h,v,y,R,A,4,l[44]),R=s(R,h,v,y,M,11,l[45]),y=s(y,R,h,v,K,16,l[46]),v=s(v,y,R,h,i,23,l[47]),h=c(h,v,y,R,f,6,l[48]),R=c(R,h,v,y,G,10,l[49]),y=c(y,R,h,v,x,15,l[50]),v=c(v,y,R,h,B,21,l[51]),h=c(h,v,y,R,M,6,l[52]),R=c(R,h,v,y,p,10,l[53]),y=c(y,R,h,v,C,15,l[54]),v=c(v,y,R,h,n,21,l[55]),h=c(h,v,y,R,z,6,l[56]),R=c(R,h,v,y,K,10,l[57]),y=c(y,R,h,v,D,15,l[58]),v=c(v,y,R,h,O,21,l[59]),h=c(h,v,y,R,m,6,l[60]),R=c(R,h,v,y,N,10,l[61]),y=c(y,R,h,v,i,15,l[62]),v=c(v,y,R,h,A,21,l[63]);e[0]=e[0]+h|0,e[1]=e[1]+v|0,e[2]=e[2]+y|0,e[3]=e[3]+R|0},_doFinalize:function(){var d=this._data,S=d.words,e=8*this._nDataBytes,f=8*d.sigBytes;S[f>>>5]|=128<<24-f%32;var n=r.floor(e/4294967296);for(S[(f+64>>>9<<4)+15]=(n<<8|n>>>24)&16711935|(n<<24|n>>>8)&4278255360,S[(f+64>>>9<<4)+14]=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360,d.sigBytes=4*(S.length+1),this._process(),d=this._hash,S=d.words,e=0;4>e;e++)f=S[e],S[e]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;return d},clone:function(){var d=E.clone.call(this);return d._hash=this._hash.clone(),d}}),u.MD5=E._createHelper(_),u.HmacMD5=E._createHmacHelper(_)}(Math),function(){var r=re,s=r.lib,a=s.Base,t=s.WordArray,s=r.algo,c=s.EvpKDF=a.extend({cfg:a.extend({keySize:4,hasher:s.MD5,iterations:1}),init:function(u){this.cfg=this.cfg.extend(u)},compute:function(u,g){for(var d=this.cfg,E=d.hasher.create(),_=t.create(),l=_.words,w=d.keySize,d=d.iterations;l.length<w;){S&&E.update(S);var S=E.update(u).finalize(g);E.reset();for(var e=1;e<d;e++)S=E.finalize(S),E.reset();_.concat(S)}return _.sigBytes=4*w,_}});r.EvpKDF=function(u,g,E){return c.create(E).compute(u,g)}}(),re.lib.Cipher||function(r){var e=re,a=e.lib,t=a.Base,s=a.WordArray,c=a.BufferedBlockAlgorithm,u=e.enc.Base64,g=e.algo.EvpKDF,E=a.Cipher=c.extend({cfg:t.extend(),createEncryptor:function(n,i){return this.create(this._ENC_XFORM_MODE,n,i)},createDecryptor:function(n,i){return this.create(this._DEC_XFORM_MODE,n,i)},init:function(n,i,p){this.cfg=this.cfg.extend(p),this._xformMode=n,this._key=i,this.reset()},reset:function(){c.reset.call(this),this._doReset()},process:function(n){return this._append(n),this._process()},finalize:function(n){return n&&this._append(n),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(n){return{encrypt:function(i,p,m){return(typeof p=="string"?f:S).encrypt(n,i,p,m)},decrypt:function(i,p,m){return(typeof p=="string"?f:S).decrypt(n,i,p,m)}}}});a.StreamCipher=E.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var d=e.mode={},_=function(n,i,p){var m=this._iv;m?this._iv=r:m=this._prevBlock;for(var B=0;B<p;B++)n[i+B]^=m[B]},l=(a.BlockCipherMode=t.extend({createEncryptor:function(n,i){return this.Encryptor.create(n,i)},createDecryptor:function(n,i){return this.Decryptor.create(n,i)},init:function(n,i){this._cipher=n,this._iv=i}})).extend();l.Encryptor=l.extend({processBlock:function(n,i){var p=this._cipher,m=p.blockSize;_.call(this,n,i,m),p.encryptBlock(n,i),this._prevBlock=n.slice(i,i+m)}}),l.Decryptor=l.extend({processBlock:function(n,i){var p=this._cipher,m=p.blockSize,B=n.slice(i,i+m);p.decryptBlock(n,i),_.call(this,n,i,m),this._prevBlock=B}}),d=d.CBC=l,l=(e.pad={}).Pkcs7={pad:function(n,i){for(var p=4*i,p=p-n.sigBytes%p,m=p<<24|p<<16|p<<8|p,B=[],D=0;D<p;D+=4)B.push(m);p=s.create(B,p),n.concat(p)},unpad:function(n){n.sigBytes-=n.words[n.sigBytes-1>>>2]&255}},a.BlockCipher=E.extend({cfg:E.cfg.extend({mode:d,padding:l}),reset:function(){E.reset.call(this);var i=this.cfg,n=i.iv,i=i.mode;if(this._xformMode==this._ENC_XFORM_MODE)var p=i.createEncryptor;else p=i.createDecryptor,this._minBufferSize=1;this._mode=p.call(i,this,n&&n.words)},_doProcessBlock:function(n,i){this._mode.processBlock(n,i)},_doFinalize:function(){var n=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){n.pad(this._data,this.blockSize);var i=this._process(!0)}else i=this._process(!0),n.unpad(i);return i},blockSize:4});var w=a.CipherParams=t.extend({init:function(n){this.mixIn(n)},toString:function(n){return(n||this.formatter).stringify(this)}}),d=(e.format={}).OpenSSL={stringify:function(n){var i=n.ciphertext;return n=n.salt,(n?s.create([1398893684,1701076831]).concat(n).concat(i):i).toString(u)},parse:function(n){n=u.parse(n);var i=n.words;if(i[0]==1398893684&&i[1]==1701076831){var p=s.create(i.slice(2,4));i.splice(0,4),n.sigBytes-=16}return w.create({ciphertext:n,salt:p})}},S=a.SerializableCipher=t.extend({cfg:t.extend({format:d}),encrypt:function(n,i,p,m){m=this.cfg.extend(m);var B=n.createEncryptor(p,m);return i=B.finalize(i),B=B.cfg,w.create({ciphertext:i,key:p,iv:B.iv,algorithm:n,mode:B.mode,padding:B.padding,blockSize:n.blockSize,formatter:m.format})},decrypt:function(n,i,p,m){return m=this.cfg.extend(m),i=this._parse(i,m.format),n.createDecryptor(p,m).finalize(i.ciphertext)},_parse:function(n,i){return typeof n=="string"?i.parse(n,this):n}}),e=(e.kdf={}).OpenSSL={execute:function(n,i,p,m){return m||(m=s.random(8)),n=g.create({keySize:i+p}).compute(n,m),p=s.create(n.words.slice(i),4*p),n.sigBytes=4*i,w.create({key:n,iv:p,salt:m})}},f=a.PasswordBasedCipher=S.extend({cfg:S.cfg.extend({kdf:e}),encrypt:function(n,i,p,m){return m=this.cfg.extend(m),p=m.kdf.execute(p,n.keySize,n.ivSize),m.iv=p.iv,n=S.encrypt.call(this,n,i,p.key,m),n.mixIn(p),n},decrypt:function(n,i,p,m){return m=this.cfg.extend(m),i=this._parse(i,m.format),p=m.kdf.execute(p,n.keySize,n.ivSize,i.salt),m.iv=p.iv,S.decrypt.call(this,n,i,p.key,m)}})}(),function(){for(var r=re,a=r.lib.BlockCipher,z=r.algo,t=[],s=[],c=[],u=[],g=[],E=[],_=[],l=[],w=[],d=[],S=[],e=0;256>e;e++)S[e]=128>e?e<<1:e<<1^283;for(var f=0,n=0,e=0;256>e;e++){var i=n^n<<1^n<<2^n<<3^n<<4,i=i>>>8^i&255^99;t[f]=i,s[i]=f;var p=S[f],m=S[p],B=S[m],D=257*S[i]^16843008*i;c[f]=D<<24|D>>>8,u[f]=D<<16|D>>>16,g[f]=D<<8|D>>>24,E[f]=D,D=16843009*B^65537*m^257*p^16843008*f,_[i]=D<<24|D>>>8,l[i]=D<<16|D>>>16,w[i]=D<<8|D>>>24,d[i]=D,f?(f=p^S[S[S[B^p]]],n^=S[S[n]]):f=n=1}var G=[0,1,2,4,8,16,32,64,128,27,54],z=z.AES=a.extend({_doReset:function(){for(var N=this._key,A=N.words,C=N.sigBytes/4,N=4*((this._nRounds=C+6)+1),M=this._keySchedule=[],O=0;O<N;O++)if(O<C)M[O]=A[O];else{var x=M[O-1];O%C?6<C&&O%C==4&&(x=t[x>>>24]<<24|t[x>>>16&255]<<16|t[x>>>8&255]<<8|t[x&255]):(x=x<<8|x>>>24,x=t[x>>>24]<<24|t[x>>>16&255]<<16|t[x>>>8&255]<<8|t[x&255],x^=G[O/C|0]<<24),M[O]=M[O-C]^x}for(A=this._invKeySchedule=[],C=0;C<N;C++)O=N-C,x=C%4?M[O]:M[O-4],A[C]=4>C||4>=O?x:_[t[x>>>24]]^l[t[x>>>16&255]]^w[t[x>>>8&255]]^d[t[x&255]]},encryptBlock:function(A,C){this._doCryptBlock(A,C,this._keySchedule,c,u,g,E,t)},decryptBlock:function(A,C){var N=A[C+1];A[C+1]=A[C+3],A[C+3]=N,this._doCryptBlock(A,C,this._invKeySchedule,_,l,w,d,s),N=A[C+1],A[C+1]=A[C+3],A[C+3]=N},_doCryptBlock:function(A,C,N,M,O,x,K,h){for(var R=this._nRounds,Y=A[C]^N[0],J=A[C+1]^N[1],Z=A[C+2]^N[2],U=A[C+3]^N[3],y=4,v=1;v<R;v++)var Oe=M[Y>>>24]^O[J>>>16&255]^x[Z>>>8&255]^K[U&255]^N[y++],$e=M[J>>>24]^O[Z>>>16&255]^x[U>>>8&255]^K[Y&255]^N[y++],Me=M[Z>>>24]^O[U>>>16&255]^x[Y>>>8&255]^K[J&255]^N[y++],U=M[U>>>24]^O[Y>>>16&255]^x[J>>>8&255]^K[Z&255]^N[y++],Y=Oe,J=$e,Z=Me;Oe=(h[Y>>>24]<<24|h[J>>>16&255]<<16|h[Z>>>8&255]<<8|h[U&255])^N[y++],$e=(h[J>>>24]<<24|h[Z>>>16&255]<<16|h[U>>>8&255]<<8|h[Y&255])^N[y++],Me=(h[Z>>>24]<<24|h[U>>>16&255]<<16|h[Y>>>8&255]<<8|h[J&255])^N[y++],U=(h[U>>>24]<<24|h[Y>>>16&255]<<16|h[J>>>8&255]<<8|h[Z&255])^N[y++],A[C]=Oe,A[C+1]=$e,A[C+2]=Me,A[C+3]=U},keySize:8});r.AES=a._createHelper(z)}();var Be=re;function Ht(r,a){return Be.AES.encrypt(r,a).toString()}function Ut(r,a){return Be.AES.decrypt(r,a).toString(Be.enc.Utf8)}const ge=window.nativeModuleProxy.DCDSoundManager;async function qe(r){const a=Math.floor(Math.random()*1e6),t=await Promise.resolve(new Promise(function(c){return ge.prepare(r,"notification",a,function(u,g){return c(g.duration)})}));let s=null;return{play(){s&&(clearTimeout(s),s=null,ge.stop(a)),ge.play(a),s=setTimeout(function(){s=null,ge.stop(a)},t)}}}const{ScrollView:Gt,View:et}=b.General,{FormRow:$,FormInput:Vt,FormSwitchRow:tt}=b.Forms,nt=T.findByStoreName("UserStore"),Pe=T.findByProps("pickSingle","isCancel"),Xt=X.wrapSync(qe(`${H.raw}assets/snd_creepyjingle.ogg`)),Wt=X.wrapSync(qe(`${H.raw}assets/snd_mysterygo.ogg`));function Te(){const[r,a]=o.React.useState(!1),[t,s]=o.React.useState([]);X.useProxy(F),X.useProxy(I);const c=function(w){return!t.includes(w)&&s([...t,w])},u=function(w){return s(t.filter(function(d){return w!==d}))};let g=0;const E=o.NavigationNative.useNavigation(),_=!!ne(),l=!!F.save;return o.React.createElement(Gt,null,o.React.createElement(ue,{title:"Current Data",icon:P.getAssetIDByName("ic_contact_sync"),padding:!0},o.React.createElement(et,{style:{flexDirection:"row",alignItems:"center",justifyContent:"center",marginVertical:8}},o.React.createElement(Ve,{count:F.save?.sync?.plugins?.length??"-",subtitle:"plugins",contents:2}),o.React.createElement(Ve,{count:F.save?.sync?.themes?.length??"-",subtitle:"themes",contents:2}))),o.React.createElement(ue,{title:"Settings",icon:P.getAssetIDByName("ic_cog_24px"),onTitlePress:function(){return g>=Date.now()?(r?Wt.play():Xt.play(),a(!r),g=0):g=Date.now()+500}},o.React.createElement(tt,{label:"Auto Save",subLabel:"Automatically save data to cloud",leading:o.React.createElement($.Icon,{source:P.getAssetIDByName("ic_contact_sync")}),onValueChange:function(){return I.autoSync=!I.autoSync},value:I.autoSync??!1}),!Ne&&I.autoSync&&o.React.createElement(fe,{variant:"text-md/semibold",color:"TEXT_DANGER",style:{marginHorizontal:20,marginVertical:2}},"You must reinstall Vendetta in order to use Auto Save!"),o.React.createElement(tt,{label:"Pin To Settings",subLabel:"Pin Cloud Sync to the settings page",leading:o.React.createElement($.Icon,{source:P.getAssetIDByName("ic_message_pin")}),onValueChange:function(){return I.addToSettings=!I.addToSettings},value:I.addToSettings??!1}),o.React.createElement($,{label:"Plugin Settings",leading:o.React.createElement($.Icon,{source:P.getAssetIDByName("debug")}),trailing:o.React.createElement($.Arrow,null),onPress:function(){return E.push("VendettaCustomPage",{render:$t})}}),r&&o.React.createElement(o.React.Fragment,null,o.React.createElement(Fe,{addPadding:!0}),o.React.createElement($,{label:"Custom Host",subLabel:"Custom URL for the CloudSync backend API",leading:o.React.createElement($.Icon,{source:P.getAssetIDByName("ic_message_edit")})}),o.React.createElement(Vt,{title:"",keyboardType:"numeric",placeholder:"1",value:H.api,onChange:function(w){return I.host=w},style:{marginTop:-25,marginHorizontal:12}}))),o.React.createElement(ue,{title:"Authentication",icon:P.getAssetIDByName("lock")},ne()?o.React.createElement(o.React.Fragment,null,o.React.createElement($,{label:"Log out",subLabel:"Logs you out of CloudSync",leading:o.React.createElement($.Icon,{source:P.getAssetIDByName("ic_logout_24px")}),onPress:function(){var w;(w=I).auth??(w.auth={}),delete I.auth[nt.getCurrentUser().id],delete F.save,L.showToast("Successfully logged out",P.getAssetIDByName("ic_logout_24px"))}}),o.React.createElement($,{label:"Delete data",subLabel:"Deletes your CloudSync data",leading:o.React.createElement($.Icon,{source:P.getAssetIDByName("trash")}),onPress:async function(){var w;await Tt(),(w=I).auth??(w.auth={}),delete I.auth[nt.getCurrentUser().id],delete F.save,L.showToast("Successfully deleted data",P.getAssetIDByName("trash"))}})):o.React.createElement($,{label:"Authenticate",leading:o.React.createElement($.Icon,{source:P.getAssetIDByName("copy")}),trailing:$.Arrow,onPress:Ot})),o.React.createElement(ue,{title:"Data Management",icon:P.getAssetIDByName("ic_message_edit"),padding:!_||!l},_&&l?o.React.createElement(o.React.Fragment,null,o.React.createElement($,{label:"Save Data",subLabel:"Saves your data to the CloudSync API",leading:t.includes("save_api")?o.React.createElement(o.ReactNative.ActivityIndicator,{size:"small"}):o.React.createElement($.Icon,{source:P.getAssetIDByName("ic_file_upload_24px")}),onPress:function(){ie.showConfirmationAlert({title:"Save data",content:"Are you sure you want to overwrite your save data?",confirmText:"Overwrite",confirmColor:"BRAND",onConfirm:async function(){c("save_api");try{F.save=await Ye(await Qe()),L.showToast("Successfully synced data",P.getAssetIDByName("Check"))}catch(w){L.showToast(String(w),P.getAssetIDByName("Small"))}u("save_api")},cancelText:"Cancel"})}}),o.React.createElement($,{label:"Import Data",subLabel:"Imports data from the CloudSync API",leading:t.includes("import_api")?o.React.createElement(o.ReactNative.ActivityIndicator,{size:"small"}):o.React.createElement($.Icon,{source:P.getAssetIDByName("ic_download_24px")}),onPress:function(){Re(Ie,{navigation:E}),je(function(w){return w?c("import_api"):u("import_api")})}}),o.React.createElement(Fe,{addPadding:!0}),o.React.createElement($,{label:"Export Local Data",subLabel:"Exports data to a .txt file",leading:t.includes("export_local")?o.React.createElement(o.ReactNative.ActivityIndicator,{size:"small"}):o.React.createElement($.Icon,{source:P.getAssetIDByName("ic_file_upload_24px")}),onPress:async function(){ie.showInputAlert({title:"Enter encryption key",placeholder:"secret password",confirmText:"Enter",onConfirm:async function(w){if(!w)throw new Error("An encryption key must be set");if(t.length)return;c("local_export");let d;try{d=Ht(JSON.stringify(F.save),w)}catch{return u("local_export"),L.showToast("Failed to encrypt!",P.getAssetIDByName("Small"))}L.showToast("Downloading file in your browser",P.getAssetIDByName("Check")),o.url.openURL(`${H.api}api/download?data=${encodeURIComponent(d)}`),u("local_export")}})}}),o.React.createElement($,{label:"Import Local Data",subLabel:"Imports data from a .txt file",leading:t.includes("import_local")?o.React.createElement(o.ReactNative.ActivityIndicator,{size:"small"}):o.React.createElement($.Icon,{source:P.getAssetIDByName("ic_download_24px")}),onPress:async function(){if(t.length)return;c("import_local");let w;try{const{uri:d,type:S}=await Pe.pickSingle({type:Pe.types.plainText,mode:"open"});S==="text/plain"&&(w=await(await fetch(d)).text())}catch(d){Pe.isCancel(d)||L.showToast(`Got an error! ${d}`,P.getAssetIDByName("Small"))}u("import_local"),w&&ie.showInputAlert({title:"Enter decryption key",placeholder:"secret password",confirmText:"Enter",onConfirm:async function(d){if(!d)throw new Error("A decryption key must be set");if(!t.length){c("import_local");try{const S=JSON.parse(Ut(w,d));Re(Ie,{save:S,navigation:E}),je(function(e){return e?c("import_local"):u("import_local")})}catch{return u("import_local"),L.showToast("Failed to decrypt!",P.getAssetIDByName("Small"))}}}})}})):_?o.React.createElement(o.ReactNative.ActivityIndicator,{size:"small",style:{flex:1}}):o.React.createElement(fe,{variant:"text-md/semibold",color:"TEXT_NORMAL",align:"center"},"Authenticate first to manage your data")),o.React.createElement(et,{style:{height:12}}))}let rt=0;function Kt(r){clearTimeout(rt),rt=setTimeout(r,1500)}const{FormRow:Ae}=b.Forms;function Yt(){const r=o.NavigationNative.useNavigation();return React.createElement(b.ErrorBoundary,null,React.createElement(Ae,{label:"Cloud Sync",leading:React.createElement(Ae.Icon,{source:P.getAssetIDByName("ic_contact_sync")}),trailing:Ae.Arrow,onPress:function(){return r.push("VendettaCustomPage",{title:"CloudSync",render:Te})}}))}const{FormSection:Jt}=b.Forms,Zt=T.findByName("getScreens"),Qt=T.findByName("UserSettingsOverviewWrapper",!1),jt=o.stylesheet.createThemedStyleSheet({container:{flex:1,backgroundColor:k.semanticColors.BACKGROUND_MOBILE_PRIMARY}});function qt(r,a,t){const s=[],c=ee.after("default",Qt,function(u,g){c();const E=ve.findInReactTree(g.props.children,function(_){return _.type&&_.type.name==="UserSettingsOverview"});s.push(ee.after("render",E.type.prototype,function(_,l){let{props:{children:w}}=l;const d=[o.i18n.Messages.BILLING_SETTINGS,o.i18n.Messages.PREMIUM_SETTINGS];w=ve.findInReactTree(w,function(e){return e.children[1].type===Jt}).children;const S=w.findIndex(function(e){return d.includes(e?.props.label)});r()&&w.splice(S===-1?4:S,0,a({}))}))},!0);if(s.push(c),Zt&&t){const u=`VENDETTA_PLUGIN_${o.lodash.snakeCase(t.key).toUpperCase()}`,g=t.page.render,E=o.React.memo(function(d){let{navigation:S}=d;const e=S.addListener("focus",function(){e(),S.setOptions(ve.without(t.page,"noErrorBoundary","render"))});return o.React.createElement(o.ReactNative.View,{style:jt.container},t.page.noErrorBoundary?o.React.createElement(g,null):o.React.createElement(b.ErrorBoundary,null,o.React.createElement(g,null)))}),_={[u]:{type:"route",title:typeof t.title=="function"?t.title:function(){return t.title},icon:t.icon,screen:{route:`VendettaPlugin${o.lodash.chain(t.key).camelCase().upperFirst().value()}`,getComponent:function(){return E}}}},l=function(d,S){const e=[...d],f=S?e?.[0]?.sections:e;if(!Array.isArray(f))return e;const n="Vendetta",i=f.find(function(p){return p?.title===n});return i&&i.settings.push(u),e},w=function(){const d=T.findByProps("useOverviewSettings"),S=T.findByProps("getSettingTitleConfig"),e=T.findByProps("SETTING_RELATIONSHIPS","SETTING_RENDERER_CONFIGS"),f="getSettingSearchListItems",n="getSettingListItems",i=T.findByProps(f),p=i?f:n,m=i??T.findByProps(n);if(!m||!d)return!1;s.push(ee.after("useOverviewSettings",d,function(G,z){return l(z,!1)})),s.push(ee.after("getSettingTitleConfig",S,function(G,z){return{...z,[u]:typeof t.title=="function"?t.title():t.title}})),s.push(ee.after(p,m,function(G,z){let[A]=G;return[...A.includes(u)?[{type:"setting_search_result",ancestorRendererData:_[u],setting:u,title:typeof t.title=="function"?t.title():t.title,breadcrumbs:["Vendetta"],icon:_[u].icon}]:[],...z]}));const B=e.SETTING_RELATIONSHIPS,D=e.SETTING_RENDERER_CONFIGS;return e.SETTING_RELATIONSHIPS={...B,[u]:null},e.SETTING_RENDERER_CONFIGS={...D,..._},s.push(function(){e.SETTING_RELATIONSHIPS=B,e.SETTING_RENDERER_CONFIGS=B}),!0};(function(){const d=T.findByProps("SearchableSettingsList"),S=T.findByProps("SETTING_RENDERER_CONFIG"),e=T.findByProps("getSettingListItems");if(!e||!d||!S)return!1;s.push(ee.before("type",d.SearchableSettingsList,function(n){return l(n,!0)})),s.push(ee.after("getSettingListSearchResultItems",e,function(n,i){for(const p of i)p.setting===u&&(p.breadcrumbs=["Vendetta"])}));const f=S.SETTING_RENDERER_CONFIG;return S.SETTING_RENDERER_CONFIG={...f,..._},s.push(function(){S.SETTING_RENDERER_CONFIG=f}),!0})()||w()}return function(){return s.forEach(function(u){return u()})}}function en(){let r=[];return r.push(qt(function(){return I.addToSettings},function(){return React.createElement(Yt,null)},{key:Le.plugin.manifest.name,icon:P.getAssetIDByName("ic_contact_sync"),title:"Cloud Sync",page:{title:"CloudSync",render:Te}})),function(){return r.forEach(function(a){return a()})}}const I=Se.storage;let it;const F=X.wrapSync(X.createStorage({get:function(){return it},set:function(r){it=r}}));async function xe(){try{F.save=await Pt()}catch{}}function ce(r){return r.startsWith(at.PROXY_PREFIX)}function le(r){return!r.includes("cloud-sync")}const j=async function(){if(!I.autoSync)return;const r=await Qe();JSON.stringify(F.save)!==JSON.stringify(r)&&Kt(async function(){return F.save=await Ye(r)})},ye=Symbol.for("vendetta.storage.emitter"),Ne=!!W.plugins[ye]&&!!q.themes[ye];let De=[];var tn={onLoad:function(){if(ne()&&xe(),Ne){const r={plugins:W.plugins[ye],themes:q.themes[ye]};r.plugins.on("SET",j),r.themes.on("SET",j),r.plugins.on("DEL",j),r.themes.on("DEL",j),De.push(function(){r.plugins.off("SET",j),r.themes.off("SET",j),r.plugins.off("DEL",j),r.themes.off("DEL",j)})}De.push(en()),Se.storage.databaseMigrate&&delete Se.storage.databaseMigrate},onUnload:function(){return De.forEach(function(r){return r()})},settings:Te};return V.cache=F,V.canImport=le,V.default=tn,V.emitterAvailable=Ne,V.fillCache=xe,V.isPluginProxied=ce,V.vstorage=I,Object.defineProperty(V,"__esModule",{value:!0}),V})({},vendetta.plugin,vendetta.storage,vendetta.metro,vendetta.plugins,vendetta.themes,vendetta.ui.toasts,vendetta.ui.assets,vendetta.ui.alerts,vendetta.metro.common,vendetta.ui,vendetta.ui.components,vendetta.patcher,vendetta.utils,vendetta,vendetta.constants);
