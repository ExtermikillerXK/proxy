(function(w,X,N,c,I,C,E,s,J,n,h,A,v,K,oe,De,_e){"use strict";const $e=c.findByStoreName("ThemeStore"),Oe=c.findByProps("colors","meta");c.findByProps("triggerHaptic");const{TextStyleSheet:xe}=c.findByProps("TextStyleSheet"),{View:B,Text:se,Pressable:Le}=h.General,Me=c.findByProps("ActionSheet")?.ActionSheet??c.find(function(e){return e.render?.name==="ActionSheet"}),{openLazy:Ge,hideActionSheet:ce}=c.findByProps("openLazy","hideActionSheet"),{ActionSheetTitleHeader:ke,ActionSheetCloseButton:Ue,ActionSheetContentContainer:Ve}=c.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton","ActionSheetContentContainer");c.findByName("Navigator"),c.findByProps("getRenderCloseButton"),c.findByProps("popModal","pushModal");function je(e){return Oe.meta.resolveSemanticColor($e.theme,e)}function le(e,r){try{Ge(new Promise(function(t){return t({default:e})}),"ActionSheet",r)}catch(t){oe.logger.error(t.stack),E.showToast("Got error when opening ActionSheet! Please check debug logs",s.getAssetIDByName("Smal"))}}function Fe(e){let{title:r,onPress:t,icon:i}=e;const o=n.stylesheet.createThemedStyleSheet({androidRipple:{color:v.semanticColors.ANDROID_RIPPLE},icon:{height:18,tintColor:v.semanticColors.HEADER_SECONDARY,opacity:.5}}),a=t?Le:B;return n.React.createElement(a,{android_ripple:o.androidRipple,disabled:!1,accessibilityRole:"button",onPress:t,style:{marginBottom:8,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},i&&n.React.createElement(B,{style:{marginRight:4}},n.React.createElement(n.ReactNative.Image,{style:o.icon,source:i,resizeMode:"contain"})),n.React.createElement(F,{variant:"text-sm/semibold",color:"HEADER_SECONDARY"},r))}function j(e){let{title:r,onTitlePress:t,icon:i,children:o,padding:a}=e;const u=n.stylesheet.createThemedStyleSheet({main:{backgroundColor:v.semanticColors.BACKGROUND_TERTIARY,borderRadius:16,overflow:"hidden",flex:1}});return n.React.createElement(B,{style:{marginHorizontal:16,marginTop:16}},n.React.createElement(Fe,{title:r,onPress:t,icon:i}),n.React.createElement(B,{style:u.main},a?n.React.createElement(B,{style:{paddingHorizontal:16,paddingVertical:16}},o):o))}function ze(e){let{addPadding:r}=e;const t=n.stylesheet.createThemedStyleSheet({line:{width:"100%",height:2,backgroundColor:v.semanticColors.BACKGROUND_ACCENT,borderRadius:2147483647}});return n.React.createElement(B,{style:[{marginTop:16,marginBottom:16},r&&{marginHorizontal:16}]},n.React.createElement(B,{style:t.line}))}var ue;(function(e){function r(i){let{children:o,onPress:a}=i;return n.React.createElement(F,{variant:"text-md/bold",onPress:a},o)}e.Bold=r;function t(i){let{children:o,onPress:a}=i;return n.React.createElement(se,{style:{textDecorationLine:"underline"},onPress:a},o)}e.Underline=t})(ue||(ue={}));function F(e){let{variant:r,lineClamp:t,color:i,align:o,style:a,onPress:u,getChildren:S,children:d,liveUpdate:T}=e;const[_,R]=n.React.useReducer(function(y){return~y},0);return n.React.useEffect(function(){if(!T)return;const y=new Date().setMilliseconds(1e3);let f,b;return b=setTimeout(function(){R(),f=setInterval(R,1e3)},y-Date.now()),function(){clearTimeout(b),clearInterval(f)}},[]),n.React.createElement(se,{style:[r?xe[r]:{},i?{color:je(v.semanticColors[i])}:{},o?{textAlign:o}:{},a??{}],numberOfLines:t,onPress:u},S?.()??d)}function de(e){let{onPress:r,onLongPress:t,icon:i,style:o,destructive:a}=e;const u=n.stylesheet.createThemedStyleSheet({headerStyleIcon:{width:24,height:24,marginRight:10,tintColor:v.semanticColors.HEADER_PRIMARY},cardStyleIcon:{width:22,height:22,marginLeft:5,tintColor:v.semanticColors.INTERACTIVE_NORMAL},destructiveIcon:{tintColor:v.semanticColors.TEXT_DANGER}});return n.React.createElement(n.ReactNative.TouchableOpacity,{onPress:r,onLongPress:t},n.React.createElement(n.ReactNative.Image,{style:[typeof o=="string"?o==="header"?u.headerStyleIcon:u.cardStyleIcon:o,a&&u.destructiveIcon].filter(function(S){return!!S}),source:i}))}const{View:He,Text:fe}=h.General,{TextStyleSheet:ge}=c.findByProps("TextStyleSheet"),ye=n.stylesheet.createThemedStyleSheet({count:{...ge["text-lg/bold"],color:v.semanticColors.TEXT_NORMAL,textAlign:"center"},subtitle:{...ge["text-md/medium"],color:v.semanticColors.TEXT_MUTED,textAlign:"center"}});function he(e){let{subtitle:r,count:t,contents:i}=e;return React.createElement(He,{style:{alignItems:"center",justifyContent:"center",marginHorizontal:16}},React.createElement(fe,{style:ye.count},t),React.createElement(fe,{style:ye.subtitle},r))}const pe="https://cloudsync.nexpid.xyz/";var D={api:pe,oauth2:{clientId:"1120793656878714913",redirectURL:`${pe}api/oauth2-response`}};function Ye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function z(e,r,t){return Se()?z=Reflect.construct:z=function(i,o,a){var u=[null];u.push.apply(u,o);var S=Function.bind.apply(i,u),d=new S;return a&&M(d,a.prototype),d},z.apply(null,arguments)}function L(e){return L=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},L(e)}function Je(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&M(e,r)}function Ke(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function We(e,r){return r&&(qe(r)==="object"||typeof r=="function")?r:Ye(e)}function M(e,r){return M=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t},M(e,r)}function qe(e){"@swc/helpers - typeof";return e&&typeof Symbol<"u"&&e.constructor===Symbol?"symbol":typeof e}function W(e){var r=typeof Map=="function"?new Map:void 0;return W=function(t){if(t===null||!Ke(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(typeof r<"u"){if(r.has(t))return r.get(t);r.set(t,i)}function i(){return z(t,arguments,L(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),M(i,t)},W(e)}function Se(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qe(e){var r=Se();return function(){var t=L(e),i;if(r){var o=L(this).constructor;i=Reflect.construct(t,arguments,o)}else i=t.apply(this,arguments);return We(this,i)}}const Re=c.findByStoreName("UserStore");let G=function(e){Je(t,e);var r=Qe(t);function t(i){Xe(this,t);var o;return o=r.call(this,`${i.status}: ${i.message}${i.error?` (${i.error})`:""}`),o.name=o.constructor.name,o}return t}(W(Error));function m(){return l.auth?.[Re.getCurrentUser().id]}async function q(){const e=new Error("Unauthorized, try logging out and back in again");let r=m();if(!r)throw e;if(Date.now()>=r.expiresAt){const t=await fetch(`${D.api}api/refresh-access-token?refresh_token=${encodeURIComponent(r.refreshToken)}`);if(t.status!==200)throw new G(await t.json());r=await t.json(),l.auth??={},l.auth[Re.getCurrentUser().id]=r}return r.accessToken}async function Ze(e){const r=await fetch(`${D.api}api/get-access-token?code=${encodeURIComponent(e)}`);if(r.status===200)return await r.json();throw new G(await r.json())}async function et(){if(!m())return;const e=await fetch(`${D.api}api/get-data`,{headers:{authorization:await q()}});if(e.status===200)return await e.json();throw new G(await e.json())}async function Ee(e){if(!m())return;const r=await fetch(`${D.api}api/sync-data`,{method:"POST",headers:{authorization:await q(),"content-type":"application/json"},body:JSON.stringify(e)});if(r.status===200)return await r.json();throw new G(await r.json())}async function tt(){if(!m())return;const e=await fetch(`${D.api}api/delete-data`,{method:"DELETE",headers:{authorization:await q()}});if(e.status===200)return await e.json();throw new G(await e.json())}const{pushModal:nt,popModal:rt}=c.findByProps("pushModal","popModal"),it=c.findByName("OAuth2AuthorizeModal"),at=c.findByStoreName("UserStore");function ot(){nt({key:"oauth2-authorize",modal:{key:"oauth2-authorize",modal:it,animation:"slide-up",shouldPersistUnderModals:!1,props:{clientId:D.oauth2.clientId,redirectUri:D.oauth2.redirectURL,scopes:["identify"],responseType:"code",permissions:0n,cancelCompletesFlow:!1,callback:async function(e){let{location:r}=e;try{const t=new URL(r).searchParams.get("code"),i=await Ze(t);l.auth??={},l.auth[at.getCurrentUser().id]=i,te(),E.showToast("Successfully authenticated",s.getAssetIDByName("Check"))}catch(t){E.showToast(String(t),s.getAssetIDByName("Small"))}},dismissOAuthModal:function(){return rt("oauth2-authorize")}},closable:!0}})}const{BundleUpdaterManager:Dt,MMKVManager:st}=window.nativeModuleProxy;async function ve(){const e={themes:[],plugins:[]};for(const r of Object.values(I.plugins)){const t=l.pluginSettings?.[r.id];if(t?.syncPlugin===!1)continue;const i=t?.syncStorage===!1?{}:await N.createMMKVBackend(r.id).get();e.plugins.push({id:r.id,enabled:r.enabled,options:i})}for(const r of Object.values(C.themes))e.themes.push({id:r.id,enabled:r.selected});return e}let H;function ct(e){H=e}async function lt(e){if(!g.save)return;H?.(!0);const r=[...g.save.sync.plugins.filter(function(a){return!I.plugins[a.id]&&!k(a.id)&&U(a.id)&&e.unproxiedPlugins}),...g.save.sync.plugins.filter(function(a){return!I.plugins[a.id]&&k(a.id)&&U(a.id)&&e.plugins})],t=g.save.sync.themes.filter(function(a){return!C.themes[a.id]&&e.themes});if(!r[0]&&!t[0])return H?.(!1),E.showToast("Nothing to import",s.getAssetIDByName("Small"));E.showToast(`Importing ${[r.length&&`${r.length} plugin${r.length!==1?"s":""}`,t.length&&`${t.length} theme${t.length!==1?"s":""}`].filter(function(a){return!!a}).join(" and ")}`,s.getAssetIDByName("toast_image_saved"));const i={plugins:0,themes:0};await Promise.all([...r.map(function(a){return new Promise(async function(u){st.setItem(a.id,JSON.stringify(a.options)),I.installPlugin(a.id,a.enabled).then(function(){return i.plugins++}).finally(u)})}),...t.map(function(a){return new Promise(async function(u){return C.installTheme(a.id).then(function(){return i.themes++}).finally(u)})})]),E.showToast(`Imported ${[[i.plugins,"plugin"],[i.themes,"theme"]].map(function(a){let[u,S]=a;return`${u} ${S}${u!==1?"s":""}`}).join(" and ")}!`,s.getAssetIDByName("check"));const o=C.themes[t.find(function(a){return a.enabled})?.id];o&&(await N.createFileBackend("vendetta_theme.json").set(Object.assign(o,{selected:!0})),await function(){return new Promise(function(a){return J.showConfirmationAlert({title:"Theme selected",content:"A reload is required to see the theme. Do you want to reload now?",confirmText:"Reload",confirmColor:"red",onConfirm:function(){window.nativeModuleProxy.BundleUpdaterManager.reload(),a()},cancelText:"Skip",onCancel:a,isDismissable:!0})})}()),H?.(!1)}const{FormCheckboxRow:Q}=h.Forms;function be(e){let{defOptions:r}=e;const t={unproxiedPlugins:g.save.sync.plugins.filter(function(a){return!I.plugins[a.id]&&!k(a.id)&&U(a.id)}).length,plugins:g.save.sync.plugins.filter(function(a){return!I.plugins[a.id]&&k(a.id)&&U(a.id)}).length,themes:g.save.sync.themes.filter(function(a){return!C.themes[a.id]}).length},[i,o]=n.React.useState(r??{unproxiedPlugins:!1,plugins:!!t.plugins,themes:!!t.themes});return n.React.createElement(Me,null,n.React.createElement(Ve,null,n.React.createElement(ke,{title:"Import Data",trailing:n.React.createElement(Ue,{onPress:function(){return ce()}})}),n.React.createElement(Q,{label:`Unproxied Plugins (${t.unproxiedPlugins})`,disabled:!t.unproxiedPlugins,onPress:function(){return t.unproxiedPlugins&&(!i.unproxiedPlugins&&!r?J.showConfirmationAlert({title:"Warning",content:"Installing unproxied plugins can be dangerous since they haven't been verified by Vendetta staff. Are you sure you want to import them?",isDismissable:!0,confirmText:"Yes",confirmColor:"brand",onConfirm:function(){return le(be,{defOptions:{...i,unproxiedPlugins:!0}})},cancelText:"Cancel"}):o({...i,unproxiedPlugins:!i.unproxiedPlugins}))},selected:i.unproxiedPlugins}),n.React.createElement(Q,{label:`Plugins (${t.plugins})`,disabled:!t.plugins,onPress:function(){return t.plugins&&o({...i,plugins:!i.plugins})},selected:i.plugins}),n.React.createElement(Q,{label:`Themes (${t.themes})`,disabled:!t.themes,onPress:function(){return t.themes&&o({...i,themes:!i.themes})},selected:i.themes}),n.React.createElement(h.Button,{text:"Import",color:"green",size:"medium",renderIcon:function(){return n.React.createElement(n.ReactNative.Image,{style:{marginRight:8},source:s.getAssetIDByName("ic_download_24px")})},onPress:function(){lt(i),ce()},style:{marginHorizontal:16,marginVertical:16},disabled:!i.unproxiedPlugins&&!i.plugins&&!i.themes})))}const we=c.findByProps("isTablet"),{View:ut}=h.General,{FormRow:dt}=h.Forms;function ft(){const[e,r]=n.React.useState({});return m()?n.React.createElement(ut,{style:{flexDirection:we.isTablet?"row":"column",justifyContent:"flex-end"}},[{text:"Save Data",onPress:async function(t){t(!0);try{g.save=await Ee(await ve()),E.showToast("Successfully synced data",s.getAssetIDByName("Check"))}catch(i){E.showToast(String(i),s.getAssetIDByName("Small"))}t(!1)}},{text:"Import Data",onPress:function(t){g.save&&(le(be,{}),ct(t))}}].map(function(t,i){const o=i!==0?8:0;return n.React.createElement(h.Button,{text:t.text,color:"green",size:"small",onPress:function(){return!e[i]&&t.onPress(function(a){r({...e,[i]:!!a})})},trailing:n.React.createElement(dt.Icon,{source:s.getAssetIDByName("Check")}),loading:e[i],style:[we.isTablet?{marginLeft:o}:{marginTop:o}]})})):n.React.createElement(F,{variant:"text-md/semibold",color:"TEXT_NORMAL",align:"center"},"Authenticate first to manage your data")}const{FormSwitchRow:Ie}=h.Forms;function gt(){const[e,r]=n.React.useState(""),[,t]=n.React.useReducer(function(a){return~a},0);n.React.useEffect(function(){r("")},[]),N.useProxy(l);const i=n.NavigationNative.useNavigation(),o=i.addListener("focus",function(){o(),i.setOptions({title:"Plugin Settings",headerRight:function(){return n.React.createElement(de,{onPress:function(){return J.showConfirmationAlert({title:"Revert Settings",content:"Are you sure you want to revert all plugin settings?",confirmText:"Revert",cancelText:"Cancel",confirmColor:"red",onConfirm:function(){return l.pluginSettings={}}})},icon:s.getAssetIDByName("ic_message_delete"),style:"header"})}})});return n.React.createElement(n.ReactNative.FlatList,{ListHeaderComponent:n.React.createElement(h.Search,{style:{marginBottom:10},onChangeText:function(a){return r(a.toLowerCase())}}),style:{paddingHorizontal:10,paddingTop:10},contentContainerStyle:{paddingBottom:20},data:Object.entries(I.plugins).filter(function(a){return a[1].manifest.name?.toLowerCase().includes(e)}),renderItem:function(a){let{item:[u,S]}=a;l.pluginSettings??={};const d=l.pluginSettings[u]??{syncPlugin:!0,syncStorage:!0},T=function(){l.pluginSettings??={},d.syncPlugin===!0&&d.syncStorage===!0?delete l.pluginSettings[u]:l.pluginSettings[u]=d,t()};return n.React.createElement(h.Summary,{label:S.manifest.name,icon:S.manifest.vendetta.icon??":3"},n.React.createElement(Ie,{label:"Sync Plugin",onValueChange:function(){d.syncPlugin=!d.syncPlugin,T()},value:d.syncPlugin}),n.React.createElement(Ie,{label:"Sync Plugin Storage",onValueChange:function(){d.syncStorage=!d.syncStorage,T()},value:d.syncStorage}))}})}var Te={github:{url:"https://github.com/nexpid/VendettaPlugins/"}};const{showSimpleActionSheet:yt}=c.findByProps("showSimpleActionSheet"),ht=c.findByStoreName("UserStore");function pt(){const e=_e.getDebugInfo(),r=n.ReactNative.NativeModules.InfoDictionaryManager??n.ReactNative.NativeModules.RTNClientInfoManager;return`Device: ${e.os.name==="iOS"?e.device.codename:`${e.device.brand} ${e.device.model}`}
Model: ${e.device.model}
Manufacturer: ${e.device.manufacturer}
Brand: ${e.device.brand}

OS: ${e.os.name}
Version: ${e.os.version}

Discord Branch: ${r.ReleaseChannel}
Discord Version: ${e.discord.version}
Discord Build: ${e.discord.build}
Vendetta Version: ${e.vendetta.version}

React Version: ${e.react.version}
Hermes Bytecode: ${e.hermes.bytecodeVersion}`}function me(e){const r=ht.getCurrentUser(),t=new URLSearchParams;for(const[i,o]of Object.entries(e))t.set(i,o);return t.set("discord-username",`@${r.username}${r.discriminator!=="0"?`#${r.discriminator}`:""}`),console.log(`${Te.github.url}issues/new?${t.toString()}`),`${Te.github.url}issues/new?${t.toString()}`}const St=function(e){return yt({key:"CardOverflow",header:{title:"GitHub Reports"},options:[{label:"Copy bug report link",icon:s.getAssetIDByName("copy"),onPress:function(){n.clipboard.setString(me({title:`bug(${e}): `,template:"bug_report.yml",labels:"bug",sysinfo:pt()})),E.showToast("Copied",s.getAssetIDByName("toast_copy_link"))}},{label:"Copy feature suggestion link",icon:s.getAssetIDByName("copy"),onPress:function(){n.clipboard.setString(me({title:`suggest(${e}): `,labels:"suggestion",template:"suggestion.yml"})),E.showToast("Copied",s.getAssetIDByName("toast_copy_link"))}}]})},{ScrollView:Rt,View:Et}=h.General,{FormRow:p,FormSwitchRow:Pe}=h.Forms,Ne=c.findByStoreName("UserStore");function Z(){N.useProxy(g),N.useProxy(l);const e=n.NavigationNative.useNavigation(),r=e.addListener("focus",function(){r(),e.setOptions({headerRight:function(){return n.React.createElement(de,{icon:s.getAssetIDByName("ic_report_message"),style:"header",onPress:function(){return St("cloud-sync")}})}})});return n.React.createElement(Rt,null,n.React.createElement(j,{title:"Current Data",icon:s.getAssetIDByName("ic_contact_sync"),padding:!0},n.React.createElement(Et,{style:{flexDirection:"row",alignItems:"center",justifyContent:"center",marginVertical:8}},n.React.createElement(he,{count:g.save?.sync?.plugins?.length??"-",subtitle:"plugins",contents:2}),n.React.createElement(he,{count:g.save?.sync?.themes?.length??"-",subtitle:"themes",contents:2}))),n.React.createElement(j,{title:"Settings",icon:s.getAssetIDByName("ic_cog_24px")},n.React.createElement(Pe,{label:"Auto Save",subLabel:"Automatically save data to cloud",leading:n.React.createElement(p.Icon,{source:s.getAssetIDByName("ic_contact_sync")}),onValueChange:function(){return l.autoSync=!l.autoSync},value:l.autoSync??!1}),!ne&&l.autoSync&&n.React.createElement(F,{variant:"text-md/semibold",color:"TEXT_DANGER",style:{marginHorizontal:20,marginVertical:2}},"You must reinstall Vendetta in order to use Auto Save!"),n.React.createElement(Pe,{label:"Pin To Settings",subLabel:"Pin Cloud Sync to the settings page",leading:n.React.createElement(p.Icon,{source:s.getAssetIDByName("ic_message_pin")}),onValueChange:function(){return l.addToSettings=!l.addToSettings},value:l.addToSettings??!1}),n.React.createElement(p,{label:"Plugin Settings",leading:n.React.createElement(p.Icon,{source:s.getAssetIDByName("debug")}),trailing:n.React.createElement(p.Arrow,null),onPress:function(){return e.push("VendettaCustomPage",{render:gt})}})),n.React.createElement(j,{title:"Authentication",icon:s.getAssetIDByName("lock")},m()?n.React.createElement(n.React.Fragment,null,n.React.createElement(p,{label:"Log out",subLabel:"Logs you out of CloudSync",leading:n.React.createElement(p.Icon,{source:s.getAssetIDByName("ic_logout_24px")}),onPress:function(){l.auth??={},delete l.auth[Ne.getCurrentUser().id],delete g.save,E.showToast("Successfully logged out",s.getAssetIDByName("ic_logout_24px"))}}),n.React.createElement(p,{label:"Delete data",subLabel:"Deletes your CloudSync data",leading:n.React.createElement(p.Icon,{source:s.getAssetIDByName("trash")}),onPress:async function(){await tt(),l.auth??={},delete l.auth[Ne.getCurrentUser().id],delete g.save,E.showToast("Successfully deleted data",s.getAssetIDByName("trash"))}})):n.React.createElement(p,{label:"Authenticate",leading:n.React.createElement(p.Icon,{source:s.getAssetIDByName("copy")}),trailing:p.Arrow,onPress:ot})),n.React.createElement(j,{title:"Data Management",icon:s.getAssetIDByName("ic_message_edit"),padding:!0},n.React.createElement(ft,null),m()&&n.React.createElement(n.React.Fragment,null,n.React.createElement(ze,null),n.React.createElement(p,{label:"Copy Data as JSON",leading:n.React.createElement(p.Icon,{source:s.getAssetIDByName("copy")}),onPress:function(){n.clipboard.setString(JSON.stringify(g.save??{},void 0,3)),E.showToast("Copied",s.getAssetIDByName("Check"))}}))))}let Ce=0;function vt(e){clearTimeout(Ce),Ce=setTimeout(e,1500)}const{FormRow:ee}=h.Forms;function bt(){const e=n.NavigationNative.useNavigation();return React.createElement(h.ErrorBoundary,null,React.createElement(ee,{label:"Cloud Sync",leading:React.createElement(ee.Icon,{source:s.getAssetIDByName("ic_contact_sync")}),trailing:ee.Arrow,onPress:function(){return e.push("VendettaCustomPage",{title:"CloudSync",render:Z})}}))}const{FormSection:wt}=h.Forms,It=c.findByName("getScreens"),Tt=c.findByName("UserSettingsOverviewWrapper",!1),mt=n.stylesheet.createThemedStyleSheet({container:{flex:1,backgroundColor:v.semanticColors.BACKGROUND_MOBILE_PRIMARY}});function Pt(e,r,t){const i=[],o=A.after("default",Tt,function(a,u){o();const S=K.findInReactTree(u.props.children,function(d){return d.type&&d.type.name==="UserSettingsOverview"});i.push(A.after("render",S.type.prototype,function(d,T){let{props:{children:_}}=T;const R=[n.i18n.Messages.BILLING_SETTINGS,n.i18n.Messages.PREMIUM_SETTINGS];_=K.findInReactTree(_,function(f){return f.children[1].type===wt}).children;const y=_.findIndex(function(f){return R.includes(f?.props.label)});e()&&_.splice(y===-1?4:y,0,r({}))}))},!0);if(i.push(o),It&&t){const a=`VENDETTA_PLUGIN_${n.lodash.snakeCase(t.key).toUpperCase()}`,u=t.page.render,S=n.React.memo(function(R){let{navigation:y}=R;const f=y.addListener("focus",function(){f(),y.setOptions(K.without(t.page,"noErrorBoundary","render"))});return n.React.createElement(n.ReactNative.View,{style:mt.container},t.page.noErrorBoundary?n.React.createElement(u,null):n.React.createElement(h.ErrorBoundary,null,n.React.createElement(u,null)))}),d={[a]:{type:"route",title:typeof t.title=="function"?t.title:function(){return t.title},icon:t.icon,screen:{route:`VendettaPlugin${n.lodash.chain(t.key).camelCase().upperFirst().value()}`,getComponent:function(){return S}}}},T=function(R,y){const f=[...R],b=y?f?.[0]?.sections:f;if(!Array.isArray(b))return f;const $="Vendetta",O=b.find(function(x){return x?.title===$});return O&&O.settings.push(a),f},_=function(){const R=c.findByProps("useOverviewSettings"),y=c.findByProps("getSettingTitleConfig"),f=c.findByProps("SETTING_RELATIONSHIPS","SETTING_RENDERER_CONFIGS"),b="getSettingSearchListItems",$="getSettingListItems",O=c.findByProps(b),x=O?b:$,Be=O??c.findByProps($);if(!Be||!R)return!1;i.push(A.after("useOverviewSettings",R,function(ae,V){return T(V,!1)})),i.push(A.after("getSettingTitleConfig",y,function(ae,V){return{...V,[a]:typeof t.title=="function"?t.title():t.title}})),i.push(A.after(x,Be,function(ae,V){let[Bt]=ae;return[...Bt.includes(a)?[{type:"setting_search_result",ancestorRendererData:d[a],setting:a,title:typeof t.title=="function"?t.title():t.title,breadcrumbs:["Vendetta"],icon:d[a].icon}]:[],...V]}));const ie=f.SETTING_RELATIONSHIPS,At=f.SETTING_RENDERER_CONFIGS;return f.SETTING_RELATIONSHIPS={...ie,[a]:null},f.SETTING_RENDERER_CONFIGS={...At,...d},i.push(function(){f.SETTING_RELATIONSHIPS=ie,f.SETTING_RENDERER_CONFIGS=ie}),!0};(function(){const R=c.findByProps("SearchableSettingsList"),y=c.findByProps("SETTING_RENDERER_CONFIG"),f=c.findByProps("getSettingListItems");if(!f||!R||!y)return!1;i.push(A.before("type",R.SearchableSettingsList,function($){return T($,!0)})),i.push(A.after("getSettingListSearchResultItems",f,function($,O){for(const x of O)x.setting===a&&(x.breadcrumbs=["Vendetta"])}));const b=y.SETTING_RENDERER_CONFIG;return y.SETTING_RENDERER_CONFIG={...b,...d},i.push(function(){y.SETTING_RENDERER_CONFIG=b}),!0})()||_()}return function(){return i.forEach(function(a){return a()})}}function Nt(){let e=[];return e.push(Pt(function(){return l.addToSettings},function(){return React.createElement(bt,null)},{key:oe.plugin.manifest.name,icon:s.getAssetIDByName("ic_contact_sync"),title:"Cloud Sync",page:{title:"CloudSync",render:Z}})),function(){return e.forEach(function(r){return r()})}}const l=X.storage;let Ae;const g=N.wrapSync(N.createStorage({get:function(){return Ae},set:function(e){Ae=e}}));async function te(){try{g.save=await et()}catch{}}function k(e){return e.startsWith(De.PROXY_PREFIX)}function U(e){return!e.includes("cloud-sync")}const P=async function(){if(!l.autoSync)return;const e=await ve();JSON.stringify(g.save)!==JSON.stringify(e)&&vt(async function(){return g.save=await Ee(e)})},Y=Symbol.for("vendetta.storage.emitter"),ne=!!I.plugins[Y]&&!!C.themes[Y];let re=[];var Ct={onLoad:function(){if(m()&&te(),ne){const e={plugins:I.plugins[Y],themes:C.themes[Y]};e.plugins.on("SET",P),e.themes.on("SET",P),e.plugins.on("DEL",P),e.themes.on("DEL",P),re.push(function(){e.plugins.off("SET",P),e.themes.off("SET",P),e.plugins.off("DEL",P),e.themes.off("DEL",P)})}re.push(Nt()),X.storage.databaseMigrate&&delete X.storage.databaseMigrate},onUnload:function(){return re.forEach(function(e){return e()})},settings:Z};return w.cache=g,w.canImport=U,w.default=Ct,w.emitterAvailable=ne,w.fillCache=te,w.isPluginProxied=k,w.vstorage=l,Object.defineProperty(w,"__esModule",{value:!0}),w})({},vendetta.plugin,vendetta.storage,vendetta.metro,vendetta.plugins,vendetta.themes,vendetta.ui.toasts,vendetta.ui.assets,vendetta.ui.alerts,vendetta.metro.common,vendetta.ui.components,vendetta.patcher,vendetta.ui,vendetta.utils,vendetta,vendetta.constants,vendetta.debug);
