(function(m,z,N,u,w,A,p,s,H,t,g,U,R,Y,Ie,Pe,Ce){"use strict";const Ne=u.findByStoreName("ThemeStore"),Ae=u.findByProps("colors","meta"),{TextStyleSheet:Be}=u.findByProps("TextStyleSheet"),{View:B,Text:te,Pressable:De}=g.General,ne=u.find(function(e){return e.render?.name==="ActionSheet"}),{openLazy:$e,hideActionSheet:re}=u.findByProps("openLazy","hideActionSheet"),{ActionSheetTitleHeader:_e,ActionSheetCloseButton:xe,ActionSheetContentContainer:Oe}=u.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton","ActionSheetContentContainer");u.findByName("Navigator"),u.findByProps("getRenderCloseButton"),u.findByProps("popModal","pushModal");function Me(e){return Ae.meta.resolveSemanticColor(Ne.theme,e)}function ie(e,n){ne?$e(new Promise(function(r){return r({default:e})}),"ActionSheet",n):p.showToast("You cannot open ActionSheets on this version! Update to 163+",s.getAssetIDByName("Small"))}function Le(e){let{title:n,onPress:r,icon:i}=e;const o=t.stylesheet.createThemedStyleSheet({androidRipple:{color:R.semanticColors.ANDROID_RIPPLE},icon:{height:18,tintColor:R.semanticColors.HEADER_SECONDARY,opacity:.5}}),a=r?De:B;return t.React.createElement(a,{android_ripple:o.androidRipple,disabled:!1,accessibilityRole:"button",onPress:r,style:{marginBottom:8,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},i&&t.React.createElement(B,{style:{marginRight:4}},t.React.createElement(t.ReactNative.Image,{style:o.icon,source:i,resizeMode:"contain"})),t.React.createElement(k,{variant:"text-sm/semibold",color:"HEADER_SECONDARY"},n))}function j(e){let{title:n,onTitlePress:r,icon:i,children:o,padding:a}=e;const l=t.stylesheet.createThemedStyleSheet({main:{backgroundColor:R.semanticColors.BACKGROUND_TERTIARY,borderRadius:16,overflow:"hidden",flex:1}});return t.React.createElement(B,{style:{marginHorizontal:16,marginTop:16}},t.React.createElement(Le,{title:n,onPress:r,icon:i}),t.React.createElement(B,{style:l.main},a?t.React.createElement(B,{style:{paddingHorizontal:16,paddingVertical:16}},o):o))}function Ue(e){let{addPadding:n}=e;const r=t.stylesheet.createThemedStyleSheet({line:{width:"100%",height:2,backgroundColor:R.semanticColors.BACKGROUND_ACCENT,borderRadius:2147483647}});return t.React.createElement(B,{style:[{marginTop:16,marginBottom:16},n&&{marginHorizontal:16}]},t.React.createElement(B,{style:r.line}))}var ae;(function(e){function n(i){let{children:o,onPress:a}=i;return t.React.createElement(k,{variant:"text-md/bold",onPress:a},o)}e.Bold=n;function r(i){let{children:o,onPress:a}=i;return t.React.createElement(te,{style:{textDecorationLine:"underline"},onPress:a},o)}e.Underline=r})(ae||(ae={}));function k(e){let{variant:n,lineClamp:r,color:i,align:o,style:a,onPress:l,getChildren:y,children:d,liveUpdate:b}=e;const[T,E]=t.React.useReducer(function(S){return~S},0);return t.React.useEffect(function(){if(!b)return;const S=new Date().setMilliseconds(1e3);let v,C;return C=setTimeout(function(){E(),v=setInterval(E,1e3)},S-Date.now()),function(){clearTimeout(C),clearInterval(v)}},[]),t.React.createElement(te,{style:[n?Be[n]:{},i?{color:Me(R.semanticColors[i])}:{},o?{textAlign:o}:{},a??{}],numberOfLines:r,onPress:l},y?.()??d)}function oe(e){let{onPress:n,onLongPress:r,icon:i,style:o,destructive:a}=e;const l=t.stylesheet.createThemedStyleSheet({headerStyleIcon:{width:24,height:24,marginRight:10,tintColor:R.semanticColors.HEADER_PRIMARY},cardStyleIcon:{width:22,height:22,marginLeft:5,tintColor:R.semanticColors.INTERACTIVE_NORMAL},destructiveIcon:{tintColor:R.semanticColors.TEXT_DANGER}});return t.React.createElement(t.ReactNative.TouchableOpacity,{onPress:n,onLongPress:r},t.React.createElement(t.ReactNative.Image,{style:[typeof o=="string"?o==="header"?l.headerStyleIcon:l.cardStyleIcon:o,a&&l.destructiveIcon].filter(function(y){return!!y}),source:i}))}const{View:je,Text:se}=g.General,{TextStyleSheet:ce}=u.findByProps("TextStyleSheet"),le=t.stylesheet.createThemedStyleSheet({count:{...ce["text-lg/bold"],color:R.semanticColors.TEXT_NORMAL,textAlign:"center"},subtitle:{...ce["text-md/medium"],color:R.semanticColors.TEXT_MUTED,textAlign:"center"}});function ue(e){let{subtitle:n,count:r,contents:i}=e;return React.createElement(je,{style:{alignItems:"center",justifyContent:"center",marginHorizontal:16}},React.createElement(se,{style:le.count},r),React.createElement(se,{style:le.subtitle},n))}const de="https://cloudsync.nexpid.xyz/";var D={api:de,oauth2:{clientId:"1120793656878714913",redirectURL:`${de}api/oauth2-response`}};function ke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ve(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function V(e,n,r){return fe()?V=Reflect.construct:V=function(i,o,a){var l=[null];l.push.apply(l,o);var y=Function.bind.apply(i,l),d=new y;return a&&x(d,a.prototype),d},V.apply(null,arguments)}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},_(e)}function Fe(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&x(e,n)}function Ge(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function ze(e,n){return n&&(He(n)==="object"||typeof n=="function")?n:ke(e)}function x(e,n){return x=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},x(e,n)}function He(e){"@swc/helpers - typeof";return e&&typeof Symbol<"u"&&e.constructor===Symbol?"symbol":typeof e}function X(e){var n=typeof Map=="function"?new Map:void 0;return X=function(r){if(r===null||!Ge(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof n<"u"){if(n.has(r))return n.get(r);n.set(r,i)}function i(){return V(r,arguments,_(this).constructor)}return i.prototype=Object.create(r.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),x(i,r)},X(e)}function fe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ye(e){var n=fe();return function(){var r=_(e),i;if(n){var o=_(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return ze(this,i)}}const ge=u.findByStoreName("UserStore");let O=function(e){Fe(r,e);var n=Ye(r);function r(i){Ve(this,r);var o;return o=n.call(this,`${i.status}: ${i.message}${i.error?` (${i.error})`:""}`),o.name=o.constructor.name,o}return r}(X(Error));function I(){return c.auth?.[ge.getCurrentUser().id]}async function J(){const e=new Error("Unauthorized, try logging out and back in again");let n=I();if(!n)throw e;if(Date.now()>=n.expiresAt){const r=await fetch(`${D.api}api/refresh-access-token?refresh_token=${encodeURIComponent(n.refreshToken)}`);if(r.status!==200)throw new O(await r.json());n=await r.json(),c.auth??={},c.auth[ge.getCurrentUser().id]=n}return n.accessToken}async function Xe(e){const n=await fetch(`${D.api}api/get-access-token?code=${encodeURIComponent(e)}`);if(n.status===200)return await n.json();throw new O(await n.json())}async function Je(){if(!I())return;const e=await fetch(`${D.api}api/get-data`,{headers:{authorization:await J()}});if(e.status===200)return await e.json();throw new O(await e.json())}async function he(e){if(!I())return;const n=await fetch(`${D.api}api/sync-data`,{method:"POST",headers:{authorization:await J(),"content-type":"application/json"},body:JSON.stringify(e)});if(n.status===200)return await n.json();throw new O(await n.json())}async function Ke(){if(!I())return;const e=await fetch(`${D.api}api/delete-data`,{method:"DELETE",headers:{authorization:await J()}});if(e.status===200)return await e.json();throw new O(await e.json())}const{pushModal:We,popModal:qe}=u.findByProps("pushModal","popModal"),Qe=u.findByName("OAuth2AuthorizeModal"),Ze=u.findByStoreName("UserStore");function et(){We({key:"oauth2-authorize",modal:{key:"oauth2-authorize",modal:Qe,animation:"slide-up",shouldPersistUnderModals:!1,props:{clientId:D.oauth2.clientId,redirectUri:D.oauth2.redirectURL,scopes:["identify"],responseType:"code",permissions:0n,cancelCompletesFlow:!1,callback:async function(e){let{location:n}=e;try{const r=new URL(n).searchParams.get("code"),i=await Xe(r);c.auth??={},c.auth[Ze.getCurrentUser().id]=i,Q(),p.showToast("Successfully authenticated",s.getAssetIDByName("Check"))}catch(r){p.showToast(String(r),s.getAssetIDByName("Small"))}},dismissOAuthModal:function(){return qe("oauth2-authorize")}},closable:!0}})}const{BundleUpdaterManager:It,MMKVManager:tt}=window.nativeModuleProxy;async function ye(){const e={themes:[],plugins:[]};for(const n of Object.values(w.plugins)){const r=c.pluginSettings?.[n.id];if(r?.syncPlugin===!1)continue;const i=r?.syncStorage===!1?{}:await N.createMMKVBackend(n.id).get();e.plugins.push({id:n.id,enabled:n.enabled,options:i})}for(const n of Object.values(A.themes))e.themes.push({id:n.id,enabled:n.selected});return e}let F;function nt(e){F=e}async function rt(e){if(!f.save)return;F?.(!0);const n=[...f.save.sync.plugins.filter(function(a){return!w.plugins[a.id]&&!M(a.id)&&L(a.id)&&e.unproxiedPlugins}),...f.save.sync.plugins.filter(function(a){return!w.plugins[a.id]&&M(a.id)&&L(a.id)&&e.plugins})],r=f.save.sync.themes.filter(function(a){return!A.themes[a.id]&&e.themes});if(!n[0]&&!r[0])return F?.(!1),p.showToast("Nothing to import",s.getAssetIDByName("Small"));p.showToast(`Importing ${[n.length&&`${n.length} plugin${n.length!==1?"s":""}`,r.length&&`${r.length} theme${r.length!==1?"s":""}`].filter(function(a){return!!a}).join(" and ")}`,s.getAssetIDByName("toast_image_saved"));const i={plugins:0,themes:0};await Promise.all([...n.map(function(a){return new Promise(async function(l){tt.setItem(a.id,JSON.stringify(a.options)),w.installPlugin(a.id,a.enabled).then(function(){return i.plugins++}).finally(l)})}),...r.map(function(a){return new Promise(async function(l){return A.installTheme(a.id).then(function(){return i.themes++}).finally(l)})})]),p.showToast(`Imported ${[[i.plugins,"plugin"],[i.themes,"theme"]].map(function(a){let[l,y]=a;return`${l} ${y}${l!==1?"s":""}`}).join(" and ")}!`,s.getAssetIDByName("check"));const o=A.themes[r.find(function(a){return a.enabled})?.id];o&&(await N.createFileBackend("vendetta_theme.json").set(Object.assign(o,{selected:!0})),await function(){return new Promise(function(a){return H.showConfirmationAlert({title:"Theme selected",content:"A reload is required to see the theme. Do you want to reload now?",confirmText:"Reload",confirmColor:"red",onConfirm:function(){window.nativeModuleProxy.BundleUpdaterManager.reload(),a()},cancelText:"Skip",onCancel:a,isDismissable:!0})})}()),F?.(!1)}const{FormCheckboxRow:K}=g.Forms;function pe(e){let{defOptions:n}=e;const r={unproxiedPlugins:f.save.sync.plugins.filter(function(a){return!w.plugins[a.id]&&!M(a.id)&&L(a.id)}).length,plugins:f.save.sync.plugins.filter(function(a){return!w.plugins[a.id]&&M(a.id)&&L(a.id)}).length,themes:f.save.sync.themes.filter(function(a){return!A.themes[a.id]}).length},[i,o]=t.React.useState(n??{unproxiedPlugins:!1,plugins:!!r.plugins,themes:!!r.themes});return t.React.createElement(ne,null,t.React.createElement(Oe,null,t.React.createElement(_e,{title:"Import Data",trailing:t.React.createElement(xe,{onPress:function(){return re()}})}),t.React.createElement(K,{label:`Unproxied Plugins (${r.unproxiedPlugins})`,disabled:!r.unproxiedPlugins,onPress:function(){return r.unproxiedPlugins&&(!i.unproxiedPlugins&&!n?H.showConfirmationAlert({title:"Warning",content:"Installing unproxied plugins can be dangerous since they haven't been verified by Vendetta staff. Are you sure you want to import them?",isDismissable:!0,confirmText:"Yes",confirmColor:"brand",onConfirm:function(){return ie(pe,{defOptions:{...i,unproxiedPlugins:!0}})},cancelText:"Cancel"}):o({...i,unproxiedPlugins:!i.unproxiedPlugins}))},selected:i.unproxiedPlugins}),t.React.createElement(K,{label:`Plugins (${r.plugins})`,disabled:!r.plugins,onPress:function(){return r.plugins&&o({...i,plugins:!i.plugins})},selected:i.plugins}),t.React.createElement(K,{label:`Themes (${r.themes})`,disabled:!r.themes,onPress:function(){return r.themes&&o({...i,themes:!i.themes})},selected:i.themes}),t.React.createElement(g.Button,{text:"Import",color:"green",size:"medium",renderIcon:function(){return t.React.createElement(t.ReactNative.Image,{style:{marginRight:8},source:s.getAssetIDByName("ic_download_24px")})},onPress:function(){rt(i),re()},style:{marginHorizontal:16,marginVertical:16},disabled:!i.unproxiedPlugins&&!i.plugins&&!i.themes})))}const Se=u.findByProps("isTablet"),{View:it}=g.General,{FormRow:at}=g.Forms;function ot(){const[e,n]=t.React.useState({});return I()?t.React.createElement(it,{style:{flexDirection:Se.isTablet?"row":"column",justifyContent:"flex-end"}},[{text:"Save Data",onPress:async function(r){r(!0);try{f.save=await he(await ye()),p.showToast("Successfully synced data",s.getAssetIDByName("Check"))}catch(i){p.showToast(String(i),s.getAssetIDByName("Small"))}r(!1)}},{text:"Import Data",onPress:function(r){f.save&&(ie(pe,{}),nt(r))}}].map(function(r,i){const o=i!==0?8:0;return t.React.createElement(g.Button,{text:r.text,color:"green",size:"small",onPress:function(){return!e[i]&&r.onPress(function(a){n({...e,[i]:!!a})})},trailing:t.React.createElement(at.Icon,{source:s.getAssetIDByName("Check")}),loading:e[i],style:[Se.isTablet?{marginLeft:o}:{marginTop:o}]})})):t.React.createElement(k,{variant:"text-md/semibold",color:"TEXT_NORMAL",align:"center"},"Authenticate first to manage your data")}const{FormSwitchRow:Re}=g.Forms;function st(){const[e,n]=t.React.useState(""),[,r]=t.React.useReducer(function(a){return~a},0);t.React.useEffect(function(){n("")},[]),N.useProxy(c);const i=t.NavigationNative.useNavigation(),o=i.addListener("focus",function(){o(),i.setOptions({title:"Plugin Settings",headerRight:function(){return t.React.createElement(oe,{onPress:function(){return H.showConfirmationAlert({title:"Revert Settings",content:"Are you sure you want to revert all plugin settings?",confirmText:"Revert",cancelText:"Cancel",confirmColor:"red",onConfirm:function(){return c.pluginSettings={}}})},icon:s.getAssetIDByName("ic_message_delete"),style:"header"})}})});return t.React.createElement(t.ReactNative.FlatList,{ListHeaderComponent:t.React.createElement(g.Search,{style:{marginBottom:10},onChangeText:function(a){return n(a.toLowerCase())}}),style:{paddingHorizontal:10,paddingTop:10},contentContainerStyle:{paddingBottom:20},data:Object.entries(w.plugins).filter(function(a){return a[1].manifest.name?.toLowerCase().includes(e)}),renderItem:function(a){let{item:[l,y]}=a;c.pluginSettings??={};const d=c.pluginSettings[l]??{syncPlugin:!0,syncStorage:!0},b=function(){c.pluginSettings??={},d.syncPlugin===!0&&d.syncStorage===!0?delete c.pluginSettings[l]:c.pluginSettings[l]=d,r()};return t.React.createElement(g.Summary,{label:y.manifest.name,icon:y.manifest.vendetta.icon??":3"},t.React.createElement(Re,{label:"Sync Plugin",onValueChange:function(){d.syncPlugin=!d.syncPlugin,b()},value:d.syncPlugin}),t.React.createElement(Re,{label:"Sync Plugin Storage",onValueChange:function(){d.syncStorage=!d.syncStorage,b()},value:d.syncStorage}))}})}var Ee={github:{url:"https://github.com/nexpid/VendettaPlugins/"}};const{showSimpleActionSheet:ct}=u.findByProps("showSimpleActionSheet"),lt=u.findByStoreName("UserStore");function ut(){const e=Ce.getDebugInfo(),n=t.ReactNative.NativeModules.InfoDictionaryManager??t.ReactNative.NativeModules.RTNClientInfoManager;return`Device: ${e.os.name==="iOS"?e.device.codename:`${e.device.brand} ${e.device.model}`}
Model: ${e.device.model}
Manufacturer: ${e.device.manufacturer}
Brand: ${e.device.brand}

OS: ${e.os.name}
Version: ${e.os.version}

Discord Branch: ${n.ReleaseChannel}
Discord Version: ${e.discord.version}
Discord Build: ${e.discord.build}
Vendetta Version: ${e.vendetta.version}

React Version: ${e.react.version}
Hermes Bytecode: ${e.hermes.bytecodeVersion}`}function ve(e){const n=lt.getCurrentUser(),r=new URLSearchParams;for(const[i,o]of Object.entries(e))r.set(i,o);return r.set("discord-username",`@${n.username}${n.discriminator!=="0"?`#${n.discriminator}`:""}`),console.log(`${Ee.github.url}issues/new?${r.toString()}`),`${Ee.github.url}issues/new?${r.toString()}`}const dt=function(e){return ct({key:"CardOverflow",header:{title:"GitHub Reports"},options:[{label:"Copy bug report link",icon:s.getAssetIDByName("copy"),onPress:function(){t.clipboard.setString(ve({title:`bug(${e}): `,template:"bug_report.yml",labels:"bug",sysinfo:ut()})),p.showToast("Copied",s.getAssetIDByName("toast_copy_link"))}},{label:"Copy feature suggestion link",icon:s.getAssetIDByName("copy"),onPress:function(){t.clipboard.setString(ve({title:`suggest(${e}): `,labels:"suggestion",template:"suggestion.yml"})),p.showToast("Copied",s.getAssetIDByName("toast_copy_link"))}}]})},{ScrollView:ft,View:gt}=g.General,{FormRow:h,FormSwitchRow:me}=g.Forms,we=u.findByStoreName("UserStore");function W(){N.useProxy(f),N.useProxy(c);const e=t.NavigationNative.useNavigation(),n=e.addListener("focus",function(){n(),e.setOptions({headerRight:function(){return t.React.createElement(oe,{icon:s.getAssetIDByName("ic_report_message"),style:"header",onPress:function(){return dt("cloud-sync")}})}})});return t.React.createElement(ft,null,t.React.createElement(j,{title:"Current Data",icon:s.getAssetIDByName("ic_contact_sync"),padding:!0},t.React.createElement(gt,{style:{flexDirection:"row",alignItems:"center",justifyContent:"center",marginVertical:8}},t.React.createElement(ue,{count:f.save?.sync?.plugins?.length??"-",subtitle:"plugins",contents:2}),t.React.createElement(ue,{count:f.save?.sync?.themes?.length??"-",subtitle:"themes",contents:2}))),t.React.createElement(j,{title:"Settings",icon:s.getAssetIDByName("ic_cog_24px")},t.React.createElement(me,{label:"Auto Save",subLabel:"Automatically save data to cloud",leading:t.React.createElement(h.Icon,{source:s.getAssetIDByName("ic_contact_sync")}),onValueChange:function(){return c.autoSync=!c.autoSync},value:c.autoSync??!1}),!Z&&c.autoSync&&t.React.createElement(k,{variant:"text-md/semibold",color:"TEXT_DANGER",style:{marginHorizontal:20,marginVertical:2}},"You must reinstall Vendetta in order to use Auto Save!"),t.React.createElement(me,{label:"Pin To Settings",subLabel:"Pin Cloud Sync to the settings page",leading:t.React.createElement(h.Icon,{source:s.getAssetIDByName("ic_message_pin")}),onValueChange:function(){return c.addToSettings=!c.addToSettings},value:c.addToSettings??!1}),t.React.createElement(h,{label:"Plugin Settings",leading:t.React.createElement(h.Icon,{source:s.getAssetIDByName("debug")}),trailing:t.React.createElement(h.Arrow,null),onPress:function(){return e.push("VendettaCustomPage",{render:st})}})),t.React.createElement(j,{title:"Authentication",icon:s.getAssetIDByName("lock")},I()?t.React.createElement(t.React.Fragment,null,t.React.createElement(h,{label:"Log out",subLabel:"Logs you out of CloudSync",leading:t.React.createElement(h.Icon,{source:s.getAssetIDByName("ic_logout_24px")}),onPress:function(){c.auth??={},delete c.auth[we.getCurrentUser().id],delete f.save,p.showToast("Successfully logged out",s.getAssetIDByName("ic_logout_24px"))}}),t.React.createElement(h,{label:"Delete data",subLabel:"Deletes your CloudSync data",leading:t.React.createElement(h.Icon,{source:s.getAssetIDByName("trash")}),onPress:async function(){await Ke(),c.auth??={},delete c.auth[we.getCurrentUser().id],delete f.save,p.showToast("Successfully deleted data",s.getAssetIDByName("trash"))}})):t.React.createElement(h,{label:"Authenticate",leading:t.React.createElement(h.Icon,{source:s.getAssetIDByName("copy")}),trailing:h.Arrow,onPress:et})),t.React.createElement(j,{title:"Data Management",icon:s.getAssetIDByName("ic_message_edit"),padding:!0},t.React.createElement(ot,null),I()&&t.React.createElement(t.React.Fragment,null,t.React.createElement(Ue,null),t.React.createElement(h,{label:"Copy Data as JSON",leading:t.React.createElement(h.Icon,{source:s.getAssetIDByName("copy")}),onPress:function(){t.clipboard.setString(JSON.stringify(f.save??{},void 0,3)),p.showToast("Copied",s.getAssetIDByName("Check"))}}))))}let be=0;function ht(e){clearTimeout(be),be=setTimeout(e,1500)}const{FormRow:q}=g.Forms;function yt(){const e=t.NavigationNative.useNavigation();return React.createElement(g.ErrorBoundary,null,React.createElement(q,{label:"Cloud Sync",leading:React.createElement(q.Icon,{source:s.getAssetIDByName("ic_contact_sync")}),trailing:q.Arrow,onPress:function(){return e.push("VendettaCustomPage",{title:"CloudSync",render:W})}}))}const{FormSection:pt}=g.Forms,St=u.findByName("getScreens"),Rt=u.findByName("UserSettingsOverviewWrapper",!1),Et=u.findByName("SettingsOverviewScreen",!1),$=u.findByProps("SETTING_RELATIONSHIPS","SETTING_RENDERER_CONFIGS"),vt=u.findByProps("getSettingTitleConfig"),mt=t.stylesheet.createThemedStyleSheet({container:{flex:1,backgroundColor:R.semanticColors.BACKGROUND_MOBILE_PRIMARY}});function wt(e,n,r){const i=[],o=U.after("default",Rt,function(a,l){o();const y=Y.findInReactTree(l.props.children,function(d){return d.type&&d.type.name==="UserSettingsOverview"});i.push(U.after("render",y.type.prototype,function(d,b){let{props:{children:T}}=b;const E=[t.i18n.Messages.BILLING_SETTINGS,t.i18n.Messages.PREMIUM_SETTINGS];T=Y.findInReactTree(T,function(v){return v.children[1].type===pt}).children;const S=T.findIndex(function(v){return E.includes(v?.props.label)});e()&&T.splice(S===-1?4:S,0,n())}))},!0);if(i.push(o),St&&r){const a=`VENDETTA_PLUGIN_${t.lodash.snakeCase(r.key).toUpperCase()}`;i.push(U.after("default",Et,function(T,E){const S=E.props.sections,v=S.findIndex(function(C){return C.title==="Vendetta"});if(S[v]&&e()){const C={...S[v]};C.settings=[...C.settings,a],S[v]=C}})),i.push(U.after("getSettingTitleConfig",vt,function(T,E){return{...E,...Object.fromEntries([[a,typeof r.title=="function"?r.title():r.title]])}}));const l=r.page.render,y=t.React.memo(function(T){let{navigation:E}=T;const S=E.addListener("focus",function(){S(),E.setOptions(Y.without(r.page,"noErrorBoundary","render"))});return t.React.createElement(t.ReactNative.View,{style:mt.container},r.page.noErrorBoundary?t.React.createElement(l,null):t.React.createElement(g.ErrorBoundary,null,t.React.createElement(l,null)))}),d=$.SETTING_RELATIONSHIPS;$.SETTING_RELATIONSHIPS={...d,...Object.fromEntries([[a,null]])};const b=$.SETTING_RENDERER_CONFIGS;$.SETTING_RENDERER_CONFIGS={...b,...Object.fromEntries([[a,{type:"route",icon:r.icon,screen:{route:`VendettaPlugin${t.lodash.chain(r.key).camelCase().upperFirst().value()}`,getComponent:function(){return y}}}]])},i.push(function(){$.SETTING_RELATIONSHIPS=d,$.SETTING_RENDERER_CONFIGS=b})}return function(){return i.forEach(function(a){return a()})}}function bt(){let e=[];return e.push(wt(function(){return c.addToSettings},function(){return React.createElement(yt,null)},{key:Ie.plugin.manifest.name,icon:s.getAssetIDByName("ic_contact_sync"),title:"Cloud Sync",page:{title:"CloudSync",render:W}})),function(){return e.forEach(function(n){return n()})}}const c=z.storage;let Te;const f=N.wrapSync(N.createStorage({get:function(){return Te},set:function(e){Te=e}}));async function Q(){try{f.save=await Je()}catch{}}function M(e){return e.startsWith(Pe.PROXY_PREFIX)}function L(e){return!e.includes("cloud-sync")}const P=async function(){if(!c.autoSync)return;const e=await ye();JSON.stringify(f.save)!==JSON.stringify(e)&&ht(async function(){return f.save=await he(e)})},G=Symbol.for("vendetta.storage.emitter"),Z=!!w.plugins[G]&&!!A.themes[G];let ee=[];var Tt={onLoad:function(){if(I()&&Q(),Z){const e={plugins:w.plugins[G],themes:A.themes[G]};e.plugins.on("SET",P),e.themes.on("SET",P),e.plugins.on("DEL",P),e.themes.on("DEL",P),ee.push(function(){e.plugins.off("SET",P),e.themes.off("SET",P),e.plugins.off("DEL",P),e.themes.off("DEL",P)})}ee.push(bt()),z.storage.databaseMigrate&&delete z.storage.databaseMigrate},onUnload:function(){return ee.forEach(function(e){return e()})},settings:W};return m.cache=f,m.canImport=L,m.default=Tt,m.emitterAvailable=Z,m.fillCache=Q,m.isPluginProxied=M,m.vstorage=c,Object.defineProperty(m,"__esModule",{value:!0}),m})({},vendetta.plugin,vendetta.storage,vendetta.metro,vendetta.plugins,vendetta.themes,vendetta.ui.toasts,vendetta.ui.assets,vendetta.ui.alerts,vendetta.metro.common,vendetta.ui.components,vendetta.patcher,vendetta.ui,vendetta.utils,vendetta,vendetta.constants,vendetta.debug);
