(function(k,be,V,Se,l,e,b,me,p,M,C,xe,Nt,ae){"use strict";const Ae=l.findByStoreName("ThemeStore"),Pe=l.findByProps("colors","meta");l.findByProps("triggerHaptic");const H=l.findByProps("TextStyleSheet").TextStyleSheet,{View:L,Text:re,Pressable:Te}=M.General;l.findByProps("TableRow");const Ie=l.findByProps("ActionSheet")?.ActionSheet??l.find(function(t){return t.render?.name==="ActionSheet"}),Be=l.findByProps("openLazy","hideActionSheet"),{openLazy:Ne,hideActionSheet:O}=Be,{ActionSheetTitleHeader:ke,ActionSheetCloseButton:De,ActionSheetContentContainer:_e}=l.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton","ActionSheetContentContainer");l.findByProps("ActionSheetRow")?.ActionSheetRow,l.findByName("Navigator")??l.findByProps("Navigator")?.Navigator,l.findByProps("getRenderCloseButton")?.getRenderCloseButton??l.findByProps("getHeaderCloseButton")?.getHeaderCloseButton,l.findByProps("popModal","pushModal");const ie=l.findByProps("useSearchControls"),G=l.findByProps("useSettingSearchQuery"),Me=l.findByName("SettingSearchBar"),{SvgXml:oe}=l.findByProps("SvgXml");l.findByProps("useInMainTabsExperiment","isInMainTabsExperiment");const Le=l.find(function(t){return t?.WebView&&!t.default}).WebView;l.findByProps("Button","SegmentedControl");function Oe(t){return Pe.meta.resolveSemanticColor(Ae.theme,t)}function X(t,n){try{Ne(new Promise(function(r){return r({default:t})}),"ActionSheet",n)}catch(r){xe.logger.error(r.stack),C.showToast("Got error when opening ActionSheet! Please check debug logs",p.getAssetIDByName("Smal"))}}Object.assign(function(t){let{searchContext:n,controls:r}=t;return e.React.createElement(e.ReactNative.ScrollView,{scrollEnabled:!1},e.React.createElement(ie.default,{searchContext:n,controls:r},e.React.createElement(Me,null)))},{useAdvancedSearch:function(t){const n=G.useSettingSearchQuery(),r=ie.useSearchControls(t,!1,function(){});return e.React.useEffect(function(){return function(){G.setSettingSearchQuery(""),G.setIsSettingSearchActive(!1)}},[]),[n,r]}}),window.nativeModuleProxy.DCDFileManager??window.nativeModuleProxy.RTNFileManager,window.nativeModuleProxy.BundleUpdaterManager,window.nativeModuleProxy.MMKVManager,window.nativeModuleProxy.DCDSoundManager;function $e(t){let{title:n,onPress:r,icon:a}=t;const o=e.stylesheet.createThemedStyleSheet({androidRipple:{color:b.semanticColors.ANDROID_RIPPLE},icon:{height:18,tintColor:b.semanticColors.HEADER_SECONDARY,opacity:.5}}),s=r?Te:L;return e.React.createElement(s,{android_ripple:o.androidRipple,disabled:!1,accessibilityRole:"button",onPress:r,style:{marginBottom:8,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},a&&e.React.createElement(L,{style:{marginRight:4}},e.React.createElement(e.ReactNative.Image,{style:o.icon,source:a,resizeMode:"contain"})),e.React.createElement(S,{variant:"text-sm/semibold",color:"HEADER_SECONDARY"},n))}function ce(t){let{title:n,onTitlePress:r,icon:a,children:o,padding:s}=t;const u=e.stylesheet.createThemedStyleSheet({main:{backgroundColor:b.semanticColors.CARD_PRIMARY_BG,borderRadius:16,overflow:"hidden",flex:1}});return e.React.createElement(L,{style:{marginHorizontal:16,marginTop:16}},e.React.createElement($e,{title:n,onPress:r,icon:a}),e.React.createElement(L,{style:u.main},s?e.React.createElement(L,{style:{paddingHorizontal:16,paddingVertical:16}},o):o))}var se;(function(t){function n(a){let{children:o,onPress:s}=a;return e.React.createElement(S,{variant:"text-md/bold",onPress:s},o)}t.Bold=n;function r(a){let{children:o,onPress:s}=a;return e.React.createElement(re,{style:{textDecorationLine:"underline"},onPress:s},o)}t.Underline=r})(se||(se={}));function S(t){let{variant:n,lineClamp:r,color:a,align:o,style:s,onPress:u,getChildren:f,children:i,liveUpdate:g}=t;const[m,x]=e.React.useReducer(function(N){return~N},0);return e.React.useEffect(function(){if(!g)return;const N=new Date().setMilliseconds(1e3);let E;const c=setTimeout(function(){x(),E=setInterval(x,1e3)},N-Date.now());return function(){clearTimeout(c),clearInterval(E)}},[]),e.React.createElement(re,{style:[n?H[n]:{},a?{color:Oe(b.semanticColors[a])}:{},o?{textAlign:o}:{},s??{}],numberOfLines:r,onPress:u},f?.()??i)}const le="https://songspotlight.nexpid.xyz/";var P={get api(){return y.host?y.host.endsWith("/")?y.host:`${y.host}/`:le},oauth2:{clientId:"1157745434140344321",get redirectURL(){return`${y.host?y.host.endsWith("/")?y.host:`${y.host}/`:le}api/oauth2-response`}}};function Ue(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function je(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function z(t,n,r){return ue()?z=Reflect.construct:z=function(a,o,s){var u=[null];u.push.apply(u,o);var f=Function.bind.apply(a,u),i=new f;return s&&U(i,s.prototype),i},z.apply(null,arguments)}function $(t){return $=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},$(t)}function Ve(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&U(t,n)}function ze(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function Fe(t,n){return n&&(He(n)==="object"||typeof n=="function")?n:Ue(t)}function U(t,n){return U=Object.setPrototypeOf||function(r,a){return r.__proto__=a,r},U(t,n)}function He(t){"@swc/helpers - typeof";return t&&typeof Symbol<"u"&&t.constructor===Symbol?"symbol":typeof t}function W(t){var n=typeof Map=="function"?new Map:void 0;return W=function(r){if(r===null||!ze(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof n<"u"){if(n.has(r))return n.get(r);n.set(r,a)}function a(){return z(r,arguments,$(this).constructor)}return a.prototype=Object.create(r.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),U(a,r)},W(t)}function ue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ge(t){var n=ue();return function(){var r=$(t),a;if(n){var o=$(this).constructor;a=Reflect.construct(r,arguments,o)}else a=r.apply(this,arguments);return Fe(this,a)}}const de=l.findByStoreName("UserStore");let D=function(t){Ve(r,t);var n=Ge(r);function r(a){je(this,r);var o;return o=n.call(this,`${a.status}: ${a.message}${a.error?` (${a.error})`:""}`),o.name=o.constructor.name,o}return r}(W(Error));function T(){return y.auth?.[de.getCurrentUser()?.id]}async function J(){var t;const n=new Error("Unauthorized, try logging out and back in again");let r=T();if(!r)throw n;if(Date.now()>=r.expiresAt){const a=await fetch(`${P.api}api/refresh-access-token?refresh_token=${encodeURIComponent(r.refreshToken)}`);if(a.status!==200)throw new D(await a.json());r=await a.json(),(t=y).auth??(t.auth={}),y.auth[de.getCurrentUser().id]=r}return r.accessToken}async function Xe(t){const n=await fetch(`${P.api}api/get-access-token?code=${encodeURIComponent(t)}`);if(n.status===200)return await n.json();throw new D(await n.json())}async function We(t){const n=new URLSearchParams;n.append("id",t);const r=await fetch(`${P.api}api/get-profile-data?${n.toString()}`);if(r.status===200)return await r.json();throw new D(await r.json())}async function Je(){if(!T())return;const t=await fetch(`${P.api}api/get-data`,{headers:{authorization:await J()}});if(t.status===200)return await t.json();throw new D(await t.json())}async function Ze(t){if(!T())return;const n=await fetch(`${P.api}api/sync-data`,{method:"POST",headers:{authorization:await J(),"content-type":"application/json"},body:JSON.stringify(t)});if(n.status===200)return await n.json();throw new D(await n.json())}async function Ye(){if(!T())return;const t=await fetch(`${P.api}api/delete-data`,{method:"DELETE",headers:{authorization:await J()}});if(t.status===200)return await t.json();throw new D(await t.json())}let fe=0;function Qe(t){clearTimeout(fe),fe=setTimeout(t,1500)}let pe;function Z(){const t=pe?.slice();pe=JSON.stringify(v.data),t&&t!==JSON.stringify(v.data)&&Qe(function(){return Ze(v.data.songs)})}const{pushModal:qe,popModal:Ke}=l.findByProps("pushModal","popModal"),et=l.findByName("OAuth2AuthorizeModal"),tt=l.findByStoreName("UserStore");function nt(){qe({key:"oauth2-authorize",modal:{key:"oauth2-authorize",modal:et,animation:"slide-up",shouldPersistUnderModals:!1,props:{clientId:P.oauth2.clientId,redirectUri:P.oauth2.redirectURL,scopes:["identify"],responseType:"code",permissions:0n,cancelCompletesFlow:!1,callback:async function(t){var n;let{location:r}=t;try{const a=new URL(r).searchParams.get("code"),o=await Xe(a);(n=y).auth??(n.auth={}),y.auth[tt.getCurrentUser().id]=o,te(),C.showToast("Successfully authenticated",p.getAssetIDByName("Check"))}catch(a){C.showToast(String(a),p.getAssetIDByName("Small"))}},dismissOAuthModal:function(){return Ke("oauth2-authorize")}},closable:!0}})}const Y=new Map,Q=async function(t,n,r,a){const o=`${t}${n}${r}`;if(Y.has(o))return Y.get(o);if(t==="spotify"){const s=await(await fetch(`https://open.spotify.com/embed/${n}/${r}`,{signal:a})).text(),u=JSON.parse(`{"props"${s.split('{"props"')[1].split("<\/script>")[0]}`);return Y.set(o,u),u}else return!1};async function at(t,n,r,a){if(t==="spotify"){const o=(await Q(t,n,r,a))?.props?.pageProps?.state?.data?.entity;return o?.name&&o?.coverArt?o:!1}else return!1}async function rt(t,n,r,a){return t==="spotify"?(await Q(t,n,r,a))?.props?.pageProps?.state?.data?.entity?.name??!1:!1}async function it(t,n,r,a){return t==="spotify"?(await Q(t,n,r,a)).page?.props?.status!==404:!1}const he=function(t,n,r){return t==="spotify"?`https://open.spotify.com/${n}/${r}`:void 0};l.findByStoreName("ThemeStore");async function ot(t){await e.ReactNative.Linking.canOpenURL(t)?e.url.openDeeplink(t):await e.ReactNative.Linking.canOpenURL("market://details?id=com.spotify.music")?e.url.openDeeplink("market://details?id=com.spotify.music"):e.url.openDeeplink("itms-apps://itunes.apple.com/app/id324684580")}function ct(t){let{service:n,type:r,id:a,normal:o}=t;const[s,u]=e.React.useState(null);return e.React.useEffect(function(){u(void 0),a&&rt(n,r,a).then(function(f){return u(f!==!1?f:"N/A")})},[a]),e.React.createElement(S,{variant:o?"text-md/semibold":"text-md/medium",color:o?"TEXT_NORMAL":"TEXT_MUTED"},s??"-")}const{FormRow:I}=M.Forms,st={color:"TEXT_DANGER",variant:"text-md/semibold"};function q(t){let{song:n,remove:r,showAdd:a}=t;const o=e.stylesheet.createThemedStyleSheet({destructiveIcon:{tintColor:b.semanticColors.TEXT_DANGER}});return React.createElement(Ie,null,React.createElement(_e,null,React.createElement(ke,{title:"Edit Song",trailing:React.createElement(De,{onPress:O})}),n.service==="spotify"&&React.createElement(I,{label:"Open in Spotify",leading:React.createElement(I.Icon,{source:p.getAssetIDByName("img_account_sync_spotify_light_and_dark")}),onPress:function(){ot(`spotify://${n.type}/${n.id}`),O()}}),React.createElement(I,{label:"Copy link",leading:React.createElement(I.Icon,{source:p.getAssetIDByName("copy")}),onPress:function(){e.clipboard.setString(he(n.service,n.type,n.id)),C.showToast("Copied to clipboard.",p.getAssetIDByName("toast_copy_link")),O()}}),a&&React.createElement(I,{label:"Add to your profile",leading:React.createElement(I.Icon,{source:p.getAssetIDByName("ic_pin")}),onPress:function(){O();const s=v.data?.songs;if(!s)return;const u=s.findIndex(function(f){return f===null});if(u===-1)return C.showToast("No space left!",p.getAssetIDByName("Small"));s[u]=n,Z(),C.showToast("Added to your profile",p.getAssetIDByName("Check"))}}),r&&React.createElement(I,{label:React.createElement(S,st,"Remove song"),leading:React.createElement(I.Icon,{style:o.destructiveIcon,source:p.getAssetIDByName("trash")}),onPress:function(){r(),C.showToast("Removed",p.getAssetIDByName("toast_trash")),O()}})))}const{ScrollView:lt,View:K}=M.General,{FormRow:B}=M.Forms,ye=l.findByStoreName("UserStore");function ut(){V.useProxy(v),V.useProxy(y),Z();const t=e.stylesheet.createThemedStyleSheet({song:{backgroundColor:b.semanticColors.BG_MOD_FAINT,borderRadius:8},serviceFrame:{height:24,width:24,backgroundColor:b.semanticColors.BG_MOD_FAINT,borderRadius:2147483647}}),n=!!T(),r=!!v.data;return React.createElement(lt,null,React.createElement(ce,{title:"Songs",icon:p.getAssetIDByName("abc"),padding:!0},n&&r?React.createElement(K,{style:{flexDirection:"column",gap:8}},v.data.songs.map(function(a,o){return React.createElement(B,{label:a===null?"Press to add song in this position":React.createElement(ct,{service:a.service,type:a.type,id:a.id,normal:!0}),leading:a===null?React.createElement(K,{style:t.serviceFrame}):React.createElement(e.ReactNative.Image,{style:t.serviceFrame,source:p.getAssetIDByName("img_account_sync_spotify_light_and_dark")}),onLongPress:function(){return a&&X(q,{song:a,remove:function(){return v.data.songs[o]=null}})},onPress:function(){return me.showInputAlert({title:"Add song",placeholder:["https://open.spotify.com/track/ABC","https://open.spotify.com/album/ABC","https://open.spotify.com/playlist/ABC","https://spotify.link/ABC"].sort(function(){return Math.random()>.5?1:-1})[0],initialValue:a&&he(a.service,a.type,a.id),cancelText:"Cancel",confirmText:"Save",onConfirm:async function(s){const u=s.match(Se.HTTP_REGEX_MULTI)?.[0];if(!u)throw new Error("Invalid link!");let f=new URL(u),i=f.hostname,g,m,x;if(i==="spotify.link"&&(g="spotify",f=new URL((await fetch(u)).url),i=f.hostname),i==="open.spotify.com"){g="spotify";const[N,E,c]=f.pathname.split("/");["album","track","playlist"].includes(E)&&c&&(m=E,x=c)}if(!g||!m||!x)throw new Error("Missing service, type or id!");if(!await it(g,m,x))throw new Error("Invalid song!");v.data.songs[o]={service:g,type:m,id:x}}})},style:t.song})})):n?React.createElement(e.ReactNative.ActivityIndicator,{size:"small",style:{flex:1}}):React.createElement(S,{variant:"text-md/semibold",color:"TEXT_NORMAL",align:"center"},"Authenticate first to manage your songs")),React.createElement(ce,{title:"Authentication",icon:p.getAssetIDByName("lock")},T()?React.createElement(React.Fragment,null,React.createElement(B,{label:"Log out",subLabel:"Logs you out of SongSpotlight",leading:React.createElement(B.Icon,{source:p.getAssetIDByName("ic_logout_24px")}),onPress:function(){var a;(a=y).auth??(a.auth={}),delete y.auth[ye.getCurrentUser().id],delete v.data,C.showToast("Successfully logged out",p.getAssetIDByName("ic_logout_24px"))}}),React.createElement(B,{label:"Delete data",subLabel:"Deletes your SongSpotlight data",leading:React.createElement(B.Icon,{source:p.getAssetIDByName("trash")}),onPress:async function(){var a;await Ye(),(a=y).auth??(a.auth={}),delete y.auth[ye.getCurrentUser().id],delete v.data,C.showToast("Successfully deleted data",p.getAssetIDByName("trash"))}})):React.createElement(B,{label:"Authenticate",leading:React.createElement(B.Icon,{source:p.getAssetIDByName("copy")}),trailing:B.Arrow,onPress:nt})),React.createElement(K,{style:{height:12}}))}const dt=l.findByStoreName("ThemeStore"),ft=function(t,n){return dt.theme!=="light"?t:n},F=function(t,n,r){const a=function(i){return i.match(/\w\w/g)?.map(function(g){return parseInt(g,16)})??[0,0,0]},o=function(i){return`#${i.map(function(g){return g.toString(16).padStart(2,"0")}).join("")}`},s=a(t),u=a(n),f=s.map(function(i,g){return Math.round(i+(u[g]-i)*r)});return o(f)};var pt=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12.7 1C12.5143 1 12.3363 1.07375 12.205 1.20503C12.0738 1.3363 12 1.51435 12 1.7V6.85L2.05 1.107C1.94368 1.04561 1.82308 1.01327 1.7003 1.01322C1.57753 1.01316 1.4569 1.0454 1.35053 1.1067C1.24415 1.16799 1.15576 1.25618 1.09424 1.36243C1.03271 1.46867 1.00021 1.58923 1 1.712V14.287C0.999863 14.4099 1.03211 14.5308 1.09349 14.6373C1.15487 14.7438 1.24322 14.8323 1.34966 14.8938C1.4561 14.9553 1.57686 14.9877 1.6998 14.9878C1.82275 14.9878 1.94353 14.9555 2.05 14.894L12 9.149V14.3C12 14.4857 12.0738 14.6637 12.205 14.795C12.3363 14.9262 12.5143 15 12.7 15H14.3C14.4857 15 14.6637 14.9262 14.795 14.795C14.9262 14.6637 15 14.4857 15 14.3V1.7C15 1.51435 14.9262 1.3363 14.795 1.20503C14.6637 1.07375 14.4857 1 14.3 1H12.7Z" fill="white"/>
</svg>`,ht=`<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M1 12C1 5.925 5.925 1 12 1C18.075 1 23 5.925 23 12C23 18.075 18.075 23 12 23C5.925 23 1 18.075 1 12ZM8.5 7C8.36739 7 8.24021 7.05268 8.14645 7.14645C8.05268 7.24021 8 7.36739 8 7.5V16.5C8 16.6326 8.05268 16.7598 8.14645 16.8536C8.24021 16.9473 8.36739 17 8.5 17H10.5C10.6326 17 10.7598 16.9473 10.8536 16.8536C10.9473 16.7598 11 16.6326 11 16.5V7.5C11 7.36739 10.9473 7.24021 10.8536 7.14645C10.7598 7.05268 10.6326 7 10.5 7H8.5ZM13.5 7C13.3674 7 13.2402 7.05268 13.1464 7.14645C13.0527 7.24021 13 7.36739 13 7.5V16.5C13 16.6326 13.0527 16.7598 13.1464 16.8536C13.2402 16.9473 13.3674 17 13.5 17H15.5C15.6326 17 15.7598 16.9473 15.8536 16.8536C15.9473 16.7598 16 16.6326 16 16.5V7.5C16 7.36739 15.9473 7.24021 15.8536 7.14645C15.7598 7.05268 15.6326 7 15.5 7H13.5Z" fill="white"/>
</svg>`,yt=`<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M1 12C1 5.925 5.925 1 12 1C18.075 1 23 5.925 23 12C23 18.075 18.075 23 12 23C5.925 23 1 18.075 1 12ZM9.75 7.433C9.67399 7.38912 9.58777 7.36601 9.5 7.36601C9.41224 7.36601 9.32601 7.38911 9.25001 7.433C9.174 7.47688 9.11088 7.54 9.06699 7.616C9.02311 7.69201 9 7.77823 9 7.866V16.134C9 16.2218 9.02311 16.308 9.06699 16.384C9.11088 16.46 9.174 16.5231 9.25001 16.567C9.32601 16.6109 9.41224 16.634 9.5 16.634C9.58777 16.634 9.67399 16.6109 9.75 16.567L16.911 12.433C16.987 12.3891 17.0501 12.326 17.094 12.25C17.1379 12.174 17.161 12.0878 17.161 12C17.161 11.9122 17.1379 11.826 17.094 11.75C17.0501 11.674 16.987 11.6109 16.911 11.567L9.75 7.433Z" fill="white"/>
</svg>`,gt=`<!doctype html>
<html></html>
<script>
  const RNWV = window.ReactNativeWebView;

  /** @type {(HTMLAudioElement | null)[]} */
  const audios = AUDIOS_VARIABLE.map((x) => (x ? new Audio(x) : null));
  let position = 0;

  /** @argument enabled {boolean} */
  const playback = (enabled) => {
    audios.forEach((x, i) => {
      if (!x) return;
      if (i === position && enabled) x.play();
      else {
        if (i !== position) x.currentTime = 0;
        x.pause();
      }
    });
  };

  audios.forEach((x) =>
    x?.addEventListener("ended", () => RNWV.postMesssage("ended")),
  );

  window.addEventListener("message", (ev) => {
    const { action, pos } = ev.data;
    if (!action) return;

    if (pos !== undefined) position = audios[pos] ? pos : 0;

    if (action === "play") playback(true);
    else if (action === "pause") playback(false);
  });
<\/script>`;const{View:w}=M.General,Rt=e.ReactNative.Animated.createAnimatedComponent(e.ReactNative.Pressable),wt=l.findByName("UserProfileSection"),{YouScreenProfileCard:vt}=l.findByProps("YouScreenProfileCard"),{TableRowGroupTitle:Et}=l.findByProps("TableRowGroupTitle"),Ct=l.findByStoreName("UserStore"),ee=new Map,bt=function(t){let{song:n,showAdd:r,remove:a}=t;const[o,s]=e.React.useState(!1),[u,f]=e.React.useState(0),[i,g]=e.React.useState(void 0),m=i&&i.type==="track"||n.type==="track"?600/152:600/352,x=e.React.useRef(null),N=e.React.useRef(Math.random().toString()).current;e.React.useEffect(function(){o&&ee.forEach(function(h,d){return d!==N&&h()}),x.current?.injectJavaScript(`window.postMessage(${JSON.stringify({action:o?"play":"pause",pos:u})})`)},[o,u]),ee.set(N,function(){return s(!1)}),e.React.useEffect(function(){return function(){ee.delete(N)}},[]);const E=i&&(i.coverArt.extractedColors.colorLight?ft(i.coverArt.extractedColors.colorDark.hex,i.coverArt.extractedColors.colorLight.hex):i.coverArt.extractedColors.colorDark.hex),c=e.stylesheet.createThemedStyleSheet({emptyCard:{width:"100%",aspectRatio:m,backgroundColor:b.semanticColors.BG_MOD_FAINT,borderRadius:12,justifyContent:"center",alignItems:"center"},noImage:{tintColor:b.semanticColors.TEXT_DANGER,width:36,height:36},card:{width:"100%",backgroundColor:E&&F(E,"#000000",.15),aspectRatio:m,borderRadius:12,flexDirection:"column"},cardFirst:{backgroundColor:E,width:"100%",height:"100%",borderRadius:12},cardFirstContent:{flexDirection:"row",gap:8,padding:10},cardImage:{height:"100%",aspectRatio:1,borderRadius:8,backgroundColor:b.semanticColors.BG_MOD_SUBTLE,shadowColor:"#000",shadowOffset:{width:0,height:4},shadowOpacity:.3,shadowRadius:4.65,elevation:8},cardContent:{width:"90%",flexDirection:"column",gap:2,justifyContent:"center",flexGrow:0,flexShrink:0},cardContentArtist:{flexDirection:"row",gap:4,alignItems:"center",flexGrow:0,flexShrink:0},cardContentTag:{backgroundColor:"#ffffffb3",paddingHorizontal:6,paddingVertical:1,borderRadius:4,color:"#000000"},cardOther:{position:"absolute",width:"100%",height:"100%",flexDirection:"column",justifyContent:"space-between",alignItems:"flex-end",padding:10},cardOtherBottom:{flexDirection:"row-reverse",alignItems:"center",gap:4},cardTracklist:{height:"100%",paddingHorizontal:8,flexDirection:"column"},cardTracklistEntry:{backgroundColor:E&&F(E,"#000000",.25),borderRadius:5,flexDirection:"column",padding:8,flexGrow:0,flexShrink:0},cardTracklistEntryUnplayable:{backgroundColor:E&&F(E,"#000000",.2)},cardTracklistEntryPlaying:{backgroundColor:E&&F(E,"#000000",.35)},cardTracklistEntryTitle:{width:"95%",color:"#ffffff"},cardTracklistEntryOther:{position:"absolute",width:"100%",height:"100%",flexDirection:"column",justifyContent:"center",alignItems:"flex-end",padding:5},webview:{display:"none",width:0,height:0,opacity:0},secondaryText:{opacity:.7,color:"#ffffff"},unplayableItem:{opacity:.5},androidRipple:{color:b.semanticColors.ANDROID_RIPPLE,cornerRadius:2147483647},androidRippleTwo:{color:b.semanticColors.ANDROID_RIPPLE,cornerRadius:8}}),ne=e.React.useRef(null),ve=function(){ne.current?.abort();const h=new AbortController;ne.current=h,g(void 0),at(n.service,n.type,n.id,h.signal).then(function(d){const R=d??!1;R&&R.type!=="track"&&(R.trackList=R.trackList.slice(0,50)),g(R)}).catch(function(d){return d?.name!=="AbortError"&&(C.showToast(`${d}`,p.getAssetIDByName("Small")),g(!1))})};e.React.useEffect(function(){return ve(),function(){return ne.current?.abort()}},[]);const Pt=i&&i.coverArt.sources.sort(function(h,d){return h.width*h.height-d.width*d.height})[0],Ee=e.React.useRef();e.React.useEffect(function(){Ee.current?.scrollToIndex({animated:!0,index:u,viewOffset:16})},[u]);const Tt=function(h){let{item:d,selected:R,playable:A,jump:_,more:j}=h;return e.React.createElement(Rt,{android_ripple:c.androidRippleTwo,style:[c.cardTracklistEntry,!A&&c.cardTracklistEntryUnplayable,R&&c.cardTracklistEntryPlaying],onPress:_,onLongPress:j},e.React.createElement(S,{style:[c.cardTracklistEntryTitle,!A&&c.unplayableItem],variant:R?"text-sm/bold":"text-sm/semibold",lineClamp:1},d.title),e.React.createElement(w,{style:c.cardContentArtist},d.isExplicit&&e.React.createElement(S,{variant:"text-xs/semibold",style:[c.cardContentTag,!A&&c.unplayableItem]},"E"),e.React.createElement(S,{variant:R?"text-xs/bold":"text-xs/semibold",style:[c.secondaryText,!A&&c.unplayableItem],lineClamp:1},d.subtitle)),e.React.createElement(w,{style:c.cardTracklistEntryOther},e.React.createElement(e.ReactNative.Pressable,{android_ripple:c.androidRipple,onPress:j},e.React.createElement(e.ReactNative.Image,{source:p.getAssetIDByName("ic_feed_more")}))))},It=i&&i.type==="track"?i.isPlayable&&!!i.audioPreview?.url:!0,Ce=8*2+H["text-sm/normal"].lineHeight+H["text-xs/normal"].lineHeight+1.4;return i?e.React.createElement(e.React.Fragment,null,e.React.createElement(w,{style:c.card,pointerEvents:"box-none"},e.React.createElement(w,{style:[c.cardFirst,i.type!=="track"&&{height:"40%"}]},e.React.createElement(w,{style:c.cardFirstContent},e.React.createElement(e.ReactNative.Image,{style:c.cardImage,source:{uri:Pt.url}}),e.React.createElement(w,{style:c.cardContent},e.React.createElement(S,{variant:"text-sm/bold",style:{color:"#ffffff"},lineClamp:1},i.title),i.type==="track"?e.React.createElement(w,{style:c.cardContentArtist},i.isExplicit&&e.React.createElement(S,{variant:"text-xs/semibold",style:c.cardContentTag},"E"),e.React.createElement(S,{variant:"text-xs/semibold",style:c.secondaryText,lineClamp:1},i.artists.map(function(h){return h.name}).join(", "))):e.React.createElement(S,{variant:"text-xs/semibold",style:[c.secondaryText,{color:"#ffffff"}],lineClamp:1},i.subtitle))),e.React.createElement(w,{style:c.cardOther},e.React.createElement(e.ReactNative.Pressable,{android_ripple:c.androidRipple,onPress:function(){return X(q,{song:n,showAdd:r,remove:a})}},e.React.createElement(e.ReactNative.Image,{source:p.getAssetIDByName("ic_feed_more")})),e.React.createElement(w,{style:c.cardOtherBottom},e.React.createElement(e.ReactNative.Pressable,{android_ripple:c.androidRipple,onPress:function(){return s(!o)},style:!It&&c.unplayableItem},e.React.createElement(oe,{width:30,height:30,xml:o?ht:yt})),i.type!=="track"&&e.React.createElement(e.ReactNative.Pressable,{android_ripple:c.androidRipple,onPress:function(){s(!1);const h=u+1;if(h<i.trackList.length){const d=i.trackList[h];if(d.isPlayable&&d.audioPreview?.url)f(h),s(!0);else{const R=i.trackList.findIndex(function(A,_){return _>h&&A.isPlayable&&!!A.audioPreview?.url});R!==-1&&(f(R),s(!0)),C.showToast("The next song cannot be played")}}else f(0)}},e.React.createElement(oe,{width:20,height:20,xml:pt}))))),i.type!=="track"&&e.React.createElement(e.ReactNative.FlatList,{nestedScrollEnabled:!0,ref:Ee,getItemLayout:function(h,d){return{length:Ce,offset:8*(d+1)+Ce*d,index:d}},style:c.cardTracklist,data:i.trackList,ListHeaderComponent:function(){return e.React.createElement(w,{style:{height:8}})},ListFooterComponent:function(){return e.React.createElement(w,{style:{height:8}})},ItemSeparatorComponent:function(){return e.React.createElement(w,{style:{height:8}})},renderItem:function(h){let{item:d,index:R}=h;const A=d.isPlayable&&!!d.audioPreview?.url;return e.React.createElement(Tt,{item:d,selected:R===u,playable:A,jump:function(){if(A)f(R),s(!0);else{const _=i.trackList.findIndex(function(j,Bt){return Bt>R&&j.isPlayable&&!!j.audioPreview?.url});return _!==-1&&(f(_),s(!0)),C.showToast("This song cannot be played")}},more:function(){return X(q,{song:{service:"spotify",type:"track",id:d.uid},showAdd:r})}})}})),i.isPlayable&&e.React.createElement(Le,{source:{html:gt.replace(/AUDIOS_VARIABLE/g,JSON.stringify(i.type==="track"?[i.audioPreview?.url??null]:i.trackList.map(function(h){return h.audioPreview?.url??null})))},style:c.webview,mediaPlaybackRequiresUserAction:!1,onMessage:function(h){let{nativeEvent:{data:d}}=h;if(d==="ended"&&(s(!1),i.type!=="track")){const R=u+1;R<i.trackList.length?(f(R),s(!0)):f(0)}},ref:x,pointerEvents:"none"})):i===!1?e.React.createElement(w,{style:c.emptyCard},e.React.createElement(e.ReactNative.Pressable,{android_ripple:c.androidRipple,onPress:ve},e.React.createElement(e.ReactNative.Image,{style:c.noImage,source:p.getAssetIDByName("ic_message_retry"),resizeMode:"contain"}))):e.React.createElement(w,{style:c.emptyCard},e.React.createElement(e.ReactNative.ActivityIndicator,{size:"large"}))};function ge(t){let{userId:n,you:r}=t;const[a,o]=e.React.useState(void 0),s=Ct.getCurrentUser().id;e.React.useEffect(function(){s===n&&v.data?o(v.data.songs):We(n).then(function(i){return o(i?.songs??[])}).catch(function(i){return C.showToast(`${i}`,p.getAssetIDByName("Small")),o([])})},[]);const u=a&&!a.filter(function(i){return!!i}).length,f=a?a.map(function(i,g){return i?i.service==="spotify"&&e.React.createElement(bt,{song:i,showAdd:n!==s&&!!T(),remove:n===s&&function(){const m=v.data?.songs;m&&(m[g]=null,Z())}}):null}):e.React.createElement(e.ReactNative.ActivityIndicator,{size:"small",style:{flex:1}});return!u&&(r?e.React.createElement(vt,null,e.React.createElement(Et,{title:"Song Spotlight"}),e.React.createElement(w,{style:{flexDirection:"column",gap:8,marginTop:4}},f)):e.React.createElement(wt,{title:"Song Spotlight",showContainer:!0},e.React.createElement(w,{style:{flexDirection:"column",gap:8,paddingHorizontal:8,paddingVertical:8}},f)))}const St=l.findByName("UserProfileBio",!1),mt=l.findByName("YouAboutMeCard",!1);function xt(){const t=new Array;return t.push(ae.after("default",St,function(n,r){let[a]=n;return e.React.createElement(e.React.Fragment,{},[a?.displayProfile?.userId&&e.React.createElement(ge,{userId:a.displayProfile.userId,you:!1}),r])})),t.push(ae.after("default",mt,function(n,r){let[{userId:a}]=n;return e.React.createElement(e.React.Fragment,{},[e.React.createElement(ge,{userId:a,you:!0}),r])})),function(){return t.forEach(function(n){return n()})}}const y=be.storage;let Re;const v=V.wrapSync(V.createStorage({get:function(){return Re},set:function(t){Re=t}}));async function te(){try{v.data=await Je()}catch{return}}let we;var At={onLoad:function(){T()&&te(),we=xt()},onUnload:function(){return we?.()},settings:ut};return k.cache=v,k.default=At,k.fillCache=te,k.vstorage=y,Object.defineProperty(k,"__esModule",{value:!0}),k})({},vendetta.plugin,vendetta.storage,vendetta.constants,vendetta.metro,vendetta.metro.common,vendetta.ui,vendetta.ui.alerts,vendetta.ui.assets,vendetta.ui.components,vendetta.ui.toasts,vendetta,vendetta.utils,vendetta.patcher);
