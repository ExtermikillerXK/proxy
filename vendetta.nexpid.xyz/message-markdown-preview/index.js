(function(v,O,r,B,N,e,w,y,p,z,pe,fe,G){"use strict";const{Animated:A}=e.ReactNative;function U(n){let{duration:i,children:l,style:a,fade:t,trigger:o,customOpacity:d,setDisplay:h,animateOnInit:f}=n;f??=!0;const P=e.React.useRef(!0),D=e.React.useRef(!0),c=e.React.useRef(new A.Value(f&&t==="in"?1:0)).current,[E,S]=e.React.useState(!1);return e.React.useEffect(function(){const T=c.addListener(function(ue){let{value:de}=ue;S(de<=.1)});return function(){return c.removeListener(T)}},[]),e.React.useEffect(function(){if(!f&&P.current){P.current=!1;return}!f&&D.current&&(c.setValue(t==="in"?0:1),D.current=!1),A.timing(c,{toValue:d??(t==="in"?1:0),duration:i,useNativeDriver:!0}).start()},[c,t,d,o]),e.React.createElement(A.View,{style:[{opacity:c},h&&E&&{display:"none"},a]},l)}const{ScrollView:$}=y.General,{default:k}=r.findByProps("DCDAutoModerationSystemMessageView","default"),F=r.findByName("MessageRecord"),j=r.findByName("RowManager"),I=r.findByStoreName("SelectedChannelStore"),_=r.findByStoreName("UserStore"),{receiveMessage:Y}=r.findByProps("receiveMessage"),{createBotMessage:K}=r.findByProps("createBotMessage"),{getText:q}=r.findByProps("openSystemKeyboard","getText");function x(){const n=q(I.getChannelId());if(n.trim()!=="")if(s.previewType==="popup")z.showConfirmationAlert({title:"Message Preview",onConfirm:function(){},children:React.createElement($,{style:{marginVertical:12,maxHeight:e.ReactNative.Dimensions.get("window").height*.7}},React.createElement(k,{rowGenerator:new j,message:new F({id:"0",channel_id:I.getChannelId(),author:_.getCurrentUser(),content:n})}))});else{const i=I.getChannelId(),l=_.getCurrentUser();return Y(i,Object.assign(K({channelId:i,content:n}),{author:l}))}}const{Pressable:J,View:Q}=y.General,R=40,m=e.stylesheet.createThemedStyleSheet({androidRipple:{color:p.semanticColors.ANDROID_RIPPLE,cornerRadius:2147483647},actionButton:{borderRadius:2147483647,height:R,width:R,marginHorizontal:4,flexShrink:0,flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:p.semanticColors.BACKGROUND_SECONDARY_ALT,marginLeft:8,marginTop:-4},actionIcon:{tintColor:p.semanticColors.INTERACTIVE_NORMAL,width:R*.6,height:R*.6}});function W(n){let{inputProps:i}=n;const[l,a]=e.React.useState("");b.push(B.after("onChangeText",i,function(d){let[h]=d;return a(h)},!0));const t=l.length>0,o=t?J:Q;return e.React.createElement(U,{style:{flexDirection:"row",position:"absolute",left:0,top:-R,zIndex:3},duration:100,fade:t?"in":"out"},e.React.createElement(o,{android_ripple:m.androidRipple,disabled:!1,accessibilityRole:"button",accessibilityState:{disabled:!1,expanded:!1},accessibilityLabel:"Open markdown preview",accessibilityHint:"Open a modal which shows your message's markdown preview",onPress:t?function(){return x()}:void 0,style:m.actionButton},e.React.createElement(e.ReactNative.Image,{style:m.actionIcon,source:w.getAssetIDByName("ic_eye")})))}const{ChatInput:X}=r.findByProps("ChatInput"),b=[];function Z(){return b.push(B.after("render",X.prototype,function(n,i){const l=N.findInReactTree(i.props.children,function(t){return t?.type?.name==="ChatInput"})?.props;if(!l?.onChangeText)return;const a=N.findInReactTree(i.props.children,function(t){return t?.type?.displayName==="View"&&Array.isArray(t?.props?.children)})?.props?.children;a&&s.buttonType==="pill"&&a.unshift(React.createElement(W,{inputProps:l}))})),b.push(B.before("render",e.ReactNative.Pressable.type,function(n){let[i]=n;i?.accessibilityLabel===e.i18n.Messages.SEND&&(i.onLongPress=function(){return s.buttonType==="send"&&x()})})),function(){return b.forEach(function(n){return n()})}}const ee=r.findByStoreName("ThemeStore"),te=r.findByProps("colors","meta");r.findByProps("triggerHaptic");const{TextStyleSheet:ne}=r.findByProps("TextStyleSheet"),{View:g,Text:M,Pressable:re}=y.General;r.findByProps("ActionSheet")?.ActionSheet??r.find(function(n){return n.render?.name==="ActionSheet"}),r.findByProps("openLazy","hideActionSheet"),r.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton","ActionSheetContentContainer"),r.findByProps("ActionSheetRow")?.ActionSheetRow,r.findByName("Navigator"),r.findByProps("getRenderCloseButton"),r.findByProps("popModal","pushModal");function ie(n){return te.meta.resolveSemanticColor(ee.theme,n)}function ae(n){let{title:i,onPress:l,icon:a}=n;const t=e.stylesheet.createThemedStyleSheet({androidRipple:{color:p.semanticColors.ANDROID_RIPPLE},icon:{height:18,tintColor:p.semanticColors.HEADER_SECONDARY,opacity:.5}}),o=l?re:g;return e.React.createElement(o,{android_ripple:t.androidRipple,disabled:!1,accessibilityRole:"button",onPress:l,style:{marginBottom:8,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},a&&e.React.createElement(g,{style:{marginRight:4}},e.React.createElement(e.ReactNative.Image,{style:t.icon,source:a,resizeMode:"contain"})),e.React.createElement(V,{variant:"text-sm/semibold",color:"HEADER_SECONDARY"},i))}function le(n){let{title:i,onTitlePress:l,icon:a,children:t,padding:o}=n;const d=e.stylesheet.createThemedStyleSheet({main:{backgroundColor:p.semanticColors.REDESIGN_ACTIVITY_CARD_BACKGROUND,borderRadius:16,overflow:"hidden",flex:1}});return e.React.createElement(g,{style:{marginHorizontal:16,marginTop:16}},e.React.createElement(ae,{title:i,onPress:l,icon:a}),e.React.createElement(g,{style:d.main},o?e.React.createElement(g,{style:{paddingHorizontal:16,paddingVertical:16}},t):t))}var L;(function(n){function i(a){let{children:t,onPress:o}=a;return e.React.createElement(V,{variant:"text-md/bold",onPress:o},t)}n.Bold=i;function l(a){let{children:t,onPress:o}=a;return e.React.createElement(M,{style:{textDecorationLine:"underline"},onPress:o},t)}n.Underline=l})(L||(L={}));function V(n){let{variant:i,lineClamp:l,color:a,align:t,style:o,onPress:d,getChildren:h,children:f,liveUpdate:P}=n;const[D,c]=e.React.useReducer(function(E){return~E},0);return e.React.useEffect(function(){if(!P)return;const E=new Date().setMilliseconds(1e3);let S,T;return T=setTimeout(function(){c(),S=setInterval(c,1e3)},E-Date.now()),function(){clearTimeout(T),clearInterval(S)}},[]),e.React.createElement(M,{style:[i?ne[i]:{},a?{color:ie(p.semanticColors[a])}:{},t?{textAlign:t}:{},o??{}],numberOfLines:l,onPress:d},h?.()??f)}const{ScrollView:se}=y.General,{FormRow:u,FormRadioRow:C}=y.Forms;function oe(){return s.buttonType??="pill",s.previewType??="popup",G.useProxy(s),React.createElement(se,null,React.createElement(le,{title:"Settings",icon:w.getAssetIDByName("ic_cog")},React.createElement(u,{label:"Button type",leading:React.createElement(u.Icon,{source:w.getAssetIDByName("ic_message_edit")})}),React.createElement(C,{label:"Floating Pill",onPress:function(){return s.buttonType="pill"},trailing:React.createElement(u.Arrow,null),selected:s.buttonType==="pill",style:{marginHorizontal:12}}),React.createElement(C,{label:"Send button",subLabel:"Holding the send button",onPress:function(){return s.buttonType="send"},trailing:React.createElement(u.Arrow,null),selected:s.buttonType==="send",style:{marginHorizontal:12}}),React.createElement(u,{label:"Preview type",leading:React.createElement(u.Icon,{source:w.getAssetIDByName("ic_message_edit")})}),React.createElement(C,{label:"Popup",onPress:function(){return s.previewType="popup"},trailing:React.createElement(u.Arrow,null),selected:s.previewType==="popup",style:{marginHorizontal:12}}),React.createElement(C,{label:"Ephemeral message",onPress:function(){return s.previewType="clyde"},trailing:React.createElement(u.Arrow,null),selected:s.previewType==="clyde",style:{marginHorizontal:12}})))}const s=O.storage;let H;var ce={onLoad:function(){return H=Z()},onUnload:function(){return H?.()},settings:oe};return v.default=ce,v.vstorage=s,Object.defineProperty(v,"__esModule",{value:!0}),v})({},vendetta.plugin,vendetta.metro,vendetta.patcher,vendetta.utils,vendetta.metro.common,vendetta.ui.assets,vendetta.ui.components,vendetta.ui,vendetta.ui.alerts,vendetta,vendetta.ui.toasts,vendetta.storage);
