(function(f,w,o,a,y,s,v,E,V,z,g,Ae,R,N,O){"use strict";var d;(function(e){e[e.Folder=0]="Folder",e[e.Guild=1]="Guild"})(d||(d={}));function j(e){let{ret:i}=e;E.useProxy(c);const n=N.findInReactTree(i,function(t){return t?.type?.name==="Guilds"})?.props;if(!n)return;const l={guilds:[],folders:[]};for(const t of n.guildFolders)if(u(d.Folder,t.folderId)){l.folders.push(t.folderId);for(const r of t.guildIds)l.guilds.push(r)}else for(const r of t.guildIds.filter(function(S){return u(d.Guild,S)}))l.guilds.push(r);for(const t of l.guilds)n.unreadGuilds.delete(t),delete n.guildReadStates[t];return n.guildFolders=n.guildFolders.filter(function(t){return t.folderId?!u(d.Folder,t.folderId):!0}).map(function(t){return{...t,guildIds:t.guildIds.filter(function(r){return!u(d.Guild,r)})}}),i}const U=o.findByStoreName("ThemeStore"),W=o.findByProps("colors","meta");o.findByProps("triggerHaptic");const{TextStyleSheet:Q}=o.findByProps("TextStyleSheet"),{View:p,Text:_,Pressable:X}=g.General;o.findByProps("TableRow"),o.findByProps("ActionSheet")?.ActionSheet??o.find(function(e){return e.render?.name==="ActionSheet"});const Y=o.findByProps("openLazy","hideActionSheet"),{openLazy:Pe,hideActionSheet:q}=Y;o.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton","ActionSheetContentContainer"),o.findByProps("ActionSheetRow")?.ActionSheetRow;const m=o.findByName("Navigator")??o.findByProps("Navigator")?.Navigator,C=o.findByProps("getRenderCloseButton")?.getRenderCloseButton??o.findByProps("getHeaderCloseButton")?.getHeaderCloseButton,{popModal:J,pushModal:K}=o.findByProps("popModal","pushModal"),T=o.findByProps("useSearchControls"),I=o.findByProps("useSettingSearchQuery"),Z=o.findByName("SettingSearchBar");o.findByProps("SvgXml"),o.findByProps("useInMainTabsExperiment","isInMainTabsExperiment"),o.find(function(e){return e?.WebView&&!e.default}).WebView;function ee(e){return W.meta.resolveSemanticColor(U.theme,e)}function D(e,i){const n=Symbol("empty");if(!m||!C)return v.showToast(`${[m?n:"Navigator",C?n:"modalCloseButton"].filter(function(l){return l!==n}).join(", ")} is missing! Please try reinstalling Vendetta`,s.getAssetIDByName("Small"));K({key:e,modal:{key:e,modal:i,animation:"slide-up",shouldPersistUnderModals:!1,closable:!0}})}Object.assign(function(e){let{searchContext:i,controls:n}=e;return a.React.createElement(a.ReactNative.ScrollView,{scrollEnabled:!1},a.React.createElement(T.default,{searchContext:i,controls:n},a.React.createElement(Z,null)))},{useAdvancedSearch:function(e){const i=I.useSettingSearchQuery(),n=T.useSearchControls(e,!1,function(){});return a.React.useEffect(function(){return function(){I.setSettingSearchQuery(""),I.setIsSettingSearchActive(!1)}},[]),[i,n]}});function te(e){return!m||!C?null:a.React.createElement(m,{initialRouteName:e.mkey,screens:{[e.mkey]:Object.assign(N.without(e,"mkey","children"),{headerLeft:C?.(function(){return J(e.mkey)}),render:function(){return e.children}})}})}function ne(e){let{title:i,onPress:n,icon:l}=e;const t=a.stylesheet.createThemedStyleSheet({androidRipple:{color:R.semanticColors.ANDROID_RIPPLE},icon:{height:18,tintColor:R.semanticColors.HEADER_SECONDARY,opacity:.5}}),r=n?X:p;return a.React.createElement(r,{android_ripple:t.androidRipple,disabled:!1,accessibilityRole:"button",onPress:n,style:{marginBottom:8,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},l&&a.React.createElement(p,{style:{marginRight:4}},a.React.createElement(a.ReactNative.Image,{style:t.icon,source:l,resizeMode:"contain"})),a.React.createElement(A,{variant:"text-sm/semibold",color:"HEADER_SECONDARY"},i))}function re(e){let{title:i,onTitlePress:n,icon:l,children:t,padding:r}=e;const S=a.stylesheet.createThemedStyleSheet({main:{backgroundColor:R.semanticColors.CARD_PRIMARY_BG,borderRadius:16,overflow:"hidden",flex:1}});return a.React.createElement(p,{style:{marginHorizontal:16,marginTop:16}},a.React.createElement(ne,{title:i,onPress:n,icon:l}),a.React.createElement(p,{style:S.main},r?a.React.createElement(p,{style:{paddingHorizontal:16,paddingVertical:16}},t):t))}var H;(function(e){function i(l){let{children:t,onPress:r}=l;return a.React.createElement(A,{variant:"text-md/bold",onPress:r},t)}e.Bold=i;function n(l){let{children:t,onPress:r}=l;return a.React.createElement(_,{style:{textDecorationLine:"underline"},onPress:r},t)}e.Underline=n})(H||(H={}));function A(e){let{variant:i,lineClamp:n,color:l,align:t,style:r,onPress:S,getChildren:me,children:Ce,liveUpdate:Ie}=e;const[we,x]=a.React.useReducer(function(b){return~b},0);return a.React.useEffect(function(){if(!Ie)return;const b=new Date().setMilliseconds(1e3);let k,$;return $=setTimeout(function(){x(),k=setInterval(x,1e3)},b-Date.now()),function(){clearTimeout($),clearInterval(k)}},[]),a.React.createElement(_,{style:[i?Q[i]:{},l?{color:ee(R.semanticColors[l])}:{},t?{textAlign:t}:{},r??{}],numberOfLines:n,onPress:S},me?.()??Ce)}const{View:ie}=g.General,{FormRow:ae}=g.Forms,{showSimpleActionSheet:oe}=o.findByProps("showSimpleActionSheet"),le=o.findByStoreName("SortedGuildStore"),de=o.findByStoreName("GuildStore"),se="#5865f2",G=function(){E.useProxy(c);const[e,i]=a.React.useState(""),n=de.getGuilds(),l=le.getGuildFolders().filter(function(t){return t.folderId?u(d.Folder,t.folderId):t.guildIds.every(function(r){return u(d.Guild,r)})}).map(function(t){const r=t.folderId?t:n[t.guildIds[0]];if(r)return{id:r.folderId??r.id,name:r.folderName??r.name,icon:r.icon,color:r.folderId&&(r.folderColor?a.ReactNative.processColor(r.folderColor):se),type:r.folderId?d.Folder:d.Guild}}).filter(function(t){return t&&(t.name??"Unnamed").toLowerCase().includes(e)});return a.React.createElement(a.ReactNative.FlatList,{ListHeaderComponent:a.React.createElement(g.Search,{style:{marginBottom:10},onChangeText:function(t){return i(t.toLowerCase())}}),style:{paddingHorizontal:10,paddingTop:10},contentContainerStyle:{paddingBottom:20},data:l,renderItem:function(t){let{item:r}=t;return a.React.createElement(ae,{label:r.name,leading:r.icon?a.React.createElement(a.ReactNative.Image,{source:{uri:`https://cdn.discordapp.com/icons/${r.id}/${r.icon}.${r.icon.startsWith("a_")?"gif":"png"}?size=32`},style:{height:32,width:32,borderRadius:16}}):a.React.createElement(ie,{style:{height:32,width:32,borderRadius:8,backgroundColor:r.color}}),onPress:function(){return oe({key:"CardOverflow",header:{title:r.name,onClose:q},options:[{label:"Remove",icon:s.getAssetIDByName("ic_message_delete"),isDestructive:!0,onPress:function(){v.showToast(`Removed ${r.name} from hidden list`,s.getAssetIDByName("ic_hide_password")),F(r.type,r.id)}}]})}})},removeClippedSubviews:!0})};function ce(e){e.push("VendettaCustomPage",{title:"Manage Hidden Servers",render:G})}function M(){return React.createElement(te,{mkey:"MANAGE_HIDDEN_SERVERS",title:"Manage Hidden Servers"},React.createElement(G,null))}const{default:ue}=o.find(function(e){return e?.default?.render?.name==="GuildPopoutMenu"}),{default:fe}=o.find(function(e){return e?.default?.render?.name==="FolderPopoutMenu"}),ge=o.findByName("GuildsConnected",!1);function he(){const e=new Array;return e.push(y.after("render",ue,function(i,n){let[{guildId:l,title:t}]=i;const r={...n};return u(d.Guild,l)||r.props.rows.unshift({text:"Hide Server",icon:s.getAssetIDByName("ic_hide_password"),onClick:function(){P(d.Guild,l),v.showToast(`Hid ${t}`,s.getAssetIDByName("ic_hide_password"))}}),r})),e.push(y.after("render",fe,function(i,n){let[{title:l,folderId:t}]=i;const r={...n};return u(d.Folder,t)||r.props.rows.unshift({text:"Hide Folder",icon:s.getAssetIDByName("ic_hide_password"),onClick:function(){P(d.Folder,t),v.showToast(`Hid ${l}`,s.getAssetIDByName("ic_hide_password"))}}),r})),e.push(y.after("default",ge,function(i,n){return a.React.createElement(j,{ret:n})})),e.push(y.before("TouchableWithoutFeedback",a.ReactNative,function(i){const n=[...i];return n[0].accessibilityLabel===a.i18n.Messages.DIRECT_MESSAGES&&(n[0].onLongPress=function(){return D("MANAGE_HIDDEN_SERVERS",M)}),n})),e.push(y.before("render",a.ReactNative.Pressable.type,function(i){const n=[...i];return n[0].accessibilityLabel==="Create or join a server"&&(n[0].onLongPress=function(){return D("MANAGE_HIDDEN_SERVERS",M)}),n})),function(){return e.forEach(function(i){return i()})}}const{ScrollView:ye}=g.General,{FormRow:h}=g.Forms,Re=a.stylesheet.createThemedStyleSheet({destructiveIcon:{tintColor:R.semanticColors.TEXT_DANGER}}),pe={color:"TEXT_DANGER",variant:"text-md/semibold"};function Se(){const e=a.NavigationNative.useNavigation();return React.createElement(ye,null,React.createElement(re,{title:"Data",icon:s.getAssetIDByName("ic_cog_24px")},React.createElement(h,{label:"Manage hidden servers",leading:React.createElement(h.Icon,{source:s.getAssetIDByName("ic_message_edit")}),trailing:React.createElement(h.Arrow,null),onPress:function(){return ce(e)}}),React.createElement(h,{label:React.createElement(A,pe,"Clear hidden servers"),leading:React.createElement(h.Icon,{style:Re.destructiveIcon,source:s.getAssetIDByName("ic_message_delete")}),trailing:React.createElement(h.Arrow,null),onPress:function(){return O.showConfirmationAlert({title:"Clear data",content:`Are you sure you want to clear **${c.list.length}** hidden server(s)?`,confirmText:"Clear",confirmColor:"red",onConfirm:function(){return c.list=[]},isDismissable:!0})}})))}const c=E.wrapSync(E.createStorage({get:function(){return w.storage.hidden??{list:[]}},set:function(e){w.storage.hidden=e}}));function u(e,i){return c.list.some(function(n){return n[0]===e&&n[1]===i})}function P(e,i){u(e,i)||(c.list=[...c.list,e===d.Folder?[e,i]:[e,i]])}function F(e,i){c.list=c.list.filter(function(n){return n[0]!==e||n[1]!==i})}const B=Symbol.for("vendetta.storage.emitter"),ve=!!V.plugins[B]&&!!z.themes[B];let L;var Ee={onLoad:function(){return L=he()},onUnload:function(){return L?.()},settings:Se};return f.addHidden=P,f.default=Ee,f.emitterAvailable=ve,f.emitterSymbol=B,f.hiddenList=c,f.isHidden=u,f.removeHidden=F,Object.defineProperty(f,"__esModule",{value:!0}),f})({},vendetta.plugin,vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.ui.assets,vendetta.ui.toasts,vendetta.storage,vendetta.plugins,vendetta.themes,vendetta.ui.components,vendetta,vendetta.ui,vendetta.utils,vendetta.ui.alerts);
