(function(B,Y,w,S,M,Se,s,t,f,be,_,b,K){"use strict";const Q=s.findByStoreName("ThemeStore");s.findByProps("triggerHaptic");const O=s.findByProps("colors","unsafe_rawColors"),J=O?.internal??O?.meta,L=s.findByProps("TextStyleSheet").TextStyleSheet,{View:m,Text:$,Pressable:q}=M.General;s.findByProps("TableRow"),s.findByProps("ActionSheet")?.ActionSheet??s.find(function(e){return e.render?.name==="ActionSheet"}),s.findByProps("openLazy","hideActionSheet"),s.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton","ActionSheetContentContainer"),s.findByProps("ActionSheetRow")?.ActionSheetRow,s.findByName("Navigator")??s.findByProps("Navigator")?.Navigator,s.findByProps("getRenderCloseButton")?.getRenderCloseButton??s.findByProps("getHeaderCloseButton")?.getHeaderCloseButton,s.findByProps("popModal","pushModal");const F=s.findByProps("useSearchControls"),V=s.findByProps("useSettingSearchQuery"),Z=s.findByName("SettingSearchBar");s.findByProps("SvgXml"),s.findByProps("useInMainTabsExperiment","isInMainTabsExperiment"),s.find(function(e){return e?.WebView&&!e.default}).WebView,s.findByProps("Button","SegmentedControl");function ee(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Q.theme;return J.resolveSemanticColor(n,e)}Object.assign(function(e){let{searchContext:n,controls:a}=e;return t.React.createElement(t.ReactNative.ScrollView,{scrollEnabled:!1},t.React.createElement(F.default,{searchContext:n,controls:a},t.React.createElement(Z,null)))},{useAdvancedSearch:function(e){const n=V.useSettingSearchQuery(),a=F.useSearchControls(e,!1,function(){});return t.React.useEffect(function(){return function(){V.setSettingSearchQuery(""),V.setIsSettingSearchActive(!1)}},[]),[n,a]}}),window.nativeModuleProxy.DCDFileManager??window.nativeModuleProxy.RTNFileManager,window.nativeModuleProxy.BundleUpdaterManager,window.nativeModuleProxy.MMKVManager,window.nativeModuleProxy.DCDSoundManager;function te(e){let{title:n,onPress:a,icon:l}=e;const r=t.stylesheet.createThemedStyleSheet({androidRipple:{color:f.semanticColors.ANDROID_RIPPLE},icon:{height:18,tintColor:f.semanticColors.HEADER_SECONDARY,opacity:.5}}),o=a?q:m;return t.React.createElement(o,{android_ripple:r.androidRipple,disabled:!1,accessibilityRole:"button",onPress:a,style:{marginBottom:8,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},l&&t.React.createElement(m,{style:{marginRight:4}},t.React.createElement(t.ReactNative.Image,{style:r.icon,source:l,resizeMode:"contain"})),t.React.createElement(v,{variant:"text-sm/semibold",color:"HEADER_SECONDARY"},n))}function ne(e){let{title:n,onTitlePress:a,icon:l,children:r,padding:o}=e;const p=t.stylesheet.createThemedStyleSheet({main:{backgroundColor:f.semanticColors.CARD_PRIMARY_BG,borderRadius:16,overflow:"hidden",flex:1}});return t.React.createElement(m,{style:{marginHorizontal:16,marginTop:16}},t.React.createElement(te,{title:n,onPress:a,icon:l}),t.React.createElement(m,{style:p.main},o?t.React.createElement(m,{style:{paddingHorizontal:16,paddingVertical:16}},r):r))}var G;(function(e){function n(l){let{children:r,onPress:o}=l;return t.React.createElement(v,{variant:"text-md/bold",onPress:o},r)}e.Bold=n;function a(l){let{children:r,onPress:o}=l;return t.React.createElement($,{style:{textDecorationLine:"underline"},onPress:o},r)}e.Underline=a})(G||(G={}));function v(e){let{variant:n,lineClamp:a,color:l,align:r,style:o,onPress:p,getChildren:R,children:d,liveUpdate:y}=e;const[x,c]=t.React.useReducer(function(h){return~h},0);return t.React.useEffect(function(){if(!y)return;const h=new Date().setMilliseconds(1e3);let E;const A=setTimeout(function(){c(),E=setInterval(c,1e3)},h-Date.now());return function(){clearTimeout(A),clearInterval(E)}},[]),t.React.createElement($,{style:[n?L[n]:{},l?{color:ee(f.semanticColors[l])}:{},r?{textAlign:r}:{},o??{}],numberOfLines:a,onPress:p},R?.()??d)}const{ScrollView:re}=M.General,{FormSwitchRow:U,FormRadioRow:C,FormRow:u,FormInput:ae}=M.Forms;function ie(){var e,n,a,l,r;return(e=i).position??(e.position="pill"),(n=i).display??(n.display="full"),(a=i).commas??(a.commas=!0),(l=i).minChars??(l.minChars=1),(r=i).supportSLM??(r.supportSLM=!0),w.useProxy(i),React.createElement(re,null,React.createElement(ne,{title:"Settings",icon:S.getAssetIDByName("ic_cog_24px")},React.createElement(u,{label:"Position",subLabel:"Choose where Char Counter will appear",leading:React.createElement(u.Icon,{source:S.getAssetIDByName("ic_message_edit")})}),React.createElement(C,{label:"Floating Pill",onPress:function(){return i.position="pill"},trailing:React.createElement(u.Arrow,null),selected:i.position==="pill",style:{marginHorizontal:12}}),React.createElement(C,{label:"Inside Textbox",onPress:function(){return i.position="inside"},trailing:React.createElement(u.Arrow,null),selected:i.position==="inside",style:{marginHorizontal:12}}),React.createElement(u,{label:"Display Type",subLabel:"Choose how the char counter text appears",leading:React.createElement(u.Icon,{source:S.getAssetIDByName("ic_message_edit")})}),React.createElement(C,{label:"Full",subLabel:"100/300",onPress:function(){return i.display="full"},trailing:React.createElement(u.Arrow,null),selected:i.display==="full",style:{marginHorizontal:12}}),React.createElement(C,{label:"Length",subLabel:"100",onPress:function(){return i.display="length"},trailing:React.createElement(u.Arrow,null),selected:i.display==="length",style:{marginHorizontal:12}}),React.createElement(C,{label:"Remaining",subLabel:"200",onPress:function(){return i.display="remaining"},trailing:React.createElement(u.Arrow,null),selected:i.display==="remaining",style:{marginHorizontal:12}}),React.createElement(u,{label:"Minimum Characters",subLabel:"The minimum amount of characters for Char Counter to show up",leading:React.createElement(u.Icon,{source:S.getAssetIDByName("ic_message_edit")})}),React.createElement(ae,{title:"",keyboardType:"numeric",placeholder:"1",value:i.minChars.toString(),onChange:function(o){return i.minChars=Math.max(Number.isNaN(Number(o))?1:Number(o),1)},style:{marginTop:-25,marginHorizontal:12}}),React.createElement(U,{label:"Add Thousand Seperators",subLabel:"Adds thousand seperators (1,234,567) to numbers",leading:React.createElement(u.Icon,{source:S.getAssetIDByName("ic_message_edit")}),onValueChange:function(){return i.commas=!i.commas},value:i.commas}),React.createElement(U,{label:"Support SplitLargeMessages",leading:React.createElement(u.Icon,{source:S.getAssetIDByName("ic_message_edit")}),onValueChange:function(){return i.supportSLM=!i.supportSLM},value:i.supportSLM})))}const{Animated:z}=t.ReactNative;function H(e){let{duration:n,children:a,style:l,fade:r,trigger:o,customOpacity:p,setDisplay:R,animateOnInit:d}=e;d??(d=!0);const y=t.React.useRef(!0),x=t.React.useRef(!0),c=t.React.useRef(new z.Value(d&&r==="in"?1:0)).current,[h,E]=t.React.useState(d?r!=="in":!0);return t.React.useEffect(function(){const A=c.addListener(function(ye){let{value:he}=ye;E(he<=.1)});return function(){return c.removeListener(A)}},[]),t.React.useEffect(function(){if(!d&&y.current){y.current=!1;return}!d&&x.current&&(c.setValue(r==="in"?0:1),x.current=!1),z.timing(c,{toValue:p??(r==="in"?1:0),duration:n,useNativeDriver:!0}).start()},[c,r,p,o]),t.React.createElement(z.View,{style:[{opacity:c},R&&h&&{display:"none"},l]},a)}const le=s.findByStoreName("UserStore");function X(e){return i.display==="length"?I(e):i.display==="remaining"?I(N()-e):`${I(e)}/${I(N())}`}function I(e){return i.commas===!1?e.toString():e.toString().split("").reverse().map(function(n,a,l){return a%3===0&&l.length>3&&a!==0?`${n},`:n}).reverse().join("")}function j(){return!!(i.supportSLM!==!1&&Object.values(K.plugins).find(function(e){return e.manifest.name==="SplitLargeMessages"})?.enabled)}function N(){return le.getCurrentUser()?.premiumType===2?4e3:2e3}const{View:se,Pressable:oe}=M.General,T=L["text-xs/semibold"].fontSize,P=t.stylesheet.createThemedStyleSheet({androidRipple:{color:f.semanticColors.ANDROID_RIPPLE,cornerRadius:8},container:{backgroundColor:f.semanticColors.BACKGROUND_TERTIARY,borderRadius:8,marginRight:8,marginTop:-12},text:{...L["text-xs/semibold"],textAlign:"right",paddingHorizontal:8,paddingVertical:8},extraMessagesCircle:{backgroundColor:f.semanticColors.REDESIGN_BUTTON_PRIMARY_BACKGROUND,borderRadius:2147483647,position:"absolute",left:0,top:0,transform:[{translateX:-T},{translateY:-T}],minWidth:T*2,height:T*2,justifyContent:"center",alignItems:"center",zIndex:2}});function ce(e){let{inputProps:n}=e;const[a,l]=t.React.useState(!1),[r,o]=t.React.useState("");D.value=r,b.after("onChangeText",n,function(E){let[A]=E;return o(A)},!0);const p=r.length,R=N(),d=j()?Math.floor(p/R):0,y=p-d*R,x=P.text.fontSize*2+P.text.paddingVertical,c=p>=(i.minChars??1),h=c?oe:se;return t.React.createElement(H,{duration:100,style:{flexDirection:"row-reverse",position:"absolute",right:0,top:-x,zIndex:1},fade:c?"in":"out",customOpacity:a&&c?.3:void 0},t.React.createElement(h,{android_ripple:P.androidRipple,disabled:!1,accessibilityRole:"button",accessibilityState:{disabled:!1,expanded:!1},accessibilityLabel:"Character counter",accessibilityHint:"Tap to toggle character counter translucency",style:P.container,onPress:c?function(){return l(!a)}:void 0},t.React.createElement(H,{fade:d>0&&c?"in":"out",duration:100,style:P.extraMessagesCircle},t.React.createElement(v,{variant:"text-xs/semibold",color:"TEXT_NORMAL",style:{paddingHorizontal:T/2}},d)),t.React.createElement(v,{variant:"text-xs/semibold",color:y<=R?"TEXT_NORMAL":"TEXT_DANGER",style:{paddingHorizontal:8,paddingVertical:8}},X(y))))}const ue=t.stylesheet.createThemedStyleSheet({container:{textAlign:"center",paddingBottom:2,paddingRight:5,marginTop:-5}});function de(){w.useProxy(D);const e=D.value.length,n=N(),a=j()?Math.floor(e/n):0,l=e-a*n,r=e>=(i.minChars??1);return t.React.createElement(H,{duration:100,style:ue.container,fade:r?"in":"out",setDisplay:!0},t.React.createElement(v,{variant:"text-xs/semibold",color:l<=n?"TEXT_NORMAL":"TEXT_DANGER"},X(l)))}const{ChatInput:pe}=s.findByProps("ChatInput"),{MessagesWrapper:fe}=s.findByProps("MessagesWrapper");let g=[],k={value:""};const D=w.wrapSync(w.createStorage({get:function(){return k},set:function(e){k=e}}));function ge(){return g.push(b.after("render",pe.prototype,function(e,n){const a=_.findInReactTree(n.props.children,function(r){return r?.type?.name==="ChatInput"})?.props;if(!a?.onChangeText)return;const l=_.findInReactTree(n.props.children,function(r){return r?.type?.displayName==="View"&&Array.isArray(r?.props?.children)})?.props?.children;l&&(i.position==="pill"?l.unshift(t.React.createElement(ce,{inputProps:a})):g.push(b.after("onChangeText",a,function(r){let[o]=r;return D.value=o})))})),g.push(b.after("render",fe.prototype,function(e,n){const a=_.findInReactTree(n,function(l){return l?.type?.name==="JumpToPresentButton"});a&&g.push(b.after("type",a,function(l,r){r?.props?.style&&i.position==="pill"&&(r.props.style[1].bottom+=32+8)}))})),g.push(b.before("render",t.ReactNative.View,function(e){const n=[...e],[a]=n;if(a.children?.[0]?.type?.name==="TextInputWrapper"&&i.position==="inside"){const l=a.children[1].props.children;l[1].props.children=t.React.createElement(t.React.Fragment,{}),l.splice(1,0,t.React.createElement(de,{}))}return n})),function(){g.forEach(function(e){return e()}),g=[]}}const i=Y.storage;let W;var Re={onLoad:function(){return W=ge()},onUnload:function(){return W?.()},settings:ie};return B.default=Re,B.vstorage=i,Object.defineProperty(B,"__esModule",{value:!0}),B})({},vendetta.plugin,vendetta.storage,vendetta.ui.assets,vendetta.ui.components,vendetta,vendetta.metro,vendetta.metro.common,vendetta.ui,vendetta.ui.toasts,vendetta.utils,vendetta.patcher,vendetta.plugins);
