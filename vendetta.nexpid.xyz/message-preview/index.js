(function(w,$,G,S,y,Re,n,e,f,he,D,B,k){"use strict";const F=n.findByStoreName("ThemeStore");n.findByProps("triggerHaptic");const m=n.findByProps("colors","unsafe_rawColors"),j=m?.internal??m?.meta,Y=n.findByProps("TextStyleSheet").TextStyleSheet,{View:g,Text:_,Pressable:K}=y.General;n.findByProps("TableRow"),n.findByProps("ActionSheet")?.ActionSheet??n.find(function(t){return t.render?.name==="ActionSheet"}),n.findByProps("openLazy","hideActionSheet"),n.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton","ActionSheetContentContainer"),n.findByProps("ActionSheetRow")?.ActionSheetRow,n.findByName("Navigator")??n.findByProps("Navigator")?.Navigator,n.findByProps("getRenderCloseButton")?.getRenderCloseButton??n.findByProps("getHeaderCloseButton")?.getHeaderCloseButton,n.findByProps("popModal","pushModal");const V=n.findByProps("useSearchControls"),T=n.findByProps("useSettingSearchQuery"),Q=n.findByName("SettingSearchBar");n.findByProps("SvgXml"),n.findByProps("useInMainTabsExperiment","isInMainTabsExperiment"),n.find(function(t){return t?.WebView&&!t.default}).WebView,n.findByProps("Button","SegmentedControl");function W(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:F.theme;return j.resolveSemanticColor(r,t)}Object.assign(function(t){let{searchContext:r,controls:i}=t;return e.React.createElement(e.ReactNative.ScrollView,{scrollEnabled:!1},e.React.createElement(V.default,{searchContext:r,controls:i},e.React.createElement(Q,null)))},{useAdvancedSearch:function(t){const r=T.useSettingSearchQuery(),i=V.useSearchControls(t,!1,function(){});return e.React.useEffect(function(){return function(){T.setSettingSearchQuery(""),T.setIsSettingSearchActive(!1)}},[]),[r,i]}}),window.nativeModuleProxy.DCDFileManager??window.nativeModuleProxy.RTNFileManager,window.nativeModuleProxy.BundleUpdaterManager,window.nativeModuleProxy.MMKVManager,window.nativeModuleProxy.DCDSoundManager;function X(t){let{title:r,onPress:i,icon:s}=t;const a=e.stylesheet.createThemedStyleSheet({androidRipple:{color:f.semanticColors.ANDROID_RIPPLE},icon:{height:18,tintColor:f.semanticColors.HEADER_SECONDARY,opacity:.5}}),o=i?K:g;return e.React.createElement(o,{android_ripple:a.androidRipple,disabled:!1,accessibilityRole:"button",onPress:i,style:{marginBottom:8,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},s&&e.React.createElement(g,{style:{marginRight:4}},e.React.createElement(e.ReactNative.Image,{style:a.icon,source:s,resizeMode:"contain"})),e.React.createElement(L,{variant:"text-sm/semibold",color:"HEADER_SECONDARY"},r))}function q(t){let{title:r,onTitlePress:i,icon:s,children:a,padding:o}=t;const d=e.stylesheet.createThemedStyleSheet({main:{backgroundColor:f.semanticColors.CARD_PRIMARY_BG,borderRadius:16,overflow:"hidden",flex:1}});return e.React.createElement(g,{style:{marginHorizontal:16,marginTop:16}},e.React.createElement(X,{title:r,onPress:i,icon:s}),e.React.createElement(g,{style:d.main},o?e.React.createElement(g,{style:{paddingHorizontal:16,paddingVertical:16}},a):a))}var H;(function(t){function r(s){let{children:a,onPress:o}=s;return e.React.createElement(L,{variant:"text-md/bold",onPress:o},a)}t.Bold=r;function i(s){let{children:a,onPress:o}=s;return e.React.createElement(_,{style:{textDecorationLine:"underline"},onPress:o},a)}t.Underline=i})(H||(H={}));function L(t){let{variant:r,lineClamp:i,color:s,align:a,style:o,onPress:d,getChildren:h,children:p,liveUpdate:E}=t;const[N,c]=e.React.useReducer(function(v){return~v},0);return e.React.useEffect(function(){if(!E)return;const v=new Date().setMilliseconds(1e3);let C;const x=setTimeout(function(){c(),C=setInterval(c,1e3)},v-Date.now());return function(){clearTimeout(x),clearInterval(C)}},[]),e.React.createElement(_,{style:[r?Y[r]:{},s?{color:W(f.semanticColors[s])}:{},a?{textAlign:a}:{},o??{}],numberOfLines:i,onPress:d},h?.()??p)}const{ScrollView:J}=y.General,{FormRow:u,FormRadioRow:P}=y.Forms;function Z(){var t,r;return(t=l).buttonType??(t.buttonType="pill"),(r=l).previewType??(r.previewType="popup"),G.useProxy(l),React.createElement(J,null,React.createElement(q,{title:"Settings",icon:S.getAssetIDByName("ic_cog")},React.createElement(u,{label:"Button type",leading:React.createElement(u.Icon,{source:S.getAssetIDByName("ic_message_edit")})}),React.createElement(P,{label:"Floating Pill",onPress:function(){return l.buttonType="pill"},trailing:React.createElement(u.Arrow,null),selected:l.buttonType==="pill",style:{marginHorizontal:12}}),React.createElement(P,{label:"Send button",subLabel:"Holding the send button",onPress:function(){return l.buttonType="send"},trailing:React.createElement(u.Arrow,null),selected:l.buttonType==="send",style:{marginHorizontal:12}}),React.createElement(u,{label:"Preview type",leading:React.createElement(u.Icon,{source:S.getAssetIDByName("ic_message_edit")})}),React.createElement(P,{label:"Popup",onPress:function(){return l.previewType="popup"},trailing:React.createElement(u.Arrow,null),selected:l.previewType==="popup",style:{marginHorizontal:12}}),React.createElement(P,{label:"Ephemeral message",onPress:function(){return l.previewType="clyde"},trailing:React.createElement(u.Arrow,null),selected:l.previewType==="clyde",style:{marginHorizontal:12}})))}const{Animated:A}=e.ReactNative;function ee(t){let{duration:r,children:i,style:s,fade:a,trigger:o,customOpacity:d,setDisplay:h,animateOnInit:p}=t;p??(p=!0);const E=e.React.useRef(!0),N=e.React.useRef(!0),c=e.React.useRef(new A.Value(p&&a==="in"?1:0)).current,[v,C]=e.React.useState(p?a!=="in":!0);return e.React.useEffect(function(){const x=c.addListener(function(ye){let{value:ge}=ye;C(ge<=.1)});return function(){return c.removeListener(x)}},[]),e.React.useEffect(function(){if(!p&&E.current){E.current=!1;return}!p&&N.current&&(c.setValue(a==="in"?0:1),N.current=!1),A.timing(c,{toValue:d??(a==="in"?1:0),duration:r,useNativeDriver:!0}).start()},[c,a,d,o]),e.React.createElement(A.View,{style:[{opacity:c},h&&v&&{display:"none"},s]},i)}const{ScrollView:te}=y.General,{default:ne}=n.findByProps("DCDAutoModerationSystemMessageView","default"),re=n.findByName("MessageRecord"),ae=n.findByName("RowManager"),I=n.findByStoreName("SelectedChannelStore"),O=n.findByStoreName("UserStore"),{receiveMessage:ie}=n.findByProps("receiveMessage"),{createBotMessage:se}=n.findByProps("createBotMessage"),{getText:le}=n.findByProps("openSystemKeyboard","getText");function z(){const t=le(I.getChannelId());if(t.trim()!=="")if(l.previewType==="popup")k.showConfirmationAlert({title:"Message Preview",onConfirm:function(){},children:React.createElement(te,{style:{marginVertical:12,maxHeight:e.ReactNative.Dimensions.get("window").height*.7}},React.createElement(ne,{rowGenerator:new ae,message:new re({id:"0",channel_id:I.getChannelId(),author:O.getCurrentUser(),content:t})}))});else{const r=I.getChannelId(),i=O.getCurrentUser();return ie(r,Object.assign(se({channelId:r,content:t}),{author:i}))}}const{Pressable:oe,View:ce}=y.General,R=40,M=e.stylesheet.createThemedStyleSheet({androidRipple:{color:f.semanticColors.ANDROID_RIPPLE,cornerRadius:2147483647},actionButton:{borderRadius:2147483647,height:R,width:R,marginHorizontal:4,flexShrink:0,flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:f.semanticColors.BACKGROUND_SECONDARY_ALT,marginLeft:8,marginTop:-4},actionIcon:{tintColor:f.semanticColors.INTERACTIVE_NORMAL,width:R*.6,height:R*.6}});function ue(t){let{inputProps:r}=t;const[i,s]=e.React.useState("");b.push(B.after("onChangeText",r,function(d){let[h]=d;return s(h)},!0));const a=i.length>0,o=a?oe:ce;return e.React.createElement(ee,{style:{flexDirection:"row",position:"absolute",left:0,top:-R,zIndex:3},duration:100,fade:a?"in":"out"},e.React.createElement(o,{android_ripple:M.androidRipple,disabled:!1,accessibilityRole:"button",accessibilityState:{disabled:!1,expanded:!1},accessibilityLabel:"Open markdown preview",accessibilityHint:"Open a modal which shows your message's markdown preview",onPress:a?function(){return z()}:void 0,style:M.actionButton},e.React.createElement(e.ReactNative.Image,{style:M.actionIcon,source:S.getAssetIDByName("ic_eye")})))}const{ChatInput:de}=n.findByProps("ChatInput"),b=[];function pe(){return b.push(B.after("render",de.prototype,function(t,r){const i=D.findInReactTree(r.props.children,function(a){return a?.type?.name==="ChatInput"})?.props;if(!i?.onChangeText)return;const s=D.findInReactTree(r.props.children,function(a){return a?.type?.displayName==="View"&&Array.isArray(a?.props?.children)})?.props?.children;s&&l.buttonType==="pill"&&s.unshift(React.createElement(ue,{inputProps:i}))})),b.push(B.before("render",e.ReactNative.Pressable.type,function(t){let[r]=t;r?.accessibilityLabel===e.i18n.Messages.SEND&&(r.onLongPress=function(){return l.buttonType==="send"&&z()})})),function(){return b.forEach(function(t){return t()})}}const l=$.storage;let U;var fe={onLoad:function(){return U=pe()},onUnload:function(){return U?.()},settings:Z};return w.default=fe,w.vstorage=l,Object.defineProperty(w,"__esModule",{value:!0}),w})({},vendetta.plugin,vendetta.storage,vendetta.ui.assets,vendetta.ui.components,vendetta,vendetta.metro,vendetta.metro.common,vendetta.ui,vendetta.ui.toasts,vendetta.utils,vendetta.patcher,vendetta.ui.alerts);
