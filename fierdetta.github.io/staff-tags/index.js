(function(c,i,t,M,s,R,g,l){"use strict";const{ScrollView:S}=g.General,{FormSection:_,FormSwitchRow:N}=g.Forms;function T(){return R.useProxy(s.storage),React.createElement(S,{style:{flex:1}},React.createElement(_,{title:"Tag style"},React.createElement(N,{label:"Use top role color",subLabel:"This may result in unreadable tags as it isn't possible to change the tag's text color.",value:s.storage.useRoleColor,onValueChange:function(o){s.storage.useRoleColor=o}})))}const B=i.findByName("RowManager"),C=i.findByStoreName("GuildStore"),G=i.findByStoreName("ChannelStore"),{Permissions:O}=t.constants,{computePermissions:h}=i.findByProps("computePermissions","canEveryoneRole");let E;const x=[t.i18n.Messages.AI_TAG,t.i18n.Messages.BOT_TAG_SERVER,t.i18n.Messages.SYSTEM_DM_TAG_SYSTEM,t.i18n.Messages.GUILD_AUTOMOD_USER_BADGE_TEXT],v=[{text:"WEBHOOK",condition:function(o,n,e){return e.isNonUserBot()}},{text:"OWNER",color:l.rawColors.ORANGE_345,condition:function(o,n,e){return o?.ownerId===e.id||n?.type===3&&n?.ownerId===e.id}},{text:t.i18n.Messages.BOT_TAG_BOT,condition:function(o,n,e){return e.bot}},{text:"ADMIN",color:l.rawColors.RED_560,permissions:["ADMINISTRATOR"]},{text:"MANAGER",color:l.rawColors.GREEN_345,permissions:["MANAGE_GUILD","MANAGE_CHANNELS","MANAGE_ROLES","MANAGE_WEBHOOKS"]},{text:"MOD",color:l.rawColors.BLUE_345,permissions:["MANAGE_MESSAGES","KICK_MEMBERS","BAN_MEMBERS"]}];var m={onLoad:function(){s.storage.useRoleColor??=!1,E=M.after("generate",B.prototype,function(o,n){let[e]=o,{message:a}=n;if(e.rowType===1){if(!x.includes(a.tagText)){const{guildId:p,channelId:w}=a,u=C.getGuild(p),A=G.getChannel(w);let f;if(u){const r=h({user:e.message.author,context:u,overwrites:A?.permissionOverwrites});f=Object.entries(O).map(function(d){let[y,I]=d;return r&I?y:""}).filter(Boolean)}for(const r of v)if(r.condition?.(u,A,e.message.author)||r.permissions?.some(function(d){return f?.includes(d)})){a.tagText=r.text,r.color&&!(s.storage.useRoleColor&&e.message.colorString)&&(a.tagBackgroundColor=t.ReactNative.processColor(t.chroma(r.color).hex()));break}}s.storage.useRoleColor&&e.message.colorString&&a.tagText&&(a.tagBackgroundColor=t.ReactNative.processColor(t.chroma(e.message.colorString).hex()))}})},onUnload:function(){return E()},settings:T};return c.default=m,Object.defineProperty(c,"__esModule",{value:!0}),c})({},vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.plugin,vendetta.storage,vendetta.ui.components,vendetta.ui);
