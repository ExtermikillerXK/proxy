(function(i,u,o,g,a,h,m,d,E){"use strict";function S(){return E.useProxy(a.storage),React.createElement(d.ErrorBoundary,null,React.createElement(o.ReactNative.ScrollView,null,React.createElement(d.Forms.FormSwitchRow,{label:"Split messages on words instead of newlines",subLabel:"Results in the lowest amount of messages",onValueChange:function(s){return a.storage.splitOnWords=s},value:a.storage.splitOnWords})))}let l;a.storage.splitOnWords??=!1;function M(s){return new Promise(function(r){return setTimeout(r,s)})}function v(s,r){const t=[];return a.storage.splitOnWords||t.push(s.split(`
`).reduce(function(e,n){return e.length+n.length+2>r?(t.push(e),n+`
`):e?e+n+`
`:n+`
`},"")),t.length&&!t.some(function(e){return e.length>r})?t.map(function(e){return e.trim()}):(t.length=0,t.push(s.split(" ").reduce(function(e,n){return e.length+n.length+2>r?(t.push(e),n+" "):e?e+n+" ":n+" "},"")),t.some(function(e){return e.length>r})?!1:t.map(function(e){return e.trim()}))}var p={onLoad(){const s=u.findByStoreName("UserStore").getCurrentUser()?.premiumType===2?4e3:2e3;o.constants.MAX_MESSAGE_LENGTH=2**30,o.constants.MAX_MESSAGE_LENGTH_PREMIUM=2**30;const r=u.findByStoreName("ChannelStore"),t=u.findByProps("sendMessage","editMessage");l?.(),l=g.before("sendMessage",t,function(e){const[n,{content:f}]=e;if(f?.length<s)return;const c=v(f,s);if(!c)return e[1].content="",m.showToast("Failed to split message",h.getAssetIDByName("Small"));e[1].content=c.shift();const _=r.getChannel(n);(async function(){for(const w of c)await M(Math.max(_.rateLimitPerUser,1e3)),await t._sendMessage(n,{invalidEmojis:e[1].invalidEmojis,validNonShortcutEmojis:e[1].validNonShortcutEmojis,tts:!1,content:w},{})})()})},onUnload:function(){l(),o.constants.MAX_MESSAGE_LENGTH=2e3,o.constants.MAX_MESSAGE_LENGTH_PREMIUM=4e3},settings:S};return i.default=p,Object.defineProperty(i,"__esModule",{value:!0}),i})({},vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.plugin,vendetta.ui.assets,vendetta.ui.toasts,vendetta.ui.components,vendetta.storage);
